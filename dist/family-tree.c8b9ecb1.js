function t(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}function e(t){return t&&t.__esModule?t.default:t}var n,i=globalThis,r={},o={},a=i.parcelRequirea7a4;null==a&&((a=function(t){if(t in r)return r[t].exports;if(t in o){var e=o[t];delete o[t];var n={id:t,exports:{}};return r[t]=n,e.call(n.exports,n,n.exports),n.exports}var i=Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(t,e){o[t]=e},i.parcelRequirea7a4=a);var s=a.register;s("bYoiY",function(e,n){t(e.exports,"Color",()=>r),t(e.exports,"darker",()=>o),t(e.exports,"brighter",()=>s),t(e.exports,"default",()=>b),t(e.exports,"hslConvert",()=>T),t(e.exports,"Rgb",()=>C),t(e.exports,"rgbConvert",()=>k),t(e.exports,"rgb",()=>E),t(e.exports,"hsl",()=>A);var i=a("bfWFq");function r(){}var o=.7,s=1.4285714285714286,l="\\s*([+-]?\\d+)\\s*",u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",h="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,d=RegExp(`^rgb\\(${l},${l},${l}\\)$`),f=RegExp(`^rgb\\(${h},${h},${h}\\)$`),p=RegExp(`^rgba\\(${l},${l},${l},${u}\\)$`),g=RegExp(`^rgba\\(${h},${h},${h},${u}\\)$`),m=RegExp(`^hsl\\(${u},${h},${h}\\)$`),y=RegExp(`^hsla\\(${u},${h},${h},${u}\\)$`),v={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function _(){return this.rgb().formatHex()}function x(){return this.rgb().formatRgb()}function b(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=c.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?w(e):3===n?new C(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?S(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?S(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=d.exec(t))?new C(e[1],e[2],e[3],1):(e=f.exec(t))?new C(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=p.exec(t))?S(e[1],e[2],e[3],e[4]):(e=g.exec(t))?S(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=m.exec(t))?I(e[1],e[2]/100,e[3]/100,1):(e=y.exec(t))?I(e[1],e[2]/100,e[3]/100,e[4]):v.hasOwnProperty(t)?w(v[t]):"transparent"===t?new C(NaN,NaN,NaN,0):null}function w(t){return new C(t>>16&255,t>>8&255,255&t,1)}function S(t,e,n,i){return i<=0&&(t=e=n=NaN),new C(t,e,n,i)}function k(t){return(t instanceof r||(t=b(t)),t)?new C((t=t.rgb()).r,t.g,t.b,t.opacity):new C}function E(t,e,n,i){return 1==arguments.length?k(t):new C(t,e,n,null==i?1:i)}function C(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function L(){return`#${N(this.r)}${N(this.g)}${N(this.b)}`}function $(){let t=O(this.opacity);return`${1===t?"rgb(":"rgba("}${R(this.r)}, ${R(this.g)}, ${R(this.b)}${1===t?")":`, ${t})`}`}function O(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function R(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function N(t){return((t=R(t))<16?"0":"")+t.toString(16)}function I(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new z(t,e,n,i)}function T(t){if(t instanceof z)return new z(t.h,t.s,t.l,t.opacity);if(t instanceof r||(t=b(t)),!t)return new z;if(t instanceof z)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,o=Math.min(e,n,i),a=Math.max(e,n,i),s=NaN,l=a-o,u=(a+o)/2;return l?(s=e===a?(n-i)/l+(n<i)*6:n===a?(i-e)/l+2:(e-n)/l+4,l/=u<.5?a+o:2-a-o,s*=60):l=u>0&&u<1?0:s,new z(s,l,u,t.opacity)}function A(t,e,n,i){return 1==arguments.length?T(t):new z(t,e,n,null==i?1:i)}function z(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function M(t){return(t=(t||0)%360)<0?t+360:t}function P(t){return Math.max(0,Math.min(1,t||0))}function D(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}(0,i.default)(r,b,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:_,formatHex:_,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return T(this).formatHsl()},formatRgb:x,toString:x}),(0,i.default)(C,E,(0,i.extend)(r,{brighter(t){return t=null==t?s:Math.pow(s,t),new C(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?o:Math.pow(o,t),new C(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new C(R(this.r),R(this.g),R(this.b),O(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:L,formatHex:L,formatHex8:function(){return`#${N(this.r)}${N(this.g)}${N(this.b)}${N((isNaN(this.opacity)?1:this.opacity)*255)}`},formatRgb:$,toString:$})),(0,i.default)(z,A,(0,i.extend)(r,{brighter(t){return t=null==t?s:Math.pow(s,t),new z(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?o:Math.pow(o,t),new z(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new C(D(t>=240?t-240:t+120,r,i),D(t,r,i),D(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new z(M(this.h),P(this.s),P(this.l),O(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=O(this.opacity);return`${1===t?"hsl(":"hsla("}${M(this.h)}, ${100*P(this.s)}%, ${100*P(this.l)}%${1===t?")":`, ${t})`}`}}))}),s("bfWFq",function(e,n){function i(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function r(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}t(e.exports,"default",()=>i),t(e.exports,"extend",()=>r)});const l=t=>"string"==typeof t,u=()=>{let t,e,n=new Promise((n,i)=>{t=n,e=i});return n.resolve=t,n.reject=e,n},h=t=>null==t?"":""+t,c=(t,e,n)=>{t.forEach(t=>{e[t]&&(n[t]=e[t])})},d=/###/g,f=t=>t&&t.indexOf("###")>-1?t.replace(d,"."):t,p=t=>!t||l(t),g=(t,e,n)=>{let i=l(e)?e.split("."):e,r=0;for(;r<i.length-1;){if(p(t))return{};let e=f(i[r]);!t[e]&&n&&(t[e]=new n),t=Object.prototype.hasOwnProperty.call(t,e)?t[e]:{},++r}return p(t)?{}:{obj:t,k:f(i[r])}},m=(t,e,n)=>{let{obj:i,k:r}=g(t,e,Object);if(void 0!==i||1===e.length){i[r]=n;return}let o=e[e.length-1],a=e.slice(0,e.length-1),s=g(t,a,Object);for(;void 0===s.obj&&a.length;)o=`${a[a.length-1]}.${o}`,(s=g(t,a=a.slice(0,a.length-1),Object))&&s.obj&&void 0!==s.obj[`${s.k}.${o}`]&&(s.obj=void 0);s.obj[`${s.k}.${o}`]=n},y=(t,e,n,i)=>{let{obj:r,k:o}=g(t,e,Object);r[o]=r[o]||[],r[o].push(n)},v=(t,e)=>{let{obj:n,k:i}=g(t,e);if(n)return n[i]},_=(t,e,n)=>{let i=v(t,n);return void 0!==i?i:v(e,n)},x=(t,e,n)=>{for(let i in e)"__proto__"!==i&&"constructor"!==i&&(i in t?l(t[i])||t[i]instanceof String||l(e[i])||e[i]instanceof String?n&&(t[i]=e[i]):x(t[i],e[i],n):t[i]=e[i]);return t},b=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const S=t=>l(t)?t.replace(/[&<>"'\/]/g,t=>w[t]):t,k=[" ",",","?","!",";"],E=new class{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){let e=this.regExpMap.get(t);if(void 0!==e)return e;let n=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,n),this.regExpQueue.push(t),n}}(20),C=(t,e,n)=>{e=e||"",n=n||"";let i=k.filter(t=>0>e.indexOf(t)&&0>n.indexOf(t));if(0===i.length)return!0;let r=E.getRegExp(`(${i.map(t=>"?"===t?"\\?":t).join("|")})`),o=!r.test(t);if(!o){let e=t.indexOf(n);e>0&&!r.test(t.substring(0,e))&&(o=!0)}return o},L=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!t)return;if(t[e])return t[e];let i=e.split(n),r=t;for(let t=0;t<i.length;){let e;if(!r||"object"!=typeof r)return;let o="";for(let a=t;a<i.length;++a)if(a!==t&&(o+=n),o+=i[a],void 0!==(e=r[o])){if(["string","number","boolean"].indexOf(typeof e)>-1&&a<i.length-1)continue;t+=a-t+1;break}r=e}return r},$=t=>t&&t.replace("_","-"),O={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console&&console[t]&&console[t].apply(console,e)}};class R{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(t,e)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||O,this.options=e,this.debug=e.debug}log(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}warn(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}error(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}deprecate(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,n,i){return i&&!this.debug?null:(l(t[0])&&(t[0]=`${n}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new R(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new R(this.logger,t)}}var N=new R;class I{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach(t=>{this.observers[t]||(this.observers[t]=new Map);let n=this.observers[t].get(e)||0;this.observers[t].set(e,n+1)}),this}off(t,e){if(this.observers[t]){if(!e){delete this.observers[t];return}this.observers[t].delete(e)}}emit(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(t=>{let[e,i]=t;for(let t=0;t<i;t++)e(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(e=>{let[i,r]=e;for(let e=0;e<r;e++)i.apply(i,[t,...n])})}}class T extends I{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){0>this.options.ns.indexOf(t)&&this.options.ns.push(t)}removeNamespaces(t){let e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,n){let i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,a=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure;t.indexOf(".")>-1?i=t.split("."):(i=[t,e],n&&(Array.isArray(n)?i.push(...n):l(n)&&o?i.push(...n.split(o)):i.push(n)));let s=v(this.data,i);return(!s&&!e&&!n&&t.indexOf(".")>-1&&(t=i[0],e=i[1],n=i.slice(2).join(".")),!s&&a&&l(n))?L(this.data&&this.data[t]&&this.data[t][e],n,o):s}addResource(t,e,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},o=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,a=[t,e];n&&(a=a.concat(o?n.split(o):n)),t.indexOf(".")>-1&&(a=t.split("."),i=e,e=a[1]),this.addNamespaces(e),m(this.data,a,i),r.silent||this.emit("added",t,e,n,i)}addResources(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(let i in n)(l(n[i])||Array.isArray(n[i]))&&this.addResource(t,e,i,n[i],{silent:!0});i.silent||this.emit("added",t,e,n)}addResourceBundle(t,e,n,i,r){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},a=[t,e];t.indexOf(".")>-1&&(a=t.split("."),i=n,n=e,e=a[1]),this.addNamespaces(e);let s=v(this.data,a)||{};o.skipCopy||(n=JSON.parse(JSON.stringify(n))),i?x(s,n,r):s={...s,...n},m(this.data,a,s),o.silent||this.emit("added",t,e,n)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return void 0!==this.getResource(t,e)}getResourceBundle(t,e){return(e||(e=this.options.defaultNS),"v1"===this.options.compatibilityAPI)?{...this.getResource(t,e)}:this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){let e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find(t=>e[t]&&Object.keys(e[t]).length>0)}toJSON(){return this.data}}var A={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,i,r){return t.forEach(t=>{this.processors[t]&&(e=this.processors[t].process(e,n,i,r))}),e}};const z={};class M extends I{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),c(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=N.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==t)return!1;let n=this.resolve(t,e);return n&&void 0!==n.res}extractFromKey(t,e){let n=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");let i=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,r=e.ns||this.options.defaultNS||[],o=n&&t.indexOf(n)>-1,a=!this.options.userDefinedKeySeparator&&!e.keySeparator&&!this.options.userDefinedNsSeparator&&!e.nsSeparator&&!C(t,n,i);if(o&&!a){let e=t.match(this.interpolator.nestingRegexp);if(e&&e.length>0)return{key:t,namespaces:l(r)?[r]:r};let o=t.split(n);(n!==i||n===i&&this.options.ns.indexOf(o[0])>-1)&&(r=o.shift()),t=o.join(i)}return{key:t,namespaces:l(r)?[r]:r}}translate(t,e,n){if("object"!=typeof e&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof e&&(e={...e}),e||(e={}),null==t)return"";Array.isArray(t)||(t=[String(t)]);let i=void 0!==e.returnDetails?e.returnDetails:this.options.returnDetails,r=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,{key:o,namespaces:a}=this.extractFromKey(t[t.length-1],e),s=a[a.length-1],u=e.lng||this.language,h=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&"cimode"===u.toLowerCase()){if(h){let t=e.nsSeparator||this.options.nsSeparator;return i?{res:`${s}${t}${o}`,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:s,usedParams:this.getUsedParamsDetails(e)}:`${s}${t}${o}`}return i?{res:o,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:s,usedParams:this.getUsedParamsDetails(e)}:o}let c=this.resolve(t,e),d=c&&c.res,f=c&&c.usedKey||o,p=c&&c.exactUsedKey||o,g=Object.prototype.toString.apply(d),m=void 0!==e.joinArrays?e.joinArrays:this.options.joinArrays,y=!this.i18nFormat||this.i18nFormat.handleAsObject,v=!l(d)&&"boolean"!=typeof d&&"number"!=typeof d;if(y&&d&&v&&0>["[object Number]","[object Function]","[object RegExp]"].indexOf(g)&&!(l(m)&&Array.isArray(d))){if(!e.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");let t=this.options.returnedObjectHandler?this.options.returnedObjectHandler(f,d,{...e,ns:a}):`key '${o} (${this.language})' returned an object instead of string.`;return i?(c.res=t,c.usedParams=this.getUsedParamsDetails(e),c):t}if(r){let t=Array.isArray(d),n=t?[]:{},i=t?p:f;for(let t in d)if(Object.prototype.hasOwnProperty.call(d,t)){let o=`${i}${r}${t}`;n[t]=this.translate(o,{...e,joinArrays:!1,ns:a}),n[t]===o&&(n[t]=d[t])}d=n}}else if(y&&l(m)&&Array.isArray(d))(d=d.join(m))&&(d=this.extendTranslation(d,t,e,n));else{let i=!1,a=!1,h=void 0!==e.count&&!l(e.count),f=M.hasDefaultValue(e),p=h?this.pluralResolver.getSuffix(u,e.count,e):"",g=e.ordinal&&h?this.pluralResolver.getSuffix(u,e.count,{ordinal:!1}):"",m=h&&!e.ordinal&&0===e.count&&this.pluralResolver.shouldUseIntlApi(),y=m&&e[`defaultValue${this.options.pluralSeparator}zero`]||e[`defaultValue${p}`]||e[`defaultValue${g}`]||e.defaultValue;!this.isValidLookup(d)&&f&&(i=!0,d=y),this.isValidLookup(d)||(a=!0,d=o);let v=(e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&a?void 0:d,_=f&&y!==d&&this.options.updateMissing;if(a||i||_){if(this.logger.log(_?"updateKey":"missingKey",u,s,o,_?y:d),r){let t=this.resolve(o,{...e,keySeparator:!1});t&&t.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let t=[],n=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if("fallback"===this.options.saveMissingTo&&n&&n[0])for(let e=0;e<n.length;e++)t.push(n[e]);else"all"===this.options.saveMissingTo?t=this.languageUtils.toResolveHierarchy(e.lng||this.language):t.push(e.lng||this.language);let i=(t,n,i)=>{let r=f&&i!==d?i:v;this.options.missingKeyHandler?this.options.missingKeyHandler(t,s,n,r,_,e):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(t,s,n,r,_,e),this.emit("missingKey",t,s,n,d)};this.options.saveMissing&&(this.options.saveMissingPlurals&&h?t.forEach(t=>{let n=this.pluralResolver.getSuffixes(t,e);m&&e[`defaultValue${this.options.pluralSeparator}zero`]&&0>n.indexOf(`${this.options.pluralSeparator}zero`)&&n.push(`${this.options.pluralSeparator}zero`),n.forEach(n=>{i([t],o+n,e[`defaultValue${n}`]||y)})}):i(t,o,y))}d=this.extendTranslation(d,t,e,c,n),a&&d===o&&this.options.appendNamespaceToMissingKey&&(d=`${s}:${o}`),(a||i)&&this.options.parseMissingKeyHandler&&(d="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${s}:${o}`:o,i?d:void 0):this.options.parseMissingKeyHandler(d))}return i?(c.res=d,c.usedParams=this.getUsedParamsDetails(e),c):d}extendTranslation(t,e,n,i,r){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){let a;n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});let s=l(t)&&(n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(s){let e=t.match(this.interpolator.nestingRegexp);a=e&&e.length}let u=n.replace&&!l(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(u={...this.options.interpolation.defaultVariables,...u}),t=this.interpolator.interpolate(t,u,n.lng||this.language||i.usedLng,n),s){let e=t.match(this.interpolator.nestingRegexp);a<(e&&e.length)&&(n.nest=!1)}!n.lng&&"v1"!==this.options.compatibilityAPI&&i&&i.res&&(n.lng=this.language||i.usedLng),!1!==n.nest&&(t=this.interpolator.nest(t,function(){for(var t=arguments.length,i=Array(t),a=0;a<t;a++)i[a]=arguments[a];return r&&r[0]===i[0]&&!n.context?(o.logger.warn(`It seems you are nesting recursively key: ${i[0]} in key: ${e[0]}`),null):o.translate(...i,e)},n)),n.interpolation&&this.interpolator.reset()}let a=n.postProcess||this.options.postProcess,s=l(a)?[a]:a;return null!=t&&s&&s.length&&!1!==n.applyPostProcessor&&(t=A.handle(s,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),t}resolve(t){let e,n,i,r,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(t)&&(t=[t]),t.forEach(t=>{if(this.isValidLookup(e))return;let s=this.extractFromKey(t,a),u=s.key;n=u;let h=s.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));let c=void 0!==a.count&&!l(a.count),d=c&&!a.ordinal&&0===a.count&&this.pluralResolver.shouldUseIntlApi(),f=void 0!==a.context&&(l(a.context)||"number"==typeof a.context)&&""!==a.context,p=a.lngs?a.lngs:this.languageUtils.toResolveHierarchy(a.lng||this.language,a.fallbackLng);h.forEach(t=>{this.isValidLookup(e)||(o=t,!z[`${p[0]}-${t}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(o)&&(z[`${p[0]}-${t}`]=!0,this.logger.warn(`key "${n}" for languages "${p.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(n=>{let o;if(this.isValidLookup(e))return;r=n;let s=[u];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(s,u,n,t,a);else{let t;c&&(t=this.pluralResolver.getSuffix(n,a.count,a));let e=`${this.options.pluralSeparator}zero`,i=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(c&&(s.push(u+t),a.ordinal&&0===t.indexOf(i)&&s.push(u+t.replace(i,this.options.pluralSeparator)),d&&s.push(u+e)),f){let n=`${u}${this.options.contextSeparator}${a.context}`;s.push(n),c&&(s.push(n+t),a.ordinal&&0===t.indexOf(i)&&s.push(n+t.replace(i,this.options.pluralSeparator)),d&&s.push(n+e))}}for(;o=s.pop();)this.isValidLookup(e)||(i=o,e=this.getResource(n,t,o,a))}))})}),{res:e,usedKey:n,exactUsedKey:i,usedLng:r,usedNS:o}}isValidLookup(t){return void 0!==t&&!(!this.options.returnNull&&null===t)&&!(!this.options.returnEmptyString&&""===t)}getResource(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,e,n,i):this.resourceStore.getResource(t,e,n,i)}getUsedParamsDetails(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.replace&&!l(t.replace),n=e?t.replace:t;if(e&&void 0!==t.count&&(n.count=t.count),this.options.interpolation.defaultVariables&&(n={...this.options.interpolation.defaultVariables,...n}),!e)for(let t of(n={...n},["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"]))delete n[t];return n}static hasDefaultValue(t){let e="defaultValue";for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e===n.substring(0,e.length)&&void 0!==t[n])return!0;return!1}}const P=t=>t.charAt(0).toUpperCase()+t.slice(1);class D{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=N.create("languageUtils")}getScriptPartFromCode(t){if(!(t=$(t))||0>t.indexOf("-"))return null;let e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase())?null:this.formatLanguageCode(e.join("-"))}getLanguagePartFromCode(t){if(!(t=$(t))||0>t.indexOf("-"))return t;let e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if(l(t)&&t.indexOf("-")>-1){if("undefined"!=typeof Intl&&void 0!==Intl.getCanonicalLocales)try{let e=Intl.getCanonicalLocales(t)[0];if(e&&this.options.lowerCaseLng&&(e=e.toLowerCase()),e)return e}catch(t){}let e=["hans","hant","latn","cyrl","cans","mong","arab"],n=t.split("-");return this.options.lowerCaseLng?n=n.map(t=>t.toLowerCase()):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=P(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),e.indexOf(n[1].toLowerCase())>-1&&(n[1]=P(n[1].toLowerCase())),e.indexOf(n[2].toLowerCase())>-1&&(n[2]=P(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){let e;return t?(t.forEach(t=>{if(e)return;let n=this.formatLanguageCode(t);(!this.options.supportedLngs||this.isSupportedCode(n))&&(e=n)}),!e&&this.options.supportedLngs&&t.forEach(t=>{if(e)return;let n=this.getLanguagePartFromCode(t);if(this.isSupportedCode(n))return e=n;e=this.options.supportedLngs.find(t=>{if(t===n||!(0>t.indexOf("-")&&0>n.indexOf("-"))&&(t.indexOf("-")>0&&0>n.indexOf("-")&&t.substring(0,t.indexOf("-"))===n||0===t.indexOf(n)&&n.length>1))return t})}),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e):null}getFallbackCodes(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),l(t)&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t[this.getLanguagePartFromCode(e)]),n||(n=t.default),n||[]}toResolveHierarchy(t,e){let n=this.getFallbackCodes(e||this.options.fallbackLng||[],t),i=[],r=t=>{t&&(this.isSupportedCode(t)?i.push(t):this.logger.warn(`rejecting language code not found in supportedLngs: ${t}`))};return l(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?("languageOnly"!==this.options.load&&r(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&r(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&r(this.getLanguagePartFromCode(t))):l(t)&&r(this.formatLanguageCode(t)),n.forEach(t=>{0>i.indexOf(t)&&r(this.formatLanguageCode(t))}),i}}let F=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],j={1:t=>Number(t>1),2:t=>Number(1!=t),3:t=>0,4:t=>Number(t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2),5:t=>Number(0==t?0:1==t?1:2==t?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5),6:t=>Number(1==t?0:t>=2&&t<=4?1:2),7:t=>Number(1==t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2),8:t=>Number(1==t?0:2==t?1:8!=t&&11!=t?2:3),9:t=>Number(t>=2),10:t=>Number(1==t?0:2==t?1:t<7?2:t<11?3:4),11:t=>Number(1==t||11==t?0:2==t||12==t?1:t>2&&t<20?2:3),12:t=>Number(t%10!=1||t%100==11),13:t=>Number(0!==t),14:t=>Number(1==t?0:2==t?1:3==t?2:3),15:t=>Number(t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2),16:t=>Number(t%10==1&&t%100!=11?0:0!==t?1:2),17:t=>Number(+(1!=t&&(t%10!=1||t%100==11))),18:t=>Number(0==t?0:1==t?1:2),19:t=>Number(1==t?0:0==t||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3),20:t=>Number(1==t?0:0==t||t%100>0&&t%100<20?1:2),21:t=>Number(t%100==1?1:t%100==2?2:3*(t%100==3||t%100==4)),22:t=>Number(1==t?0:2==t?1:(t<0||t>10)&&t%10==0?2:3)};const B=["v1","v2","v3"],V=["v4"],H={zero:0,one:1,two:2,few:3,many:4,other:5},U=()=>{let t={};return F.forEach(e=>{e.lngs.forEach(n=>{t[n]={numbers:e.nr,plurals:j[e.fc]}})}),t};class q{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=t,this.options=e,this.logger=N.create("pluralResolver"),(!this.options.compatibilityJSON||V.includes(this.options.compatibilityJSON))&&("undefined"==typeof Intl||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=U(),this.pluralRulesCache={}}addRule(t,e){this.rules[t]=e}clearCache(){this.pluralRulesCache={}}getRule(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi()){let n,i=$("dev"===t?"en":t),r=e.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:i,type:r});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];try{n=new Intl.PluralRules(i,{type:r})}catch(r){if(!t.match(/-|_/))return;let i=this.languageUtils.getLanguagePartFromCode(t);n=this.getRule(i,e)}return this.pluralRulesCache[o]=n,n}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}needsPlural(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(t,e);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}getPluralFormsOfKey(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(t,n).map(t=>`${e}${t}`)}getSuffixes(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(t,e);return n?this.shouldUseIntlApi()?n.resolvedOptions().pluralCategories.sort((t,e)=>H[t]-H[e]).map(t=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${t}`):n.numbers.map(n=>this.getSuffix(t,n,e)):[]}getSuffix(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getRule(t,n);return i?this.shouldUseIntlApi()?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i.select(e)}`:this.getSuffixRetroCompatible(i,e):(this.logger.warn(`no plural rule found for: ${t}`),"")}getSuffixRetroCompatible(t,e){let n=t.noAbs?t.plurals(e):t.plurals(Math.abs(e)),i=t.numbers[n];this.options.simplifyPluralSuffix&&2===t.numbers.length&&1===t.numbers[0]&&(2===i?i="plural":1===i&&(i=""));let r=()=>this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString();return"v1"===this.options.compatibilityJSON?1===i?"":"number"==typeof i?`_plural_${i.toString()}`:r():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===t.numbers.length&&1===t.numbers[0]?r():this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString()}shouldUseIntlApi(){return!B.includes(this.options.compatibilityJSON)}}const K=function(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",r=!(arguments.length>4)||void 0===arguments[4]||arguments[4],o=_(t,e,n);return!o&&r&&l(n)&&void 0===(o=L(t,n,i))&&(o=L(e,n,i)),o},G=t=>t.replace(/\$/g,"$$$$");class W{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=N.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||(t=>t),this.init(t)}init(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});let{escape:e,escapeValue:n,useRawValueToEscape:i,prefix:r,prefixEscaped:o,suffix:a,suffixEscaped:s,formatSeparator:l,unescapeSuffix:u,unescapePrefix:h,nestingPrefix:c,nestingPrefixEscaped:d,nestingSuffix:f,nestingSuffixEscaped:p,nestingOptionsSeparator:g,maxReplaces:m,alwaysFormat:y}=t.interpolation;this.escape=void 0!==e?e:S,this.escapeValue=void 0===n||n,this.useRawValueToEscape=void 0!==i&&i,this.prefix=r?b(r):o||"{{",this.suffix=a?b(a):s||"}}",this.formatSeparator=l||",",this.unescapePrefix=u?"":h||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=c?b(c):d||b("$t("),this.nestingSuffix=f?b(f):p||b(")"),this.nestingOptionsSeparator=g||",",this.maxReplaces=m||1e3,this.alwaysFormat=void 0!==y&&y,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let t=(t,e)=>t&&t.source===e?(t.lastIndex=0,t):RegExp(e,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,e,n,i){let r,o,a,s=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=t=>{if(0>t.indexOf(this.formatSeparator)){let r=K(e,s,t,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(r,void 0,n,{...i,...e,interpolationkey:t}):r}let r=t.split(this.formatSeparator),o=r.shift().trim(),a=r.join(this.formatSeparator).trim();return this.format(K(e,s,o,this.options.keySeparator,this.options.ignoreJSONStructure),a,n,{...i,...e,interpolationkey:o})};this.resetRegExp();let c=i&&i.missingInterpolationHandler||this.options.missingInterpolationHandler,d=i&&i.interpolation&&void 0!==i.interpolation.skipOnVariables?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:t=>G(t)},{regex:this.regexp,safeValue:t=>this.escapeValue?G(this.escape(t)):G(t)}].forEach(e=>{for(a=0;r=e.regex.exec(t);){let n=r[1].trim();if(void 0===(o=u(n)))if("function"==typeof c){let e=c(t,r,i);o=l(e)?e:""}else if(i&&Object.prototype.hasOwnProperty.call(i,n))o="";else if(d){o=r[0];continue}else this.logger.warn(`missed to pass in variable ${n} for interpolating ${t}`),o="";else l(o)||this.useRawValueToEscape||(o=h(o));let s=e.safeValue(o);if(t=t.replace(r[0],s),d?(e.regex.lastIndex+=o.length,e.regex.lastIndex-=r[0].length):e.regex.lastIndex=0,++a>=this.maxReplaces)break}}),t}nest(t,e){let n,i,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=(t,e)=>{let n=this.nestingOptionsSeparator;if(0>t.indexOf(n))return t;let i=t.split(RegExp(`${n}[ ]*{`)),o=`{${i[1]}`;t=i[0];let a=(o=this.interpolate(o,r)).match(/'/g),s=o.match(/"/g);(a&&a.length%2==0&&!s||s.length%2!=0)&&(o=o.replace(/'/g,'"'));try{r=JSON.parse(o),e&&(r={...e,...r})}catch(e){return this.logger.warn(`failed parsing options string in nesting for key ${t}`,e),`${t}${n}${o}`}return r.defaultValue&&r.defaultValue.indexOf(this.prefix)>-1&&delete r.defaultValue,t};for(;n=this.nestingRegexp.exec(t);){let s=[];(r=(r={...o}).replace&&!l(r.replace)?r.replace:r).applyPostProcessor=!1,delete r.defaultValue;let u=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){let t=n[1].split(this.formatSeparator).map(t=>t.trim());n[1]=t.shift(),s=t,u=!0}if((i=e(a.call(this,n[1].trim(),r),r))&&n[0]===t&&!l(i))return i;l(i)||(i=h(i)),i||(this.logger.warn(`missed to resolve ${n[1]} for nesting ${t}`),i=""),u&&(i=s.reduce((t,e)=>this.format(t,e,o.lng,{...o,interpolationkey:n[1].trim()}),i.trim())),t=t.replace(n[0],i),this.regexp.lastIndex=0}return t}}const Y=t=>{let e=t.toLowerCase().trim(),n={};if(t.indexOf("(")>-1){let i=t.split("(");e=i[0].toLowerCase().trim();let r=i[1].substring(0,i[1].length-1);"currency"===e&&0>r.indexOf(":")?n.currency||(n.currency=r.trim()):"relativetime"===e&&0>r.indexOf(":")?n.range||(n.range=r.trim()):r.split(";").forEach(t=>{if(t){let[e,...i]=t.split(":"),r=i.join(":").trim().replace(/^'+|'+$/g,""),o=e.trim();n[o]||(n[o]=r),"false"===r&&(n[o]=!1),"true"===r&&(n[o]=!0),isNaN(r)||(n[o]=parseInt(r,10))}})}return{formatName:e,formatOptions:n}},J=t=>{let e={};return(n,i,r)=>{let o=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(o={...o,[r.interpolationkey]:void 0});let a=i+JSON.stringify(o),s=e[a];return s||(s=t($(i),r),e[a]=s),s(n)}};class X{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=N.create("formatter"),this.options=t,this.formats={number:J((t,e)=>{let n=new Intl.NumberFormat(t,{...e});return t=>n.format(t)}),currency:J((t,e)=>{let n=new Intl.NumberFormat(t,{...e,style:"currency"});return t=>n.format(t)}),datetime:J((t,e)=>{let n=new Intl.DateTimeFormat(t,{...e});return t=>n.format(t)}),relativetime:J((t,e)=>{let n=new Intl.RelativeTimeFormat(t,{...e});return t=>n.format(t,e.range||"day")}),list:J((t,e)=>{let n=new Intl.ListFormat(t,{...e});return t=>n.format(t)})},this.init(t)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};this.formatSeparator=e.interpolation.formatSeparator||","}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=J(e)}format(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=e.split(this.formatSeparator);if(r.length>1&&r[0].indexOf("(")>1&&0>r[0].indexOf(")")&&r.find(t=>t.indexOf(")")>-1)){let t=r.findIndex(t=>t.indexOf(")")>-1);r[0]=[r[0],...r.splice(1,t)].join(this.formatSeparator)}return r.reduce((t,e)=>{let{formatName:r,formatOptions:o}=Y(e);if(this.formats[r]){let e=t;try{let a=i&&i.formatParams&&i.formatParams[i.interpolationkey]||{},s=a.locale||a.lng||i.locale||i.lng||n;e=this.formats[r](t,s,{...o,...i,...a})}catch(t){this.logger.warn(t)}return e}return this.logger.warn(`there was no format function for ${r}`),t},t)}}const Q=(t,e)=>{void 0!==t.pending[e]&&(delete t.pending[e],t.pendingCount--)};class Z extends I{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=t,this.store=e,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=N.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(n,i.backend,i)}queueLoad(t,e,n,i){let r={},o={},a={},s={};return t.forEach(t=>{let i=!0;e.forEach(e=>{let a=`${t}|${e}`;!n.reload&&this.store.hasResourceBundle(t,e)?this.state[a]=2:this.state[a]<0||(1===this.state[a]?void 0===o[a]&&(o[a]=!0):(this.state[a]=1,i=!1,void 0===o[a]&&(o[a]=!0),void 0===r[a]&&(r[a]=!0),void 0===s[e]&&(s[e]=!0)))}),i||(a[t]=!0)}),(Object.keys(r).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(r),pending:Object.keys(o),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(s)}}loaded(t,e,n){let i=t.split("|"),r=i[0],o=i[1];e&&this.emit("failedLoading",r,o,e),!e&&n&&this.store.addResourceBundle(r,o,n,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2,e&&n&&(this.state[t]=0);let a={};this.queue.forEach(n=>{y(n.loaded,[r],o),Q(n,t),e&&n.errors.push(e),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach(t=>{a[t]||(a[t]={});let e=n.loaded[t];e.length&&e.forEach(e=>{void 0===a[t][e]&&(a[t][e]=!0)})}),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(t=>!t.done)}read(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!t.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:e,fcName:n,tried:i,wait:r,callback:o});return}this.readingCalls++;let a=(a,s)=>{if(this.readingCalls--,this.waitingReads.length>0){let t=this.waitingReads.shift();this.read(t.lng,t.ns,t.fcName,t.tried,t.wait,t.callback)}if(a&&s&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,t,e,n,i+1,2*r,o)},r);return}o(a,s)},s=this.backend[n].bind(this.backend);if(2===s.length){try{let n=s(t,e);n&&"function"==typeof n.then?n.then(t=>a(null,t)).catch(a):a(null,n)}catch(t){a(t)}return}return s(t,e,a)}prepareLoading(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();l(t)&&(t=this.languageUtils.toResolveHierarchy(t)),l(e)&&(e=[e]);let r=this.queueLoad(t,e,n,i);if(!r.toLoad.length)return r.pending.length||i(),null;r.toLoad.forEach(t=>{this.loadOne(t)})}load(t,e,n){this.prepareLoading(t,e,{},n)}reload(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}loadOne(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t.split("|"),i=n[0],r=n[1];this.read(i,r,"read",void 0,void 0,(n,o)=>{n&&this.logger.warn(`${e}loading namespace ${r} for language ${i} failed`,n),!n&&o&&this.logger.log(`${e}loaded namespace ${r} for language ${i}`,o),this.loaded(t,n,o)})}saveMissing(t,e,n,i,r){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)){this.logger.warn(`did not save key "${n}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(null!=n&&""!==n){if(this.backend&&this.backend.create){let s={...o,isUpdate:r},l=this.backend.create.bind(this.backend);if(l.length<6)try{let r;(r=5===l.length?l(t,e,n,i,s):l(t,e,n,i))&&"function"==typeof r.then?r.then(t=>a(null,t)).catch(a):a(null,r)}catch(t){a(t)}else l(t,e,n,i,a,s)}t&&t[0]&&this.store.addResource(t[0],e,n,i)}}}const tt=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if("object"==typeof t[1]&&(e=t[1]),l(t[1])&&(e.defaultValue=t[1]),l(t[2])&&(e.tDescription=t[2]),"object"==typeof t[2]||"object"==typeof t[3]){let n=t[3]||t[2];Object.keys(n).forEach(t=>{e[t]=n[t]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),te=t=>(l(t.ns)&&(t.ns=[t.ns]),l(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),l(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&0>t.supportedLngs.indexOf("cimode")&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t),tn=()=>{},ti=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(e=>{"function"==typeof t[e]&&(t[e]=t[e].bind(t))})};class tr extends I{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;if(super(),this.options=te(t),this.services={},this.logger=N,this.modules={external:[]},ti(this),e&&!this.isInitialized&&!t.isClone){if(!this.options.initImmediate)return this.init(t,e),this;setTimeout(()=>{this.init(t,e)},0)}}init(){var t=this;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"==typeof e&&(n=e,e={}),!e.defaultNS&&!1!==e.defaultNS&&e.ns&&(l(e.ns)?e.defaultNS=e.ns:0>e.ns.indexOf("translation")&&(e.defaultNS=e.ns[0]));let i=tt();this.options={...i,...this.options,...te(e)},"v1"!==this.options.compatibilityAPI&&(this.options.interpolation={...i.interpolation,...this.options.interpolation}),void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator);let r=t=>t?"function"==typeof t?new t:t:null;if(!this.options.isClone){let e;this.modules.logger?N.init(r(this.modules.logger),this.options):N.init(null,this.options),this.modules.formatter?e=this.modules.formatter:"undefined"!=typeof Intl&&(e=X);let n=new D(this.options);this.store=new T(this.options.resources,this.options);let o=this.services;o.logger=N,o.resourceStore=this.store,o.languageUtils=n,o.pluralResolver=new q(n,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),e&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(o.formatter=r(e),o.formatter.init(o,this.options),this.options.interpolation.format=o.formatter.format.bind(o.formatter)),o.interpolator=new W(this.options),o.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},o.backendConnector=new Z(r(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",function(e){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t.emit(e,...i)}),this.modules.languageDetector&&(o.languageDetector=r(this.modules.languageDetector),o.languageDetector.init&&o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=r(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new M(this.services,this.options),this.translator.on("*",function(e){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];t.emit(e,...i)}),this.modules.external.forEach(t=>{t.init&&t.init(this)})}if(this.format=this.options.interpolation.format,n||(n=tn),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let t=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);t.length>0&&"dev"!==t[0]&&(this.options.lng=t[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(e=>{this[e]=function(){return t.store[e](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(e=>{this[e]=function(){return t.store[e](...arguments),t}});let o=u(),a=()=>{let t=(t,e)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(e),n(t,e)};if(this.languages&&"v1"!==this.options.compatibilityAPI&&!this.isInitialized)return t(null,this.t.bind(this));this.changeLanguage(this.options.lng,t)};return this.options.resources||!this.options.initImmediate?a():setTimeout(a,0),o}loadResources(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tn,n=e,i=l(t)?t:this.language;if("function"==typeof t&&(n=t),!this.options.resources||this.options.partialBundledLanguages){if(i&&"cimode"===i.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return n();let t=[],e=e=>{e&&"cimode"!==e&&this.services.languageUtils.toResolveHierarchy(e).forEach(e=>{"cimode"!==e&&0>t.indexOf(e)&&t.push(e)})};i?e(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(t=>e(t)),this.options.preload&&this.options.preload.forEach(t=>e(t)),this.services.backendConnector.load(t,this.options.ns,t=>{t||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),n(t)})}else n(null)}reloadResources(t,e,n){let i=u();return"function"==typeof t&&(n=t,t=void 0),"function"==typeof e&&(n=e,e=void 0),t||(t=this.languages),e||(e=this.options.ns),n||(n=tn),this.services.backendConnector.reload(t,e,t=>{i.resolve(),n(t)}),i}use(t){if(!t)throw Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&A.addPostProcessor(t),"formatter"===t.type&&(this.modules.formatter=t),"3rdParty"===t.type&&this.modules.external.push(t),this}setResolvedLanguage(t){if(t&&this.languages&&!(["cimode","dev"].indexOf(t)>-1))for(let t=0;t<this.languages.length;t++){let e=this.languages[t];if(!(["cimode","dev"].indexOf(e)>-1)&&this.store.hasLanguageSomeTranslations(e)){this.resolvedLanguage=e;break}}}changeLanguage(t,e){var n=this;this.isLanguageChangingTo=t;let i=u();this.emit("languageChanging",t);let r=t=>{this.language=t,this.languages=this.services.languageUtils.toResolveHierarchy(t),this.resolvedLanguage=void 0,this.setResolvedLanguage(t)},o=(t,o)=>{o?(r(o),this.translator.changeLanguage(o),this.isLanguageChangingTo=void 0,this.emit("languageChanged",o),this.logger.log("languageChanged",o)):this.isLanguageChangingTo=void 0,i.resolve(function(){return n.t(...arguments)}),e&&e(t,function(){return n.t(...arguments)})},a=e=>{t||e||!this.services.languageDetector||(e=[]);let n=l(e)?e:this.services.languageUtils.getBestMatchFromCodes(e);n&&(this.language||r(n),this.translator.language||this.translator.changeLanguage(n),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(n)),this.loadResources(n,t=>{o(t,n)})};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(t):a(this.services.languageDetector.detect()),i}getFixedT(t,e,n){var i=this;let r=function(t,e){let o,a;if("object"!=typeof e){for(var s=arguments.length,l=Array(s>2?s-2:0),u=2;u<s;u++)l[u-2]=arguments[u];o=i.options.overloadTranslationOptionHandler([t,e].concat(l))}else o={...e};o.lng=o.lng||r.lng,o.lngs=o.lngs||r.lngs,o.ns=o.ns||r.ns,""!==o.keyPrefix&&(o.keyPrefix=o.keyPrefix||n||r.keyPrefix);let h=i.options.keySeparator||".";return a=o.keyPrefix&&Array.isArray(t)?t.map(t=>`${o.keyPrefix}${h}${t}`):o.keyPrefix?`${o.keyPrefix}${h}${t}`:t,i.t(a,o)};return l(t)?r.lng=t:r.lngs=t,r.ns=e,r.keyPrefix=n,r}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let n=e.lng||this.resolvedLanguage||this.languages[0],i=!!this.options&&this.options.fallbackLng,r=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;let o=(t,e)=>{let n=this.services.backendConnector.state[`${t}|${e}`];return -1===n||0===n||2===n};if(e.precheck){let t=e.precheck(this,o);if(void 0!==t)return t}return!!(this.hasResourceBundle(n,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(n,t)&&(!i||o(r,t)))}loadNamespaces(t,e){let n=u();return this.options.ns?(l(t)&&(t=[t]),t.forEach(t=>{0>this.options.ns.indexOf(t)&&this.options.ns.push(t)}),this.loadResources(t=>{n.resolve(),e&&e(t)}),n):(e&&e(),Promise.resolve())}loadLanguages(t,e){let n=u();l(t)&&(t=[t]);let i=this.options.preload||[],r=t.filter(t=>0>i.indexOf(t)&&this.services.languageUtils.isSupportedCode(t));return r.length?(this.options.preload=i.concat(r),this.loadResources(t=>{n.resolve(),e&&e(t)}),n):(e&&e(),Promise.resolve())}dir(t){return(t||(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),t)?["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf((this.services&&this.services.languageUtils||new D(tt())).getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr":"rtl"}static createInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return new tr(t,e)}cloneInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tn,n=t.forkResourceStore;n&&delete t.forkResourceStore;let i={...this.options,...t,isClone:!0},r=new tr(i);return(void 0!==t.debug||void 0!==t.prefix)&&(r.logger=r.logger.clone(t)),["store","services","language"].forEach(t=>{r[t]=this[t]}),r.services={...this.services},r.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},n&&(r.store=new T(this.store.data,i),r.services.resourceStore=r.store),r.translator=new M(r.services,i),r.translator.on("*",function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];r.emit(t,...n)}),r.init(i,e),r.translator.options=i,r.translator.backendConnector.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const to=tr.createInstance();function ta(t){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}to.createInstance=tr.createInstance,to.createInstance,to.dir,to.init,to.loadResources,to.reloadResources,to.use,to.changeLanguage,to.getFixedT,to.t,to.exists,to.setDefaultNamespace,to.hasLoadedNamespace,to.loadNamespaces,to.loadLanguages;var ts=[],tl=ts.forEach,tu=ts.slice,th=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,tc=function(t,e,n){var i=n||{};i.path=i.path||"/";var r=encodeURIComponent(e),o="".concat(t,"=").concat(r);if(i.maxAge>0){var a=i.maxAge-0;if(Number.isNaN(a))throw Error("maxAge should be a Number");o+="; Max-Age=".concat(Math.floor(a))}if(i.domain){if(!th.test(i.domain))throw TypeError("option domain is invalid");o+="; Domain=".concat(i.domain)}if(i.path){if(!th.test(i.path))throw TypeError("option path is invalid");o+="; Path=".concat(i.path)}if(i.expires){if("function"!=typeof i.expires.toUTCString)throw TypeError("option expires is invalid");o+="; Expires=".concat(i.expires.toUTCString())}if(i.httpOnly&&(o+="; HttpOnly"),i.secure&&(o+="; Secure"),i.sameSite)switch("string"==typeof i.sameSite?i.sameSite.toLowerCase():i.sameSite){case!0:case"strict":o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"none":o+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return o},td={create:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};n&&(r.expires=new Date,r.expires.setTime(r.expires.getTime()+6e4*n)),i&&(r.domain=i),document.cookie=tc(t,encodeURIComponent(e),r)},read:function(t){for(var e="".concat(t,"="),n=document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return null},remove:function(t){this.create(t,"",-1)}},tf={name:"cookie",lookup:function(t){var e;if(t.lookupCookie&&"undefined"!=typeof document){var n=td.read(t.lookupCookie);n&&(e=n)}return e},cacheUserLanguage:function(t,e){e.lookupCookie&&"undefined"!=typeof document&&td.create(e.lookupCookie,t,e.cookieMinutes,e.cookieDomain,e.cookieOptions)}},tp={name:"querystring",lookup:function(t){var e;if("undefined"!=typeof window){var n=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(n=window.location.hash.substring(window.location.hash.indexOf("?")));for(var i=n.substring(1).split("&"),r=0;r<i.length;r++){var o=i[r].indexOf("=");o>0&&i[r].substring(0,o)===t.lookupQuerystring&&(e=i[r].substring(o+1))}}return e}},tg=null,tm=function(){if(null!==tg)return tg;try{tg="undefined"!==window&&null!==window.localStorage;var t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch(t){tg=!1}return tg},ty={name:"localStorage",lookup:function(t){var e;if(t.lookupLocalStorage&&tm()){var n=window.localStorage.getItem(t.lookupLocalStorage);n&&(e=n)}return e},cacheUserLanguage:function(t,e){e.lookupLocalStorage&&tm()&&window.localStorage.setItem(e.lookupLocalStorage,t)}},tv=null,t_=function(){if(null!==tv)return tv;try{tv="undefined"!==window&&null!==window.sessionStorage;var t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch(t){tv=!1}return tv},tx={name:"sessionStorage",lookup:function(t){var e;if(t.lookupSessionStorage&&t_()){var n=window.sessionStorage.getItem(t.lookupSessionStorage);n&&(e=n)}return e},cacheUserLanguage:function(t,e){e.lookupSessionStorage&&t_()&&window.sessionStorage.setItem(e.lookupSessionStorage,t)}},tb={name:"navigator",lookup:function(t){var e=[];if("undefined"!=typeof navigator){if(navigator.languages)for(var n=0;n<navigator.languages.length;n++)e.push(navigator.languages[n]);navigator.userLanguage&&e.push(navigator.userLanguage),navigator.language&&e.push(navigator.language)}return e.length>0?e:void 0}},tw={name:"htmlTag",lookup:function(t){var e,n=t.htmlTag||("undefined"!=typeof document?document.documentElement:null);return n&&"function"==typeof n.getAttribute&&(e=n.getAttribute("lang")),e}},tS={name:"path",lookup:function(t){var e;if("undefined"!=typeof window){var n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(n instanceof Array)if("number"==typeof t.lookupFromPathIndex){if("string"!=typeof n[t.lookupFromPathIndex])return;e=n[t.lookupFromPathIndex].replace("/","")}else e=n[0].replace("/","")}return e}},tk={name:"subdomain",lookup:function(t){var e="number"==typeof t.lookupFromSubdomainIndex?t.lookupFromSubdomainIndex+1:1,n="undefined"!=typeof window&&window.location&&window.location.hostname&&window.location.hostname.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(n)return n[e]}},tE=!1;try{document.cookie,tE=!0}catch(t){}var tC=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];tE||tC.splice(1,1);var tL=(eT=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(this instanceof t))throw TypeError("Cannot call a class as a function");this.type="languageDetector",this.detectors={},this.init(e,n)},eA=[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=t||{languageUtils:{}},this.options=function(t){return tl.call(tu.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t}(e,this.options||{},{order:tC,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:function(t){return t}}),"string"==typeof this.options.convertDetectedLanguage&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=function(t){return t.replace("-","_")}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(tf),this.addDetector(tp),this.addDetector(ty),this.addDetector(tx),this.addDetector(tb),this.addDetector(tw),this.addDetector(tS),this.addDetector(tk)}},{key:"addDetector",value:function(t){return this.detectors[t.name]=t,this}},{key:"detect",value:function(t){var e=this;t||(t=this.options.order);var n=[];return(t.forEach(function(t){if(e.detectors[t]){var i=e.detectors[t].lookup(e.options);i&&"string"==typeof i&&(i=[i]),i&&(n=n.concat(i))}}),n=n.map(function(t){return e.options.convertDetectedLanguage(t)}),this.services.languageUtils.getBestMatchFromCodes)?n:n.length>0?n[0]:null}},{key:"cacheUserLanguage",value:function(t,e){var n=this;e||(e=this.options.caches),e&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||e.forEach(function(e){n.detectors[e]&&n.detectors[e].cacheUserLanguage(t,n.options)}))}}],function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!=ta(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=ta(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ta(e)?e:e+""}(i.key),i)}}(eT.prototype,eA),Object.defineProperty(eT,"prototype",{writable:!1}),eT);tL.type="languageDetector";const t$={en:{translation:{appTitle:"Family Tree Visualization",inputTitle:"Input Data",configTitle:"Configuration",layoutTitle:"Layout Options",visualTitle:"Visual Options",exportTitle:"Export Options",visTitle:"Family Tree Visualization",fileLabel:"Choose CSV File:",loadSample:"Load Sample Data",orientation:"Orientation:",topDown:"Top Down",bottomUp:"Bottom Up",leftRight:"Left to Right",rightLeft:"Right to Left",nodeSize:"Node Size:",nodeSpacing:"Node Spacing:",colorScheme:"Color Scheme:",default:"Default",genderBased:"Gender-Based",generationBased:"Generation-Based",custom:"Custom",fontSize:"Font Size:",lineStyle:"Line Style:",straight:"Straight",curved:"Curved",angled:"Angled",svgWidth:"SVG Width (pixels):",svgHeight:"SVG Height (pixels):",generateTree:"Generate Tree",exportSVG:"Export SVG",resetView:"Reset View",language:"Language:",born:"Born:",died:"Died:",age:"Age:",nativePlace:"Native Place:",spouse:"Spouse:",father:"Father:",mother:"Mother:",son:"Son",daughter:"Daughter",husband:"Husband",wife:"Wife",uploadFirst:"Please upload a CSV file or load sample data first.",generateFirst:"Please generate a family tree first.",parseError:"Error parsing CSV file:",generateError:"Error generating family tree:",exportError:"Error exporting SVG:",footerText:"Family Tree Visualization Tool - Multilingual Support"}},ta:{translation:{appTitle:"குடும்ப மர காட்சிப்படுத்தல்",inputTitle:"உள்ளீட்டு தரவு",configTitle:"கட்டமைப்பு",layoutTitle:"அமைப்பு விருப்பங்கள்",visualTitle:"காட்சி விருப்பங்கள்",exportTitle:"ஏற்றுமதி விருப்பங்கள்",visTitle:"குடும்ப மர காட்சி",fileLabel:"CSV கோப்பைத் தேர்ந்தெடுக்கவும்:",loadSample:"மாதிரி தரவை ஏற்றவும்",orientation:"அமைப்பு:",topDown:"மேலிருந்து கீழ்",bottomUp:"கீழிருந்து மேல்",leftRight:"இடமிருந்து வலம்",rightLeft:"வலமிருந்து இடம்",nodeSize:"முனை அளவு:",nodeSpacing:"முனை இடைவெளி:",colorScheme:"வண்ண திட்டம்:",default:"இயல்புநிலை",genderBased:"பாலின அடிப்படையில்",generationBased:"தலைமுறை அடிப்படையில்",custom:"தனிப்பயன்",fontSize:"எழுத்து அளவு:",lineStyle:"கோட்டு பாணி:",straight:"நேரான",curved:"வளைந்த",angled:"கோணமான",svgWidth:"SVG அகலம் (பிக்சல்கள்):",svgHeight:"SVG உயரம் (பிக்சல்கள்):",generateTree:"மரத்தை உருவாக்கு",exportSVG:"SVG ஏற்றுமதி",resetView:"காட்சியை மீட்டமை",language:"மொழி:",born:"பிறந்த தேதி:",died:"இறந்த தேதி:",age:"வயது:",nativePlace:"சொந்த ஊர்:",spouse:"துணைவர்:",father:"தந்தை:",mother:"தாய்:",son:"மகன்",daughter:"மகள்",husband:"கணவர்",wife:"மனைவி",uploadFirst:"முதலில் CSV கோப்பை பதிவேற்றவும் அல்லது மாதிரி தரவை ஏற்றவும்.",generateFirst:"முதலில் குடும்ப மரத்தை உருவாக்கவும்.",parseError:"CSV கோப்பை பகுப்பாய்வதில் பிழை:",generateError:"குடும்ப மரத்தை உருவாக்குவதில் பிழை:",exportError:"SVG ஏற்றுமதியில் பிழை:",footerText:"குடும்ப மர காட்சிப்படுத்தல் கருவி - பல மொழி ஆதரவு"}}};async function tO(){return await to.use(tL).init({resources:t$,fallbackLng:"en",debug:!1,interpolation:{escapeValue:!1}}),to}function tR(t,e={}){return to.t(t,e)}var tN={};function tI(t,e=null){console.log(`[CSVParser] ${t}`),e&&console.log(e)}function tT(t){tI("Validating CSV fields",t);let e=["id","name","gender"].filter(e=>!t.includes(e));if(e.length>0)throw Error(`Missing required fields: ${e.join(", ")}`);tI("All required fields present")}function tA(t){tI(`Processing ${t.length} rows of CSV data`);let e=t.map(t=>{try{return{id:t.id,name:t.name.trim(),gender:t.gender.trim(),spouse_name:t.spouse_name?t.spouse_name.trim():null,father_name:t.father_name?t.father_name.trim():null,mother_name:t.mother_name?t.mother_name.trim():null,birth_date:t.birth_date?t.birth_date.trim():null,death_date:t.death_date?t.death_date.trim():null,native_place:t.native_place?t.native_place.trim():null,father_id:t.father_id?t.father_id.trim():null,mother_id:t.mother_id?t.mother_id.trim():null,spouse_id:t.spouse_id?t.spouse_id.trim():null}}catch(e){throw tI("Error processing row",{row:t,error:e}),Error(`Error processing row with ID ${t.id||"unknown"}: ${e.message}`)}});return tI(`Successfully processed ${e.length} rows`),e}function tz(t,e="en"){if(!t)return"";if("string"==typeof t)return t;try{return t.toLocaleDateString("ta"===e?"ta-IN":e,{year:"numeric",month:"long",day:"numeric"})}catch(e){return console.warn("Date formatting error:",e),t.toISOString().split("T")[0]}}function tM(t,e=null){console.log(`[FamilyTreeBuilder] ${t}`),e&&console.log(e)}function tP(t,e,n){let i=e[n+"Id"];if(i&&t[i]){let n=t[i];e.parents.includes(n)||e.parents.push(n),n.children.includes(e)||n.children.push(e)}}function tD(t,e,n){if(e.parents.length>0)return;let i=e[n+"Name"];if(i){let r=Object.values(t).find(t=>t.name.toLowerCase()===i.toLowerCase()&&("father"===n?"male"===t.gender:"female"===t.gender));r&&(e.parents.includes(r)||e.parents.push(r),r.children.includes(e)||r.children.push(e))}}ez=function t(){var e,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},i=!n.document&&!!n.postMessage,r=n.IS_PAPA_WORKER||!1,o={},a=0,s={};function l(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var e=_(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null),this._handle=new f(e),(this._handle.streamer=this)._config=e}).call(this,t),this.parseChunk=function(t,e){var i=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<i){let e=this._config.newline;e||(o=this._config.quoteChar||'"',e=this._handle.guessLineEndings(t,o)),t=[...t.split(e).slice(i)].join(e)}this.isFirstChunk&&b(this._config.beforeFirstChunk)&&void 0!==(o=this._config.beforeFirstChunk(t))&&(t=o),this.isFirstChunk=!1,this._halted=!1;var i=this._partialLine+t,o=(this._partialLine="",this._handle.parse(i,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=o.meta.cursor,this._finished||(this._partialLine=i.substring(t-this._baseIndex),this._baseIndex=t),o&&o.data&&(this._rowCount+=o.data.length),i=this._finished||this._config.preview&&this._rowCount>=this._config.preview,r)n.postMessage({results:o,workerId:s.WORKER_ID,finished:i});else if(b(this._config.chunk)&&!e){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=o=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),this._completed||!i||!b(this._config.complete)||o&&o.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),i||o&&o.meta.paused||this._nextChunk(),o}this._halted=!0},this._sendError=function(t){b(this._config.error)?this._config.error(t):r&&this._config.error&&n.postMessage({workerId:s.WORKER_ID,error:t,finished:!1})}}function u(t){var e;(t=t||{}).chunkSize||(t.chunkSize=s.RemoteChunkSize),l.call(this,t),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(t){this._input=t,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),i||(e.onload=x(this._chunkLoaded,this),e.onerror=x(this._chunkError,this)),e.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var t,n,r=this._config.downloadRequestHeaders;for(n in r)e.setRequestHeader(n,r[n])}this._config.chunkSize&&(t=this._start+this._config.chunkSize-1,e.setRequestHeader("Range","bytes="+this._start+"-"+t));try{e.send(this._config.downloadRequestBody)}catch(t){this._chunkError(t.message)}i&&0===e.status&&this._chunkError()}},this._chunkLoaded=function(){let t;4===e.readyState&&(e.status<200||400<=e.status?this._chunkError():(this._start+=this._config.chunkSize||e.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null!==(t=(t=e).getResponseHeader("Content-Range"))?parseInt(t.substring(t.lastIndexOf("/")+1)):-1),this.parseChunk(e.responseText)))},this._chunkError=function(t){t=e.statusText||t,this._sendError(Error(t))}}function h(t){(t=t||{}).chunkSize||(t.chunkSize=s.LocalChunkSize),l.call(this,t);var e,n,i="undefined"!=typeof FileReader;this.stream=function(t){this._input=t,n=t.slice||t.webkitSlice||t.mozSlice,i?((e=new FileReader).onload=x(this._chunkLoaded,this),e.onerror=x(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var t=this._input,r=(this._config.chunkSize&&(r=Math.min(this._start+this._config.chunkSize,this._input.size),t=n.call(t,this._start,r)),e.readAsText(t,this._config.encoding));i||this._chunkLoaded({target:{result:r}})},this._chunkLoaded=function(t){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(t.target.result)},this._chunkError=function(){this._sendError(e.error)}}function c(t){var e;l.call(this,t=t||{}),this.stream=function(t){return e=t,this._nextChunk()},this._nextChunk=function(){var t,n;if(!this._finished)return e=(t=this._config.chunkSize)?(n=e.substring(0,t),e.substring(t)):(n=e,""),this._finished=!e,this.parseChunk(n)}}function d(t){l.call(this,t=t||{});var e=[],n=!0,i=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(t){this._input=t,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){i&&1===e.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):n=!0},this._streamData=x(function(t){try{e.push("string"==typeof t?t:t.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(t){this._streamError(t)}},this),this._streamError=x(function(t){this._streamCleanUp(),this._sendError(t)},this),this._streamEnd=x(function(){this._streamCleanUp(),i=!0,this._streamData("")},this),this._streamCleanUp=x(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function f(t){var e,n,i,r,o=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,a=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,l=this,u=0,h=0,c=!1,d=!1,f=[],m={data:[],errors:[],meta:{}};function y(e){return"greedy"===t.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function v(){if(m&&i&&(w("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),i=!1),t.skipEmptyLines&&(m.data=m.data.filter(function(t){return!y(t)})),x()){if(m)if(Array.isArray(m.data[0])){for(var e,n=0;x()&&n<m.data.length;n++)m.data[n].forEach(r);m.data.splice(0,1)}else m.data.forEach(r);function r(e,n){b(t.transformHeader)&&(e=t.transformHeader(e,n)),f.push(e)}}function l(e,n){for(var i=t.header?{}:[],r=0;r<e.length;r++){var s=r,l=e[r],l=((e,n)=>(t.dynamicTypingFunction&&void 0===t.dynamicTyping[e]&&(t.dynamicTyping[e]=t.dynamicTypingFunction(e)),!0===(t.dynamicTyping[e]||t.dynamicTyping))?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&((t=>{if(o.test(t)&&-0x20000000000000<(t=parseFloat(t))&&t<0x20000000000000)return 1})(n)?parseFloat(n):a.test(n)?new Date(n):""===n?null:n):n)(s=t.header?r>=f.length?"__parsed_extra":f[r]:s,l=t.transform?t.transform(l,s):l);"__parsed_extra"===s?(i[s]=i[s]||[],i[s].push(l)):i[s]=l}return t.header&&(r>f.length?w("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+r,h+n):r<f.length&&w("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+r,h+n)),i}m&&(t.header||t.dynamicTyping||t.transform)&&(e=1,!m.data.length||Array.isArray(m.data[0])?(m.data=m.data.map(l),e=m.data.length):m.data=l(m.data,0),t.header&&m.meta&&(m.meta.fields=f),h+=e)}function x(){return t.header&&0===f.length}function w(t,e,n,i){t={type:t,code:e,message:n},void 0!==i&&(t.row=i),m.errors.push(t)}b(t.step)&&(r=t.step,t.step=function(e){m=e,x()?v():(v(),0!==m.data.length&&(u+=e.data.length,t.preview&&u>t.preview?n.abort():(m.data=m.data[0],r(m,l))))}),this.parse=function(r,o,a){var l=t.quoteChar||'"',l=(t.newline||(t.newline=this.guessLineEndings(r,l)),i=!1,t.delimiter?b(t.delimiter)&&(t.delimiter=t.delimiter(r),m.meta.delimiter=t.delimiter):((l=((e,n,i,r,o)=>{var a,l,u,h;o=o||[",","	","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var c=0;c<o.length;c++){for(var d,f=o[c],p=0,m=0,v=0,_=(u=void 0,new g({comments:r,delimiter:f,newline:n,preview:10}).parse(e)),x=0;x<_.data.length;x++)i&&y(_.data[x])?v++:(m+=d=_.data[x].length,void 0===u?u=d:0<d&&(p+=Math.abs(d-u),u=d));0<_.data.length&&(m/=_.data.length-v),(void 0===l||p<=l)&&(void 0===h||h<m)&&1.99<m&&(l=p,a=f,h=m)}return{successful:!!(t.delimiter=a),bestDelimiter:a}})(r,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess)).successful?t.delimiter=l.bestDelimiter:(i=!0,t.delimiter=s.DefaultDelimiter),m.meta.delimiter=t.delimiter),_(t));return t.preview&&t.header&&l.preview++,e=r,m=(n=new g(l)).parse(e,o,a),v(),c?{meta:{paused:!0}}:m||{meta:{paused:!1}}},this.paused=function(){return c},this.pause=function(){c=!0,n.abort(),e=b(t.chunk)?"":e.substring(n.getCharIndex())},this.resume=function(){l.streamer._halted?(c=!1,l.streamer.parseChunk(e,!0)):setTimeout(l.resume,3)},this.aborted=function(){return d},this.abort=function(){d=!0,n.abort(),m.meta.aborted=!0,b(t.complete)&&t.complete(m),e=""},this.guessLineEndings=function(t,e){t=t.substring(0,1048576);var e=RegExp(p(e)+"([^]*?)"+p(e),"gm"),n=(t=t.replace(e,"")).split("\r"),e=t.split("\n"),t=1<e.length&&e[0].length<n[0].length;if(1===n.length||t)return"\n";for(var i=0,r=0;r<n.length;r++)"\n"===n[r][0]&&i++;return i>=n.length/2?"\r\n":"\r"}}function p(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(t){var e=(t=t||{}).delimiter,n=t.newline,i=t.comments,r=t.step,o=t.preview,a=t.fastMode,l=null,u=!1,h=null==t.quoteChar?'"':t.quoteChar,c=h;if(void 0!==t.escapeChar&&(c=t.escapeChar),("string"!=typeof e||-1<s.BAD_DELIMITERS.indexOf(e))&&(e=","),i===e)throw Error("Comment character same as delimiter");!0===i?i="#":("string"!=typeof i||-1<s.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var d=0,f=!1;this.parse=function(s,g,m){if("string"!=typeof s)throw Error("Input must be a string");var y=s.length,v=e.length,_=n.length,x=i.length,w=b(r),S=[],k=[],E=[],C=d=0;if(!s)return D();if(a||!1!==a&&-1===s.indexOf(h)){for(var L=s.split(n),$=0;$<L.length;$++){if(E=L[$],d+=E.length,$!==L.length-1)d+=n.length;else if(m)break;if(!i||E.substring(0,x)!==i){if(w){if(S=[],A(E.split(e)),F(),f)return D()}else A(E.split(e));if(o&&o<=$)return S=S.slice(0,o),D(!0)}}return D()}for(var O=s.indexOf(e,d),R=s.indexOf(n,d),N=RegExp(p(c)+p(h),"g"),I=s.indexOf(h,d);;)if(s[d]===h)for(I=d,d++;;){if(-1===(I=s.indexOf(h,I+1)))return m||k.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:S.length,index:d}),M();if(I===y-1)return M(s.substring(d,I).replace(N,h));if(h===c&&s[I+1]===c)I++;else if(h===c||0===I||s[I-1]!==c){-1!==O&&O<I+1&&(O=s.indexOf(e,I+1));var T=z(-1===(R=-1!==R&&R<I+1?s.indexOf(n,I+1):R)?O:Math.min(O,R));if(s.substr(I+1+T,v)===e){E.push(s.substring(d,I).replace(N,h)),s[d=I+1+T+v]!==h&&(I=s.indexOf(h,d)),O=s.indexOf(e,d),R=s.indexOf(n,d);break}if(T=z(R),s.substring(I+1+T,I+1+T+_)===n){if(E.push(s.substring(d,I).replace(N,h)),P(I+1+T+_),O=s.indexOf(e,d),I=s.indexOf(h,d),w&&(F(),f))return D();if(o&&S.length>=o)return D(!0);break}k.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:S.length,index:d}),I++}}else if(i&&0===E.length&&s.substring(d,d+x)===i){if(-1===R)return D();d=R+_,R=s.indexOf(n,d),O=s.indexOf(e,d)}else if(-1!==O&&(O<R||-1===R))E.push(s.substring(d,O)),d=O+v,O=s.indexOf(e,d);else{if(-1===R)break;if(E.push(s.substring(d,R)),P(R+_),w&&(F(),f))return D();if(o&&S.length>=o)return D(!0)}return M();function A(t){S.push(t),C=d}function z(t){return -1!==t&&(t=s.substring(I+1,t))&&""===t.trim()?t.length:0}function M(t){return m||(void 0===t&&(t=s.substring(d)),E.push(t),d=y,A(E),w&&F()),D()}function P(t){d=t,A(E),E=[],R=s.indexOf(n,d)}function D(i){if(t.header&&!g&&S.length&&!u){var r=S[0],o={},a=new Set(r);let e=!1;for(let n=0;n<r.length;n++){let i=r[n];if(o[i=b(t.transformHeader)?t.transformHeader(i,n):i]){let t,s=o[i];for(;t=i+"_"+s,s++,a.has(t););a.add(t),r[n]=t,o[i]++,e=!0,(l=null===l?{}:l)[t]=i}else o[i]=1,r[n]=i;a.add(i)}e&&console.warn("Duplicate headers found and renamed."),u=!0}return{data:S,errors:k,meta:{delimiter:e,linebreak:n,aborted:f,truncated:!!i,cursor:C+(g||0),renamedHeaders:l}}}function F(){r(D()),S=[],k=[]}},this.abort=function(){f=!0},this.getCharIndex=function(){return d}}function m(t){var e=t.data,n=o[e.workerId],i=!1;if(e.error)n.userError(e.error,e.file);else if(e.results&&e.results.data){var r={abort:function(){i=!0,y(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(b(n.userStep)){for(var a=0;a<e.results.data.length&&(n.userStep({data:e.results.data[a],errors:e.results.errors,meta:e.results.meta},r),!i);a++);delete e.results}else b(n.userChunk)&&(n.userChunk(e.results,r,e.file),delete e.results)}e.finished&&!i&&y(e.workerId,e.results)}function y(t,e){var n=o[t];b(n.userComplete)&&n.userComplete(e),n.terminate(),delete o[t]}function v(){throw Error("Not implemented.")}function _(t){if("object"!=typeof t||null===t)return t;var e,n=Array.isArray(t)?[]:{};for(e in t)n[e]=_(t[e]);return n}function x(t,e){return function(){t.apply(e,arguments)}}function b(t){return"function"==typeof t}return s.parse=function(e,i){var r,l,f,p=(i=i||{}).dynamicTyping||!1;if(b(p)&&(i.dynamicTypingFunction=p,p={}),i.dynamicTyping=p,i.transform=!!b(i.transform)&&i.transform,!i.worker||!s.WORKERS_SUPPORTED){let t;return p=null,s.NODE_STREAM_INPUT,"string"==typeof e?(e=65279!==(t=e).charCodeAt(0)?t:t.slice(1),p=new(i.download?u:c)(i)):!0===e.readable&&b(e.read)&&b(e.on)?p=new d(i):(n.File&&e instanceof File||e instanceof Object)&&(p=new h(i)),p.stream(e)}(p=!!s.WORKERS_SUPPORTED&&(l=n.URL||n.webkitURL||null,f=t.toString(),r=s.BLOB_URL||(s.BLOB_URL=l.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",f,")();"],{type:"text/javascript"}))),(r=new n.Worker(r)).onmessage=m,r.id=a++,o[r.id]=r)).userStep=i.step,p.userChunk=i.chunk,p.userComplete=i.complete,p.userError=i.error,i.step=b(i.step),i.chunk=b(i.chunk),i.complete=b(i.complete),i.error=b(i.error),delete i.worker,p.postMessage({input:e,config:i,workerId:p.id})},s.unparse=function(t,e){var n=!1,i=!0,r=",",o="\r\n",a='"',l=a+a,u=!1,h=null,c=!1,d=((()=>{if("object"==typeof e){if("string"!=typeof e.delimiter||s.BAD_DELIMITERS.filter(function(t){return -1!==e.delimiter.indexOf(t)}).length||(r=e.delimiter),("boolean"==typeof e.quotes||"function"==typeof e.quotes||Array.isArray(e.quotes))&&(n=e.quotes),"boolean"!=typeof e.skipEmptyLines&&"string"!=typeof e.skipEmptyLines||(u=e.skipEmptyLines),"string"==typeof e.newline&&(o=e.newline),"string"==typeof e.quoteChar&&(a=e.quoteChar),"boolean"==typeof e.header&&(i=e.header),Array.isArray(e.columns)){if(0===e.columns.length)throw Error("Option columns is empty");h=e.columns}void 0!==e.escapeChar&&(l=e.escapeChar+a),e.escapeFormulae instanceof RegExp?c=e.escapeFormulae:"boolean"==typeof e.escapeFormulae&&e.escapeFormulae&&(c=/^[=+\-@\t\r].*$/)}})(),RegExp(p(a),"g"));if("string"==typeof t&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return f(null,t,u);if("object"==typeof t[0])return f(h||Object.keys(t[0]),t,u)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields||h),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:"object"==typeof t.data[0]?Object.keys(t.data[0]):[]),Array.isArray(t.data[0])||"object"==typeof t.data[0]||(t.data=[t.data])),f(t.fields||[],t.data||[],u);throw Error("Unable to serialize unrecognized input");function f(t,e,n){var a="",s=("string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e)),Array.isArray(t)&&0<t.length),l=!Array.isArray(e[0]);if(s&&i){for(var u=0;u<t.length;u++)0<u&&(a+=r),a+=g(t[u],u);0<e.length&&(a+=o)}for(var h=0;h<e.length;h++){var c=(s?t:e[h]).length,d=!1,f=s?0===Object.keys(e[h]).length:0===e[h].length;if(n&&!s&&(d="greedy"===n?""===e[h].join("").trim():1===e[h].length&&0===e[h][0].length),"greedy"===n&&s){for(var p=[],m=0;m<c;m++){var y=l?t[m]:m;p.push(e[h][y])}d=""===p.join("").trim()}if(!d){for(var v=0;v<c;v++){0<v&&!f&&(a+=r);var _=s&&l?t[v]:v;a+=g(e[h][_],v)}h<e.length-1&&(!n||0<c&&!f)&&(a+=o)}}return a}function g(t,e){var i,o;return null==t?"":t.constructor===Date?JSON.stringify(t).slice(1,25):(o=!1,c&&"string"==typeof t&&c.test(t)&&(t="'"+t,o=!0),i=t.toString().replace(d,l),(o=o||!0===n||"function"==typeof n&&n(t,e)||Array.isArray(n)&&n[e]||((t,e)=>{for(var n=0;n<e.length;n++)if(-1<t.indexOf(e[n]))return!0;return!1})(i,s.BAD_DELIMITERS)||-1<i.indexOf(r)||" "===i.charAt(0)||" "===i.charAt(i.length-1))?a+i+a:i)}},s.RECORD_SEP="\x1e",s.UNIT_SEP="\x1f",s.BYTE_ORDER_MARK="\uFEFF",s.BAD_DELIMITERS=["\r","\n",'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!i&&!!n.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=0xa00000,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=g,s.ParserHandle=f,s.NetworkStreamer=u,s.FileStreamer=h,s.StringStreamer=c,s.ReadableStreamStreamer=d,n.jQuery&&((e=n.jQuery).fn.parse=function(t){var i=t.config||{},r=[];return this.each(function(t){if(!("INPUT"===e(this).prop("tagName").toUpperCase()&&"file"===e(this).attr("type").toLowerCase()&&n.FileReader)||!this.files||0===this.files.length)return!0;for(var o=0;o<this.files.length;o++)r.push({file:this.files[o],inputElem:this,instanceConfig:e.extend({},i)})}),o(),this;function o(){if(0===r.length)b(t.complete)&&t.complete();else{var n,i,o,l=r[0];if(b(t.before)){var u=t.before(l.file,l.inputElem);if("object"==typeof u){if("abort"===u.action)return n=l.file,i=l.inputElem,o=u.reason,void(b(t.error)&&t.error({name:"AbortError"},n,i,o));if("skip"===u.action)return void a();"object"==typeof u.config&&(l.instanceConfig=e.extend(l.instanceConfig,u.config))}else if("skip"===u)return void a()}var h=l.instanceConfig.complete;l.instanceConfig.complete=function(t){b(h)&&h(t,l.file,l.inputElem),a()},s.parse(l.file,l.instanceConfig)}}function a(){r.splice(0,1),o()}}),r&&(n.onmessage=function(t){t=t.data,void 0===s.WORKER_ID&&t&&(s.WORKER_ID=t.workerId),"string"==typeof t.input?n.postMessage({workerId:s.WORKER_ID,results:s.parse(t.input,t.config),finished:!0}):(n.File&&t.input instanceof File||t.input instanceof Object)&&(t=s.parse(t.input,t.config))&&n.postMessage({workerId:s.WORKER_ID,results:t,finished:!0})}),(u.prototype=Object.create(l.prototype)).constructor=u,(h.prototype=Object.create(l.prototype)).constructor=h,(c.prototype=Object.create(c.prototype)).constructor=c,(d.prototype=Object.create(l.prototype)).constructor=d,s},"function"==typeof define&&define.amd?define([],ez):tN=ez();var tF={value:()=>{}};function tj(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw Error("illegal type: "+t);i[t]=[]}return new tB(i)}function tB(t){this._=t}function tV(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=tF,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}function tH(){}function tU(t){return null==t?tH:function(){return this.querySelector(t)}}function tq(){return[]}function tK(t){return null==t?tq:function(){return this.querySelectorAll(t)}}function tG(t){return function(){return this.matches(t)}}function tW(t){return function(e){return e.matches(t)}}tB.prototype=tj.prototype={constructor:tB,on:function(t,e){var n,i=this._,r=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw Error("unknown type: "+t);return{type:t,name:e}}),o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((n=(t=r[o]).type)&&(n=function(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}(i[n],t.name)))return n;return}if(null!=e&&"function"!=typeof e)throw Error("invalid callback: "+e);for(;++o<a;)if(n=(t=r[o]).type)i[n]=tV(i[n],t.name,e);else if(null==e)for(n in i)i[n]=tV(i[n],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new tB(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw Error("unknown type: "+t);for(i=this._[t],o=0,n=i.length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};var tY=Array.prototype.find;function tJ(){return this.firstElementChild}var tX=Array.prototype.filter;function tQ(){return Array.from(this.children)}function tZ(t){return Array(t.length)}function t0(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function t1(t,e,n,i,r,o){for(var a,s=0,l=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],i[s]=a):n[s]=new t0(t,o[s]);for(;s<l;++s)(a=e[s])&&(r[s]=a)}function t2(t,e,n,i,r,o,a){var s,l,u,h=new Map,c=e.length,d=o.length,f=Array(c);for(s=0;s<c;++s)(l=e[s])&&(f[s]=u=a.call(l,l.__data__,s,e)+"",h.has(u)?r[s]=l:h.set(u,l));for(s=0;s<d;++s)u=a.call(t,o[s],s,o)+"",(l=h.get(u))?(i[s]=l,l.__data__=o[s],h.delete(u)):n[s]=new t0(t,o[s]);for(s=0;s<c;++s)(l=e[s])&&h.get(f[s])===l&&(r[s]=l)}function t5(t){return t.__data__}function t3(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}t0.prototype={constructor:t0,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var t8="http://www.w3.org/1999/xhtml",t9={svg:"http://www.w3.org/2000/svg",xhtml:t8,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function t4(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),t9.hasOwnProperty(e)?{space:t9[e],local:t}:t}function t6(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function t7(t,e){return t.style.getPropertyValue(e)||t6(t).getComputedStyle(t,null).getPropertyValue(e)}function et(t){return t.trim().split(/^|\s+/)}function ee(t){return t.classList||new en(t)}function en(t){this._node=t,this._names=et(t.getAttribute("class")||"")}function ei(t,e){for(var n=ee(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function er(t,e){for(var n=ee(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function eo(){this.textContent=""}function ea(){this.innerHTML=""}function es(){this.nextSibling&&this.parentNode.appendChild(this)}function el(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function eu(t){var e=t4(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===t8&&e.documentElement.namespaceURI===t8?e.createElement(t):e.createElementNS(n,t)}})(e)}function eh(){return null}function ec(){var t=this.parentNode;t&&t.removeChild(this)}function ed(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ef(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ep(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,o=e.length;i<o;++i)(n=e[i],t.type&&n.type!==t.type||n.name!==t.name)?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function eg(t,e,n){return function(){var i,r=this.__on,o=function(t){e.call(this,t,this.__data__)};if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function em(t,e,n){var i=t6(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}en.prototype={add:function(t){0>this._names.indexOf(t)&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ey=[null];function ev(t,e){this._groups=t,this._parents=e}function e_(){return new ev([[document.documentElement]],ey)}function ex(t){return"string"==typeof t?new ev([[document.querySelector(t)]],[document.documentElement]):new ev([[t]],ey)}ev.prototype=e_.prototype={constructor:ev,select:function(t){"function"!=typeof t&&(t=tU(t));for(var e=this._groups,n=e.length,i=Array(n),r=0;r<n;++r)for(var o,a,s=e[r],l=s.length,u=i[r]=Array(l),h=0;h<l;++h)(o=s[h])&&(a=t.call(o,o.__data__,h,s))&&("__data__"in o&&(a.__data__=o.__data__),u[h]=a);return new ev(i,this._parents)},selectAll:function(t){if("function"==typeof t){var e;e=t,t=function(){var t;return t=e.apply(this,arguments),null==t?[]:Array.isArray(t)?t:Array.from(t)}}else t=tK(t);for(var n=this._groups,i=n.length,r=[],o=[],a=0;a<i;++a)for(var s,l=n[a],u=l.length,h=0;h<u;++h)(s=l[h])&&(r.push(t.call(s,s.__data__,h,l)),o.push(s));return new ev(r,o)},selectChild:function(t){var e;return this.select(null==t?tJ:(e="function"==typeof t?t:tW(t),function(){return tY.call(this.children,e)}))},selectChildren:function(t){var e;return this.selectAll(null==t?tQ:(e="function"==typeof t?t:tW(t),function(){return tX.call(this.children,e)}))},filter:function(t){"function"!=typeof t&&(t=tG(t));for(var e=this._groups,n=e.length,i=Array(n),r=0;r<n;++r)for(var o,a=e[r],s=a.length,l=i[r]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new ev(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,t5);var n=e?t2:t1,i=this._parents,r=this._groups;"function"!=typeof t&&(v=t,t=function(){return v});for(var o=r.length,a=Array(o),s=Array(o),l=Array(o),u=0;u<o;++u){var h=i[u],c=r[u],d=c.length,f="object"==typeof(y=t.call(h,h&&h.__data__,u,i))&&"length"in y?y:Array.from(y),p=f.length,g=s[u]=Array(p),m=a[u]=Array(p);n(h,c,g,m,l[u]=Array(d),f,e);for(var y,v,_,x,b=0,w=0;b<p;++b)if(_=g[b]){for(b>=w&&(w=b+1);!(x=m[w])&&++w<p;);_._next=x||null}}return(a=new ev(a,i))._enter=s,a._exit=l,a},enter:function(){return new ev(this._enter||this._groups.map(tZ),this._parents)},exit:function(){return new ev(this._exit||this._groups.map(tZ),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,o=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,o=i.length,a=Math.min(r,o),s=Array(r),l=0;l<a;++l)for(var u,h=n[l],c=i[l],d=h.length,f=s[l]=Array(d),p=0;p<d;++p)(u=h[p]||c[p])&&(f[p]=u);for(;l<r;++l)s[l]=n[l];return new ev(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,a=r[o];--o>=0;)(i=r[o])&&(a&&4^i.compareDocumentPosition(a)&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=t3);for(var n=this._groups,i=n.length,r=Array(i),o=0;o<i;++o){for(var a,s=n[o],l=s.length,u=r[o]=Array(l),h=0;h<l;++h)(a=s[h])&&(u[h]=a);u.sort(e)}return new ev(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},size:function(){let t=0;for(let e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],a=0,s=o.length;a<s;++a)(r=o[a])&&t.call(r,r.__data__,a,o);return this},attr:function(t,e){var n=t4(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}:function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):t7(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=et(t+"");if(arguments.length<2){for(var i=ee(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?ei:er)(this,t)}}:e?function(t){return function(){ei(this,t)}}:function(t){return function(){er(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?eo:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?ea:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(es)},lower:function(){return this.each(el)},append:function(t){var e="function"==typeof t?t:eu(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:eu(t),i=null==e?eh:"function"==typeof e?e:tU(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(ec)},clone:function(t){return this.select(t?ef:ed)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,o=(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}),a=o.length;if(arguments.length<2){var s=this.node().__on;if(s){for(var l,u=0,h=s.length;u<h;++u)for(i=0,l=s[u];i<a;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value}return}for(i=0,s=e?eg:ep;i<a;++i)this.each(s(o[i],e,n));return this},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return em(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return em(this,t,e)}})(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],o=0,a=r.length;o<a;++o)(i=r[o])&&(yield i)}};const eb={capture:!0,passive:!1};function ew(t){t.preventDefault(),t.stopImmediatePropagation()}var eS=(a("bYoiY"),a("bYoiY"));function ek(t,e,n,i,r){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*i+a*r)/6}var eE=t=>()=>t;function eC(t,e){var n=e-t;return n?function(e){return t+e*n}:eE(isNaN(t)?e:t)}var eL=function t(e){var n,i=1==(n=+e)?eC:function(t,e){var i,r,o;return e-t?(i=t,r=e,i=Math.pow(i,o=n),r=Math.pow(r,o)-i,o=1/o,function(t){return Math.pow(i+t*r,o)}):eE(isNaN(t)?e:t)};function r(t,e){var n=i((t=(0,eS.rgb)(t)).r,(e=(0,eS.rgb)(e)).r),r=i(t.g,e.g),o=i(t.b,e.b),a=eC(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=r(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function e$(t){return function(e){var n,i,r=e.length,o=Array(r),a=Array(r),s=Array(r);for(n=0;n<r;++n)i=(0,eS.rgb)(e[n]),o[n]=i.r||0,a[n]=i.g||0,s[n]=i.b||0;return o=t(o),a=t(a),s=t(s),i.opacity=1,function(t){return i.r=o(t),i.g=a(t),i.b=s(t),i+""}}}function eO(t,e){return t*=1,e*=1,function(n){return t*(1-n)+e*n}}e$(function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],o=t[i+1],a=i>0?t[i-1]:2*r-o,s=i<e-1?t[i+2]:2*o-r;return ek((n-i/e)*e,a,r,o,s)}}),e$(function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],o=t[i%e],a=t[(i+1)%e],s=t[(i+2)%e];return ek((n-i/e)*e,r,o,a,s)}});var eR=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,eN=RegExp(eR.source,"g");function eI(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}var eT,eA,ez,eM,eP,eD=0,eF=0,ej=0,eB=0,eV=0,eH=0,eU="object"==typeof performance&&performance.now?performance:Date,eq="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function eK(){return eV||(eq(eG),eV=eU.now()+eH)}function eG(){eV=0}function eW(){this._call=this._time=this._next=null}function eY(t,e,n){var i=new eW;return i.restart(t,e,n),i}function eJ(){eV=(eB=eU.now())+eH,eD=eF=0;try{eK(),++eD;for(var t,e=eM;e;)(t=eV-e._time)>=0&&e._call.call(void 0,t),e=e._next;--eD}finally{eD=0,function(){for(var t,e,n=eM,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:eM=e);eP=t,eQ(i)}(),eV=0}}function eX(){var t=eU.now(),e=t-eB;e>1e3&&(eH-=e,eB=t)}function eQ(t){!eD&&(eF&&(eF=clearTimeout(eF)),t-eV>24?(t<1/0&&(eF=setTimeout(eJ,t-eU.now()-eH)),ej&&(ej=clearInterval(ej))):(ej||(eB=eU.now(),ej=setInterval(eX,1e3)),eD=1,eq(eJ)))}function eZ(t,e,n){var i=new eW;return e=null==e?0:+e,i.restart(n=>{i.stop(),t(n+e)},e,n),i}eW.prototype=eY.prototype={constructor:eW,restart:function(t,e,n){if("function"!=typeof t)throw TypeError("callback is not a function");n=(null==n?eK():+n)+(null==e?0:+e),this._next||eP===this||(eP?eP._next=this:eM=this,eP=this),this._call=t,this._time=n,eQ()},stop:function(){this._call&&(this._call=null,this._time=1/0,eQ())}};var e0=tj("start","end","cancel","interrupt"),e1=[];function e2(t,e,n,i,r,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function o(l){var u,h,c,d;if(1!==n.state)return s();for(u in r)if((d=r[u]).name===n.name){if(3===d.state)return eZ(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[u]):+u<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[u])}if(eZ(function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(u=0,n.state=3,i=Array(c=n.tween.length),h=-1;u<c;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=d);i.length=h+1}}function a(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=i.length;++o<a;)i[o].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=eY(function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)},0,n.time)}(t,n,{name:e,index:i,group:r,on:e0,tween:e1,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function e5(t,e){var n=e8(t,e);if(n.state>0)throw Error("too late; already scheduled");return n}function e3(t,e){var n=e8(t,e);if(n.state>3)throw Error("too late; already running");return n}function e8(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw Error("transition not found");return n}function e9(t,e){var n,i,r,o=t.__transition,a=!0;if(o){for(r in e=null==e?null:e+"",o){if((n=o[r]).name!==e){a=!1;continue}i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[r]}a&&delete t.__transition}}var e4=180/Math.PI,e6={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function e7(t,e,n,i,r,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,l/=s),t*i<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*e4,skewX:Math.atan(l)*e4,scaleX:a,scaleY:s}}function nt(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(o,a){var s,l,u,h,c=[],d=[];return o=t(o),a=t(a),!function(t,i,r,o,a,s){if(t!==r||i!==o){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:eO(t,r)},{i:l-2,x:eO(i,o)})}else(r||o)&&a.push("translate("+r+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,c,d),s=o.rotate,s!==(l=a.rotate)?(s-l>180?l+=360:l-s>180&&(s+=360),d.push({i:c.push(r(c)+"rotate(",null,i)-2,x:eO(s,l)})):l&&c.push(r(c)+"rotate("+l+i),u=o.skewX,u!==(h=a.skewX)?d.push({i:c.push(r(c)+"skewX(",null,i)-2,x:eO(u,h)}):h&&c.push(r(c)+"skewX("+h+i),!function(t,e,n,i,o,a){if(t!==n||e!==i){var s=o.push(r(o)+"scale(",null,",",null,")");a.push({i:s-4,x:eO(t,n)},{i:s-2,x:eO(e,i)})}else(1!==n||1!==i)&&o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,c,d),o=a=null,function(t){for(var e,n=-1,i=d.length;++n<i;)c[(e=d[n]).i]=e.x(t);return c.join("")}}}var ne=nt(function(t){let e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?e6:e7(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),nn=nt(function(t){return null==t?e6:(n||(n=document.createElementNS("http://www.w3.org/2000/svg","g")),n.setAttribute("transform",t),t=n.transform.baseVal.consolidate())?e7((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):e6},", ",")",")");function ni(t,e,n){var i=t._id;return t.each(function(){var t=e3(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return e8(t,i).value[e]}}var eS=a("bYoiY");function nr(t,e){var n;return("number"==typeof e?eO:e instanceof(0,eS.default)?eL:(n=(0,eS.default)(e))?(e=n,eL):function(t,e){var n,i,r,o,a,s=eR.lastIndex=eN.lastIndex=0,l=-1,u=[],h=[];for(t+="",e+="";(r=eR.exec(t))&&(o=eN.exec(e));)(a=o.index)>s&&(a=e.slice(s,a),u[l]?u[l]+=a:u[++l]=a),(r=r[0])===(o=o[0])?u[l]?u[l]+=o:u[++l]=o:(u[++l]=null,h.push({i:l,x:eO(r,o)})),s=eN.lastIndex;return s<e.length&&(a=e.slice(s),u[l]?u[l]+=a:u[++l]=a),u.length<2?h[0]?(n=h[0].x,function(t){return n(t)+""}):(i=e,function(){return i}):(e=h.length,function(t){for(var n,i=0;i<e;++i)u[(n=h[i]).i]=n.x(t);return u.join("")})})(t,e)}var no=e_.prototype.constructor;function na(t){return function(){this.style.removeProperty(t)}}var ns=0;function nl(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}var nu=e_.prototype;nl.prototype=(function(t){return e_().transition(t)}).prototype={constructor:nl,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=tU(t));for(var i=this._groups,r=i.length,o=Array(r),a=0;a<r;++a)for(var s,l,u=i[a],h=u.length,c=o[a]=Array(h),d=0;d<h;++d)(s=u[d])&&(l=t.call(s,s.__data__,d,u))&&("__data__"in s&&(l.__data__=s.__data__),c[d]=l,e2(c[d],e,n,d,c,e8(s,n)));return new nl(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=tK(t));for(var i=this._groups,r=i.length,o=[],a=[],s=0;s<r;++s)for(var l,u=i[s],h=u.length,c=0;c<h;++c)if(l=u[c]){for(var d,f=t.call(l,l.__data__,c,u),p=e8(l,n),g=0,m=f.length;g<m;++g)(d=f[g])&&e2(d,e,n,g,f,p);o.push(f),a.push(l)}return new nl(o,a,e,n)},selectChild:nu.selectChild,selectChildren:nu.selectChildren,filter:function(t){"function"!=typeof t&&(t=tG(t));for(var e=this._groups,n=e.length,i=Array(n),r=0;r<n;++r)for(var o,a=e[r],s=a.length,l=i[r]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&l.push(o);return new nl(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw Error();for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),a=Array(i),s=0;s<o;++s)for(var l,u=e[s],h=n[s],c=u.length,d=a[s]=Array(c),f=0;f<c;++f)(l=u[f]||h[f])&&(d[f]=l);for(;s<i;++s)a[s]=e[s];return new nl(a,this._parents,this._name,this._id)},selection:function(){return new no(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=++ns,i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var h=e8(a,e);e2(a,t,n,u,s,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new nl(i,this._parents,t,n)},call:nu.call,nodes:nu.nodes,node:nu.node,size:nu.size,empty:nu.empty,each:nu.each,on:function(t,e){var n,i,r,o,a,s,l=this._id;return arguments.length<2?e8(this.node(),l).on.on(t):this.each((n=l,i=t,r=e,s=(i+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})?e5:e3,function(){var t=s(this,n),e=t.on;e!==o&&(a=(o=e).copy()).on(i,r),t.on=a}))},attr:function(t,e){var n=t4(t),i="transform"===n?nn:nr;return this.attrTween(t,"function"==typeof e?(n.local?function(t,e,n){var i,r,o;return function(){var a,s,l=n(this);return null==l?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===i&&s===r?o:(r=s,o=e(i=a,l))}}:function(t,e,n){var i,r,o;return function(){var a,s,l=n(this);return null==l?void this.removeAttribute(t):(a=this.getAttribute(t))===(s=l+"")?null:a===i&&s===r?o:(r=s,o=e(i=a,l))}})(n,i,ni(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(t,e,n){var i,r,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===i?r:r=e(i=a,n)}}:function(t,e,n){var i,r,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===i?r:r=e(i=a,n)}})(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw Error();var i=t4(t);return this.tween(n,(i.local?function(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(e){this.setAttributeNS(t.space,t.local,r.call(this,e))}),n}return r._value=e,r}:function(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(e){this.setAttribute(t,r.call(this,e))}),n}return r._value=e,r})(i,e))},style:function(t,e,n){var i,r,o,a,s,l,u,h,c,d,f,p,g,m,y,v,_,x,b,w,S,k="transform"==(t+="")?ne:nr;return null==e?this.styleTween(t,(i=t,function(){var t=t7(this,i),e=(this.style.removeProperty(i),t7(this,i));return t===e?null:t===r&&e===o?a:a=k(r=t,o=e)})).on("end.style."+t,na(t)):"function"==typeof e?this.styleTween(t,(s=t,l=ni(this,"style."+t,e),function(){var t=t7(this,s),e=l(this),n=e+"";return null==e&&(this.style.removeProperty(s),n=e=t7(this,s)),t===n?null:t===u&&n===h?c:(h=n,c=k(u=t,e))})).each((d=this._id,_="end."+(v="style."+(f=t)),function(){var t=e3(this,d),e=t.on,n=null==t.value[v]?y||(y=na(f)):void 0;(e!==p||m!==n)&&(g=(p=e).copy()).on(_,m=n),t.on=g})):this.styleTween(t,(x=t,S=e+"",function(){var t=t7(this,x);return t===S?null:t===b?w:w=k(b=t,e)}),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw Error();return this.tween(i,function(t,e,n){var i,r;function o(){var o=e.apply(this,arguments);return o!==r&&(i=(r=o)&&function(e){this.style.setProperty(t,o.call(this,e),n)}),i}return o._value=e,o}(t,e,null==n?"":n))},text:function(t){var e,n;return this.tween("text","function"==typeof t?(e=ni(this,"text",t),function(){var t=e(this);this.textContent=null==t?"":t}):(n=null==t?"":t+"",function(){this.textContent=n}))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw Error();return this.tween(e,function(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&function(t){this.textContent=i.call(this,t)}),e}return i._value=t,i}(t))},remove:function(){var t;return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=e8(this.node(),n).tween,o=0,a=r.length;o<a;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==e?function(t,e){var n,i;return function(){var r=e3(this,t),o=r.tween;if(o!==n){i=n=o;for(var a=0,s=i.length;a<s;++a)if(i[a].name===e){(i=i.slice()).splice(a,1);break}}r.tween=i}}:function(t,e,n){var i,r;if("function"!=typeof n)throw Error();return function(){var o=e3(this,t),a=o.tween;if(a!==i){r=(i=a).slice();for(var s={name:e,value:n},l=0,u=r.length;l<u;++l)if(r[l].name===e){r[l]=s;break}l===u&&r.push(s)}o.tween=r}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){e5(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e*=1,function(){e5(this,t).delay=e}})(e,t)):e8(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){e3(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e*=1,function(){e3(this,t).duration=e}})(e,t)):e8(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw Error();return function(){e3(this,t).ease=e}}(e,t)):e8(this.node(),e).ease},easeVarying:function(t){var e;if("function"!=typeof t)throw Error();return this.each((e=this._id,function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw Error();e3(this,e).ease=n}))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(o,a){var s={value:a},l={value:function(){0==--r&&o()}};n.each(function(){var n=e3(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e}),0===r&&o()})},[Symbol.iterator]:nu[Symbol.iterator]};var nh={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};e_.prototype.interrupt=function(t){return this.each(function(){e9(this,t)})},e_.prototype.transition=function(t){var e,n;t instanceof nl?(e=t._id,t=t._name):(e=++ns,(n=nh).time=eK(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],l=s.length,u=0;u<l;++u)(a=s[u])&&e2(a,t,e,u,s,n||function(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw Error(`transition ${e} not found`);return n}(a,e));return new nl(i,this._parents,t,e)};const{abs:nc,max:nd,min:nf}=Math;function np(t){return{type:t}}function ng(t){var e=0,n=t.children,i=n&&n.length;if(i)for(;--i>=0;)e+=n[i].value;else e=1;t.value=e}function nm(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=nv)):void 0===e&&(e=ny);for(var n,i,r,o,a,s=new nb(t),l=[s];n=l.pop();)if((r=e(n.data))&&(a=(r=Array.from(r)).length))for(n.children=r,o=a-1;o>=0;--o)l.push(i=r[o]=new nb(r[o])),i.parent=n,i.depth=n.depth+1;return s.eachBefore(nx)}function ny(t){return t.children}function nv(t){return Array.isArray(t)?t[1]:null}function n_(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function nx(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function nb(t){this.data=t,this.depth=this.height=0,this.parent=null}function nw(t,e){return t.parent===e.parent?1:2}function nS(t){var e=t.children;return e?e[0]:t.t}function nk(t){var e=t.children;return e?e[e.length-1]:t.t}function nE(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function nC(){var t=nw,e=1,n=1,i=null;function r(r){var l=function(t){for(var e,n,i,r,o,a=new nE(t,0),s=[a];e=s.pop();)if(i=e._.children)for(e.children=Array(o=i.length),r=o-1;r>=0;--r)s.push(n=e.children[r]=new nE(i[r],r)),n.parent=e;return(a.parent=new nE(null,0)).children=[a],a}(r);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(a),i)r.eachBefore(s);else{var u=r,h=r,c=r;r.eachBefore(function(t){t.x<u.x&&(u=t),t.x>h.x&&(h=t),t.depth>c.depth&&(c=t)});var d=u===h?1:t(u,h)/2,f=d-u.x,p=e/(h.x+d+f),g=n/(c.depth||1);r.eachBefore(function(t){t.x=(t.x+f)*p,t.y=t.depth*g})}return r}function o(e){var n=e.children,i=e.parent.children,r=e.i?i[e.i-1]:null;if(n){!function(t){for(var e,n=0,i=0,r=t.children,o=r.length;--o>=0;)e=r[o],e.z+=n,e.m+=n,n+=e.s+(i+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;r?(e.z=r.z+t(e._,r._),e.m=e.z-o):e.z=o}else r&&(e.z=r.z+t(e._,r._));e.parent.A=function(e,n,i){if(n){for(var r,o,a,s=e,l=e,u=n,h=s.parent.children[0],c=s.m,d=l.m,f=u.m,p=h.m;u=nk(u),s=nS(s),u&&s;)h=nS(h),(l=nk(l)).a=e,(a=u.z+f-s.z-c+t(u._,s._))>0&&(!function(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}((r=u,o=i,r.a.parent===e.parent?r.a:o),e,a),c+=a,d+=a),f+=u.m,c+=s.m,p+=h.m,d+=l.m;u&&!nk(l)&&(l.t=u,l.m+=f-d),s&&!nS(h)&&(h.t=s,h.m+=c-p,i=e)}return i}(e,r,e.parent.A||i[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return r.separation=function(e){return arguments.length?(t=e,r):t},r.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],r):i?null:[e,n]},r.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],r):i?[e,n]:null},r}["w","e"].map(np),["n","s"].map(np),["n","w","e","s","nw","ne","sw","se"].map(np),nb.prototype=nm.prototype={constructor:nb,count:function(){return this.eachAfter(ng)},each:function(t,e){let n=-1;for(let i of this)t.call(e,i,++n,this);return this},eachAfter:function(t,e){for(var n,i,r,o=this,a=[o],s=[],l=-1;o=a.pop();)if(s.push(o),n=o.children)for(i=0,r=n.length;i<r;++i)a.push(n[i]);for(;o=s.pop();)t.call(e,o,++l,this);return this},eachBefore:function(t,e){for(var n,i,r=this,o=[r],a=-1;r=o.pop();)if(t.call(e,r,++a,this),n=r.children)for(i=n.length-1;i>=0;--i)o.push(n[i]);return this},find:function(t,e){let n=-1;for(let i of this)if(t.call(e,i,++n,this))return i},sum:function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}(e,t),i=[e];e!==n;)i.push(e=e.parent);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e},copy:function(){return nm(this).eachBefore(n_)},[Symbol.iterator]:function*(){var t,e,n,i,r=this,o=[r];do for(t=o.reverse(),o=[];r=t.pop();)if(yield r,e=r.children)for(n=0,i=e.length;n<i;++n)o.push(e[n]);while(o.length)}},nE.prototype=Object.create(nb.prototype);class nL extends Map{constructor(t,e=nO){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(let[e,n]of t)this.set(e,n)}get(t){return super.get(n$(this,t))}has(t){return super.has(n$(this,t))}set(t,e){return super.set(function({_intern:t,_key:e},n){let i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}(this,t),e)}delete(t){return super.delete(function({_intern:t,_key:e},n){let i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}(this,t))}}function n$({_intern:t,_key:e},n){let i=e(n);return t.has(i)?t.get(i):n}function nO(t){return null!==t&&"object"==typeof t?t.valueOf():t}function nR(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}const nN=Symbol("implicit");var nI=function(t){for(var e=t.length/6|0,n=Array(e),i=0;i<e;)n[i]="#"+t.slice(6*i,6*++i);return n}("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function nT(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function nA(t){this._context=t}function nz(t){return new nA(t)}function nM(t,e){this._context=t,this._t=e}function nP(t){return new nM(t,1)}nA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:nT(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t*=1,e*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:nT(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},nM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t*=1,e*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var nD=Array.prototype.slice;function nF(t){return function(){return t}}function nj(t){this._context=t}function nB(t){return new nj(t)}nj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t*=1,e*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const nV=Math.PI,nH=2*nV,nU=nH-1e-6;function nq(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class nK{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?nq:function(t){let e=Math.floor(t);if(!(e>=0))throw Error(`invalid digits: ${t}`);if(e>15)return nq;let n=10**e;return function(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,i){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,e,n,i,r,o){this._append`C${+t},${+e},${+n},${+i},${this._x1=+r},${this._y1=+o}`}arcTo(t,e,n,i,r){if(t*=1,e*=1,n*=1,i*=1,(r*=1)<0)throw Error(`negative radius: ${r}`);let o=this._x1,a=this._y1,s=n-t,l=i-e,u=o-t,h=a-e,c=u*u+h*h;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(c>1e-6)if(Math.abs(h*s-l*u)>1e-6&&r){let d=n-o,f=i-a,p=s*s+l*l,g=Math.sqrt(p),m=Math.sqrt(c),y=r*Math.tan((nV-Math.acos((p+c-(d*d+f*f))/(2*g*m)))/2),v=y/m,_=y/g;Math.abs(v-1)>1e-6&&this._append`L${t+v*u},${e+v*h}`,this._append`A${r},${r},0,0,${+(h*d>u*f)},${this._x1=t+_*s},${this._y1=e+_*l}`}else this._append`L${this._x1=t},${this._y1=e}`}arc(t,e,n,i,r,o){if(t*=1,e*=1,n*=1,o=!!o,n<0)throw Error(`negative radius: ${n}`);let a=n*Math.cos(i),s=n*Math.sin(i),l=t+a,u=e+s,h=1^o,c=o?i-r:r-i;null===this._x1?this._append`M${l},${u}`:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-u)>1e-6)&&this._append`L${l},${u}`,n&&(c<0&&(c=c%nH+nH),c>nU?this._append`A${n},${n},0,1,${h},${t-a},${e-s}A${n},${n},0,1,${h},${this._x1=l},${this._y1=u}`:c>1e-6&&this._append`A${n},${n},0,${+(c>=nV)},${h},${this._x1=t+n*Math.cos(r)},${this._y1=e+n*Math.sin(r)}`)}rect(t,e,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n*=1}v${+i}h${-n}Z`}toString(){return this._}}function nG(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{let t=Math.floor(n);if(!(t>=0))throw RangeError(`invalid digits: ${n}`);e=t}return t},()=>new nK(e)}function nW(t){return t[0]}function nY(t){return t[1]}function nJ(t,e){var n=nF(!0),i=null,r=nB,o=null,a=nG(s);function s(s){var l,u,h,c,d=(s="object"==typeof(l=s)&&"length"in l?l:Array.from(l)).length,f=!1;for(null==i&&(o=r(c=a())),u=0;u<=d;++u)!(u<d&&n(h=s[u],u,s))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(h,u,s),+e(h,u,s));if(c)return o=null,c+""||null}return t="function"==typeof t?t:void 0===t?nW:nF(t),e="function"==typeof e?e:void 0===e?nY:nF(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:nF(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:nF(+t),s):e},s.defined=function(t){return arguments.length?(n="function"==typeof t?t:nF(!!t),s):n},s.curve=function(t){return arguments.length?(r=t,null!=i&&(o=r(i)),s):r},s.context=function(t){return arguments.length?(null==t?i=o=null:o=r(i=t),s):i},s}nK.prototype;class nX{constructor(t,e){this._context=t,this._x=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(t,e){switch(t*=1,e*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,e,t,e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+e)/2,t,this._y0,t,e)}this._x0=t,this._y0=e}}function nQ(t){return new nX(t,!1)}function nZ(t){return t.source}function n0(t){return t.target}function n1(){return function(t){let e=nZ,n=n0,i=nW,r=nY,o=null,a=null,s=nG(l);function l(){let l,u=nD.call(arguments),h=e.apply(this,u),c=n.apply(this,u);if(null==o&&(a=t(l=s())),a.lineStart(),u[0]=h,a.point(+i.apply(this,u),+r.apply(this,u)),u[0]=c,a.point(+i.apply(this,u),+r.apply(this,u)),a.lineEnd(),l)return a=null,l+""||null}return l.source=function(t){return arguments.length?(e=t,l):e},l.target=function(t){return arguments.length?(n=t,l):n},l.x=function(t){return arguments.length?(i="function"==typeof t?t:nF(+t),l):i},l.y=function(t){return arguments.length?(r="function"==typeof t?t:nF(+t),l):r},l.context=function(e){return arguments.length?(null==e?o=a=null:a=t(o=e),l):o},l}(nQ)}function n2(t){return((t=Math.exp(t))+1/t)/2}var n5=function t(e,n,i){function r(t,r){var o,a,s=t[0],l=t[1],u=t[2],h=r[0],c=r[1],d=r[2],f=h-s,p=c-l,g=f*f+p*p;if(g<1e-12)a=Math.log(d/u)/e,o=function(t){return[s+t*f,l+t*p,u*Math.exp(e*t*a)]};else{var m=Math.sqrt(g),y=(d*d-u*u+i*g)/(2*u*n*m),v=(d*d-u*u-i*g)/(2*d*n*m),_=Math.log(Math.sqrt(y*y+1)-y);a=(Math.log(Math.sqrt(v*v+1)-v)-_)/e,o=function(t){var i,r,o=t*a,h=n2(_),c=u/(n*m)*(h*(((i=Math.exp(2*(i=e*o+_)))-1)/(i+1))-((r=Math.exp(r=_))-1/r)/2);return[s+c*f,l+c*p,u*h/n2(e*o+_)]}}return o.duration=1e3*a*e/Math.SQRT2,o}return r.rho=function(e){var n=Math.max(.001,+e),i=n*n;return t(n,i,i*i)},r}(Math.SQRT2,2,4),n3=t=>()=>t;function n8(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function n9(t,e,n){this.k=t,this.x=e,this.y=n}n9.prototype={constructor:n9,scale:function(t){return 1===t?this:new n9(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new n9(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var n4=new n9(1,0,0);function n6(t){t.stopImmediatePropagation()}function n7(t){t.preventDefault(),t.stopImmediatePropagation()}function it(t){return(!t.ctrlKey||"wheel"===t.type)&&!t.button}function ie(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function ii(){return this.__zoom||n4}function ir(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function io(){return navigator.maxTouchPoints||"ontouchstart"in this}function ia(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function is(){var t,e,n,i=it,r=ie,o=ia,a=ir,s=io,l=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],h=250,c=n5,d=tj("start","zoom","end"),f=0,p=10;function g(t){t.property("__zoom",ii).on("wheel.zoom",w,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",k).filter(s).on("touchstart.zoom",E).on("touchmove.zoom",C).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(t,e){return(e=Math.max(l[0],Math.min(l[1],e)))===t.k?t:new n9(e,t.x,t.y)}function y(t,e,n){var i=e[0]-n[0]*t.k,r=e[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new n9(t.k,i,r)}function v(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function _(t,e,n,i){t.on("start.zoom",function(){x(this,arguments).event(i).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).event(i).end()}).tween("zoom",function(){var t=arguments,o=x(this,t).event(i),a=r.apply(this,t),s=null==n?v(a):"function"==typeof n?n.apply(this,t):n,l=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=this.__zoom,h="function"==typeof e?e.apply(this,t):e,d=c(u.invert(s).concat(l/u.k),h.invert(s).concat(l/h.k));return function(t){if(1===t)t=h;else{var e=d(t),n=l/e[2];t=new n9(n,s[0]-e[0]*n,s[1]-e[1]*n)}o.zoom(null,t)}})}function x(t,e,n){return!n&&t.__zooming||new b(t,e)}function b(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=r.apply(t,e),this.taps=0}function w(t,...e){if(i.apply(this,arguments)){var n=x(this,e).event(t),r=this.__zoom,s=Math.max(l[0],Math.min(l[1],r.k*Math.pow(2,a.apply(this,arguments)))),h=eI(t);if(n.wheel)(n.mouse[0][0]!==h[0]||n.mouse[0][1]!==h[1])&&(n.mouse[1]=r.invert(n.mouse[0]=h)),clearTimeout(n.wheel);else{if(r.k===s)return;n.mouse=[h,r.invert(h)],e9(this),n.start()}n7(t),n.wheel=setTimeout(function(){n.wheel=null,n.end()},150),n.zoom("mouse",o(y(m(r,s),n.mouse[0],n.mouse[1]),n.extent,u))}}function S(t,...e){if(!n&&i.apply(this,arguments)){var r,a,s,l=t.currentTarget,h=x(this,e,!0).event(t),c=ex(t.view).on("mousemove.zoom",function(t){if(n7(t),!h.moved){var e=t.clientX-p,n=t.clientY-g;h.moved=e*e+n*n>f}h.event(t).zoom("mouse",o(y(h.that.__zoom,h.mouse[0]=eI(t,l),h.mouse[1]),h.extent,u))},!0).on("mouseup.zoom",function(t){var e,n,i,r;c.on("mousemove.zoom mouseup.zoom",null),e=t.view,n=h.moved,i=e.document.documentElement,r=ex(e).on("dragstart.drag",null),n&&(r.on("click.drag",ew,eb),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in i?r.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect),n7(t),h.event(t).end()},!0),d=eI(t,l),p=t.clientX,g=t.clientY;a=(r=t.view).document.documentElement,s=ex(r).on("dragstart.drag",ew,eb),"onselectstart"in a?s.on("selectstart.drag",ew,eb):(a.__noselect=a.style.MozUserSelect,a.style.MozUserSelect="none"),n6(t),h.mouse=[d,this.__zoom.invert(d)],e9(this),h.start()}}function k(t,...e){if(i.apply(this,arguments)){var n=this.__zoom,a=eI(t.changedTouches?t.changedTouches[0]:t,this),s=n.invert(a),l=n.k*(t.shiftKey?.5:2),c=o(y(m(n,l),a,s),r.apply(this,e),u);n7(t),h>0?ex(this).transition().duration(h).call(_,c,a,t):ex(this).call(g.transform,c,a,t)}}function E(n,...r){if(i.apply(this,arguments)){var o,a,s,l,u=n.touches,h=u.length,c=x(this,r,n.changedTouches.length===h).event(n);for(n6(n),a=0;a<h;++a)l=[l=eI(s=u[a],this),this.__zoom.invert(l),s.identifier],c.touch0?c.touch1||c.touch0[2]===l[2]||(c.touch1=l,c.taps=0):(c.touch0=l,o=!0,c.taps=1+!!t);t&&(t=clearTimeout(t)),o&&(c.taps<2&&(e=l[0],t=setTimeout(function(){t=null},500)),e9(this),c.start())}}function C(t,...e){if(this.__zooming){var n,i,r,a,s=x(this,e).event(t),l=t.changedTouches,h=l.length;for(n7(t),n=0;n<h;++n)r=eI(i=l[n],this),s.touch0&&s.touch0[2]===i.identifier?s.touch0[0]=r:s.touch1&&s.touch1[2]===i.identifier&&(s.touch1[0]=r);if(i=s.that.__zoom,s.touch1){var c=s.touch0[0],d=s.touch0[1],f=s.touch1[0],p=s.touch1[1],g=(g=f[0]-c[0])*g+(g=f[1]-c[1])*g,v=(v=p[0]-d[0])*v+(v=p[1]-d[1])*v;i=m(i,Math.sqrt(g/v)),r=[(c[0]+f[0])/2,(c[1]+f[1])/2],a=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!s.touch0)return;r=s.touch0[0],a=s.touch0[1]}s.zoom("touch",o(y(i,r,a),s.extent,u))}}function L(t,...i){if(this.__zooming){var r,o,a=x(this,i).event(t),s=t.changedTouches,l=s.length;for(n6(t),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),r=0;r<l;++r)o=s[r],a.touch0&&a.touch0[2]===o.identifier?delete a.touch0:a.touch1&&a.touch1[2]===o.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps&&(o=eI(o,this),Math.hypot(e[0]-o[0],e[1]-o[1])<p)){var u=ex(this).on("dblclick.zoom");u&&u.apply(this,arguments)}}}return g.transform=function(t,e,n,i){var r=t.selection?t.selection():t;r.property("__zoom",ii),t!==r?_(t,e,n,i):r.interrupt().each(function(){x(this,arguments).event(i).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},g.scaleBy=function(t,e,n,i){g.scaleTo(t,function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n},n,i)},g.scaleTo=function(t,e,n,i){g.transform(t,function(){var t=r.apply(this,arguments),i=this.__zoom,a=null==n?v(t):"function"==typeof n?n.apply(this,arguments):n,s=i.invert(a),l="function"==typeof e?e.apply(this,arguments):e;return o(y(m(i,l),a,s),t,u)},n,i)},g.translateBy=function(t,e,n,i){g.transform(t,function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),u)},null,i)},g.translateTo=function(t,e,n,i,a){g.transform(t,function(){var t=r.apply(this,arguments),a=this.__zoom,s=null==i?v(t):"function"==typeof i?i.apply(this,arguments):i;return o(n4.translate(s[0],s[1]).scale(a.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,u)},i,a)},b.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=ex(this.that).datum();d.call(t,this.that,new n8(t,{sourceEvent:this.sourceEvent,target:g,type:t,transform:this.that.__zoom,dispatch:d}),e)}},g.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:n3(+t),g):a},g.filter=function(t){return arguments.length?(i="function"==typeof t?t:n3(!!t),g):i},g.touchable=function(t){return arguments.length?(s="function"==typeof t?t:n3(!!t),g):s},g.extent=function(t){return arguments.length?(r="function"==typeof t?t:n3([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),g):r},g.scaleExtent=function(t){return arguments.length?(l[0]=+t[0],l[1]=+t[1],g):[l[0],l[1]]},g.translateExtent=function(t){return arguments.length?(u[0][0]=+t[0][0],u[1][0]=+t[1][0],u[0][1]=+t[0][1],u[1][1]=+t[1][1],g):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},g.constrain=function(t){return arguments.length?(o=t,g):o},g.duration=function(t){return arguments.length?(h=+t,g):h},g.interpolate=function(t){return arguments.length?(c=t,g):c},g.on=function(){var t=d.on.apply(d,arguments);return t===d?g:t},g.clickDistance=function(t){return arguments.length?(f=(t*=1)*t,g):Math.sqrt(f)},g.tapDistance=function(t){return arguments.length?(p=+t,g):p},g}function il(t,e=null){console.log(`[TreeRenderer] ${t}`),e&&console.log(e)}n9.prototype;class iu{constructor(t,e,n){this.familyTree=t,this.container=e,this.config=n,this.svg=null,this.treeGroup=null,this.nodesGroup=null,this.linksGroup=null,this.treeLayout=null,this.root=null,this.nodeWidth=180*this.config.nodeSize,this.nodeHeight=100*this.config.nodeSize,this.nodeSpacing=20*this.config.nodeSpacing,this.hierarchyData=null,il(`Initialized renderer with ${t.individuals.length} individuals and ${t.generations} generations`)}render(){il("Converting to hierarchy"),this.hierarchyData=this.convertToHierarchy(),il("Creating SVG container"),this.createSvg(),il("Setting up tree layout"),this.setupTreeLayout(),il("Creating links"),this.createLinks(),il("Creating nodes"),this.createNodes(),il("Setting up zoom behavior"),this.setupZoom()}convertToHierarchy(){let t=Array(this.familyTree.generations).fill().map(()=>[]);this.familyTree.individuals.forEach(e=>{t[e.generation].push(e)}),il("Individuals grouped by generation",t.map(t=>t.length));let e={id:"root",name:"Family Tree",children:[]};if(t[0].length>0){let n=t[0];il(`Processing oldest generation with ${n.length} individuals`);let i=new Set;n.forEach(t=>{if(i.has(t.id))return;let n={id:`unit-${t.id}`,name:"Family Unit",individuals:[t],children:[]};i.add(t.id),t.spouses.forEach(t=>{i.has(t.id)||(n.individuals.push(t),i.add(t.id))});let r=this.findChildren(t);il(`Individual ${t.id} has ${r.length} children`),r.forEach(t=>{this.processChild(t,n,i)}),e.children.push(n)}),il(`Created ${e.children.length} family units at root level`)}else il("No individuals in oldest generation, empty tree");return nm(e)}findChildren(t){let e=[...t.children];return t.spouses.forEach(t=>{t.children.forEach(t=>{e.includes(t)||e.push(t)})}),e}processChild(t,e,n){if(n.has(t.id))return;let i={id:`unit-${t.id}`,name:"Family Unit",individuals:[t],children:[]};n.add(t.id),t.spouses.forEach(t=>{n.has(t.id)||(i.individuals.push(t),n.add(t.id))}),this.findChildren(t).forEach(t=>{this.processChild(t,i,n)}),e.children.push(i)}createSvg(){ex(this.container).selectAll("svg").remove(),this.svg=ex(this.container).append("svg").attr("width",this.config.svgWidth).attr("height",this.config.svgHeight).attr("viewBox",`0 0 ${this.config.svgWidth} ${this.config.svgHeight}`).attr("class","family-tree-svg"),this.svg.append("defs").append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",8).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("class","arrow-head"),this.treeGroup=this.svg.append("g").attr("class","tree-group").attr("transform",`translate(${this.config.svgWidth/2}, 60)`),this.linksGroup=this.treeGroup.append("g").attr("class","links-group"),this.nodesGroup=this.treeGroup.append("g").attr("class","nodes-group")}setupTreeLayout(){"top-down"===this.config.orientation?this.treeLayout=nC().nodeSize([this.nodeWidth+this.nodeSpacing,this.nodeHeight+2*this.nodeSpacing]).separation((t,e)=>t.data.individuals&&e.data.individuals?(t.data.individuals.length+e.data.individuals.length)/2:1):"bottom-up"===this.config.orientation?(this.treeLayout=nC().nodeSize([this.nodeWidth+this.nodeSpacing,this.nodeHeight+2*this.nodeSpacing]).separation((t,e)=>t.data.individuals&&e.data.individuals?(t.data.individuals.length+e.data.individuals.length)/2:1),this.hierarchyData.descendants().forEach(t=>{t.y=-t.y})):"left-right"===this.config.orientation?(this.treeLayout=nC().nodeSize([this.nodeHeight+2*this.nodeSpacing,this.nodeWidth+this.nodeSpacing]).separation((t,e)=>t.data.individuals&&e.data.individuals?(t.data.individuals.length+e.data.individuals.length)/2:1),this.treeGroup.attr("transform",`translate(60, ${this.config.svgHeight/2})`)):"right-left"===this.config.orientation&&(this.treeLayout=nC().nodeSize([this.nodeHeight+2*this.nodeSpacing,this.nodeWidth+this.nodeSpacing]).separation((t,e)=>t.data.individuals&&e.data.individuals?(t.data.individuals.length+e.data.individuals.length)/2:1),this.treeGroup.attr("transform",`translate(${this.config.svgWidth-60}, ${this.config.svgHeight/2})`),this.hierarchyData.descendants().forEach(t=>{t.y=-t.y})),this.root=this.treeLayout(this.hierarchyData)}createLinks(){let t=this.getLinkGenerator();this.linksGroup.selectAll(".link").data(this.root.links()).enter().append("path").attr("class","link").attr("d",t),this.root.descendants().forEach(t=>{if(t.data.individuals&&t.data.individuals.length>1){let e=this.getMarriageLinkGenerator(t);this.linksGroup.append("path").attr("class","link link-marriage").attr("d",e)}})}getLinkGenerator(){this.config.orientation;let t=this.config.lineStyle;return"straight"===t?n1().x(t=>this.isHorizontalOrientation()?t.y:t.x).y(t=>this.isHorizontalOrientation()?t.x:t.y):"curved"===t?n1().x(t=>this.isHorizontalOrientation()?t.y:t.x).y(t=>this.isHorizontalOrientation()?t.x:t.y).curve(nz):n1().x(t=>this.isHorizontalOrientation()?t.y:t.x).y(t=>this.isHorizontalOrientation()?t.x:t.y).curve(nP)}getMarriageLinkGenerator(t){let e=t.data.individuals;return(this.config.orientation,this.isHorizontalOrientation())?nJ().x(e=>t.y).y((n,i)=>t.x-(e.length-1)*15/2+15*i):nJ().x((n,i)=>t.x-(e.length-1)*15/2+15*i).y(e=>t.y)}createNodes(){let t=this.getColorScale();this.nodesGroup.selectAll(".node").data(this.root.descendants().filter(t=>"root"!==t.data.id)).enter().append("g").attr("class","node").attr("transform",t=>this.isHorizontalOrientation()?`translate(${t.y},${t.x})`:`translate(${t.x},${t.y})`).each((e,n,i)=>{let r=ex(i[n]),o=e.data;if(o.individuals&&o.individuals.length>0){let e=-((o.individuals.length-1)*15)/2;o.individuals.forEach((n,i)=>{this.createIndividualNode(r,n,e+15*i,0,t)})}})}createIndividualNode(t,e,n,i,r){let o=`node-${e.gender}`,a=t.append("g").attr("class",`individual ${o}`).attr("transform",`translate(${n}, ${i})`).attr("data-id",e.id),s=this.getIndividualColor(e,r);a.append("rect").attr("x",-this.nodeWidth/2).attr("y",-this.nodeHeight/2).attr("width",this.nodeWidth).attr("height",this.nodeHeight).attr("rx",5).attr("ry",5).style("fill","gender"===this.config.colorScheme?s:"#fff").style("stroke","gender"!==this.config.colorScheme?s:null);let l="ta"===e.language?"tamil":"";if(a.append("text").attr("class",`name ${l}`).attr("y",-this.nodeHeight/2+20).attr("text-anchor","middle").style("font-size",`${this.config.fontSize}px`).style("font-weight","bold").text(e.name),e.birthDate){let t=tR("born",{lng:this.config.language}),n=tz(e.birthDate,this.config.language);a.append("text").attr("class",`birth-date ${l}`).attr("y",-this.nodeHeight/2+40).attr("text-anchor","middle").style("font-size",`${this.config.fontSize-2}px`).text(`${t} ${n}`)}if(e.deathDate){let t=tR("died",{lng:this.config.language}),n=tz(e.deathDate,this.config.language);a.append("text").attr("class",`death-date ${l}`).attr("y",-this.nodeHeight/2+60).attr("text-anchor","middle").style("font-size",`${this.config.fontSize-2}px`).text(`${t} ${n}`);let i=function(t,e=null){if(!t||"string"==typeof t)return null;let n=e||new Date,i=n.getFullYear()-t.getFullYear(),r=n.getMonth()-t.getMonth();return(r<0||0===r&&n.getDate()<t.getDate())&&i--,i}(e.birthDate,e.deathDate);if(null!==i){let t=tR("age",{lng:this.config.language});a.append("text").attr("class",`age ${l}`).attr("y",-this.nodeHeight/2+80).attr("text-anchor","middle").style("font-size",`${this.config.fontSize-2}px`).text(`${t} ${i}`)}}if(e.nativePlace){let t=e.deathDate?-this.nodeHeight/2+100:-this.nodeHeight/2+60;a.append("text").attr("class",`native-place ${l}`).attr("y",t).attr("text-anchor","middle").style("font-size",`${this.config.fontSize-2}px`).text(e.nativePlace)}}getColorScale(){let t=this.config.colorScheme;if("gender"===t)return t=>"male"===t.gender?"#add8e6":"female"===t.gender?"#ffcccb":"#d3d3d3";if("generation"!==t)return t=>"#555";{let t=this.familyTree.generations,e=(function t(){var e=new nL,n=[],i=[],r=nN;function o(t){let o=e.get(t);if(void 0===o){if(r!==nN)return r;e.set(t,o=n.push(t)-1)}return i[o%i.length]}return o.domain=function(t){if(!arguments.length)return n.slice();for(let i of(n=[],e=new nL,t))e.has(i)||e.set(i,n.push(i)-1);return o},o.range=function(t){return arguments.length?(i=Array.from(t),o):i.slice()},o.unknown=function(t){return arguments.length?(r=t,o):r},o.copy=function(){return t(n,i).unknown(r)},nR.apply(o,arguments),o})(nI).domain(function(t,e,n){t*=1,e*=1,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),o=Array(r);++i<r;)o[i]=t+i*n;return o}(t));return t=>e(t.generation)}}getIndividualColor(t,e){return e(t)}setupZoom(){let t=is().scaleExtent([.1,3]).on("zoom",t=>{this.treeGroup.attr("transform",t.transform)});this.svg.call(t),this.resetView()}resetView(){let t=this.root.descendants().filter(t=>"root"!==t.data.id);if(0===t.length)return;let e=1/0,n=-1/0,i=1/0,r=-1/0;t.forEach(t=>{let o=this.isHorizontalOrientation()?t.y:t.x,a=this.isHorizontalOrientation()?t.x:t.y;e=Math.min(e,o),n=Math.max(n,o),i=Math.min(i,a),r=Math.max(r,a)}),e-=100,n+=100,i-=100,r+=100;let o=n-e,a=r-i,s=Math.min(this.config.svgWidth/o,this.config.svgHeight/a,1),l=this.config.svgWidth/2-(e+o/2)*s,u=this.config.svgHeight/2-(i+a/2)*s,h=n4.translate(l,u).scale(s);this.svg.transition().duration(750).call(is().transform,h)}isHorizontalOrientation(){return"left-right"===this.config.orientation||"right-left"===this.config.orientation}updateLanguage(t){this.config.language=t,this.render()}exportSVG(){let t=this.svg.node().cloneNode(!0),e=document.createElement("style");e.textContent=`
            .node rect {
                fill: #fff;
                stroke: #555;
                stroke-width: 1px;
            }
            
            .node-male rect {
                stroke: #3498db;
            }
            
            .node-female rect {
                stroke: #e74c3c;
            }
            
            .node-unknown rect {
                stroke: #95a5a6;
            }
            
            .node text {
                font-family: Arial, sans-serif;
                font-size: ${this.config.fontSize}px;
            }
            
            .tamil {
                font-family: 'Noto Sans Tamil', sans-serif;
            }
            
            .link {
                fill: none;
                stroke: #95a5a6;
                stroke-width: 1.5px;
            }
            
            .link-marriage {
                stroke-dasharray: 5;
            }
        `,t.insertBefore(e,t.firstChild);let n=document.createElement("link");n.setAttribute("href","https://fonts.googleapis.com/css2?family=Noto+Sans+Tamil:wght@400;700&display=swap"),n.setAttribute("rel","stylesheet"),t.insertBefore(n,t.firstChild),t.setAttribute("width",this.config.svgWidth),t.setAttribute("height",this.config.svgHeight);let i=new Blob(['<?xml version="1.0" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">',new XMLSerializer().serializeToString(t)],{type:"image/svg+xml"}),r=document.createElement("a");r.href=URL.createObjectURL(i),r.download="family-tree.svg",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}function ih(t,e,n=t=>t){let i=document.getElementById(t),r=document.getElementById(e);r||((r=document.createElement("span")).id=e,r.className="range-value",i.parentNode.insertBefore(r,i.nextSibling)),r.textContent=n(i.value),i.addEventListener("input",()=>{r.textContent=n(i.value)}),i.addEventListener("change",ic)}function ic(){try{let t={orientation:document.getElementById("orientation").value,nodeSize:parseFloat(document.getElementById("node-size").value),nodeSpacing:parseFloat(document.getElementById("node-spacing").value),colorScheme:document.getElementById("color-scheme").value,fontSize:parseInt(document.getElementById("font-size").value),lineStyle:document.getElementById("line-style").value,svgWidth:parseInt(document.getElementById("svg-width").value),svgHeight:parseInt(document.getElementById("svg-height").value)};localStorage.setItem("familyTreeConfig",JSON.stringify(t))}catch(t){console.warn("Failed to save configuration:",t)}}const id=[{id:1,name:"Rajan Kumar",gender:"Male",spouse_name:"Priya Kumar",father_name:"Mohan Kumar",mother_name:"Lakshmi Kumar",birth_date:"1945-05-15",death_date:"2015-10-23",native_place:"Chennai",father_id:5,mother_id:6,spouse_id:2},{id:2,name:"Priya Kumar",gender:"Female",spouse_name:"Rajan Kumar",father_name:"Venkat Rao",mother_name:"Saraswati Rao",birth_date:"1948-09-30",death_date:null,native_place:"Madurai",father_id:7,mother_id:8,spouse_id:1},{id:3,name:"Arjun Kumar",gender:"Male",spouse_name:"Deepa Kumar",father_name:"Rajan Kumar",mother_name:"Priya Kumar",birth_date:"1970-03-22",death_date:null,native_place:"Chennai",father_id:1,mother_id:2,spouse_id:4},{id:4,name:"Deepa Kumar",gender:"Female",spouse_name:"Arjun Kumar",father_name:"Ramesh Sharma",mother_name:"Anita Sharma",birth_date:"1972-11-08",death_date:null,native_place:"Bangalore",father_id:9,mother_id:10,spouse_id:3},{id:5,name:"Mohan Kumar",gender:"Male",spouse_name:"Lakshmi Kumar",father_name:null,mother_name:null,birth_date:"1920-01-05",death_date:"1990-12-15",native_place:"Chennai",father_id:null,mother_id:null,spouse_id:6},{id:6,name:"Lakshmi Kumar",gender:"Female",spouse_name:"Mohan Kumar",father_name:null,mother_name:null,birth_date:"1925-04-20",death_date:"1995-08-10",native_place:"Chennai",father_id:null,mother_id:null,spouse_id:5},{id:7,name:"Venkat Rao",gender:"Male",spouse_name:"Saraswati Rao",father_name:null,mother_name:null,birth_date:"1922-07-12",death_date:"1992-03-18",native_place:"Madurai",father_id:null,mother_id:null,spouse_id:8},{id:8,name:"Saraswati Rao",gender:"Female",spouse_name:"Venkat Rao",father_name:null,mother_name:null,birth_date:"1926-11-30",death_date:"1998-05-22",native_place:"Madurai",father_id:null,mother_id:null,spouse_id:7},{id:9,name:"Ramesh Sharma",gender:"Male",spouse_name:"Anita Sharma",father_name:null,mother_name:null,birth_date:"1945-08-16",death_date:"2010-02-28",native_place:"Bangalore",father_id:null,mother_id:null,spouse_id:10},{id:10,name:"Anita Sharma",gender:"Female",spouse_name:"Ramesh Sharma",father_name:null,mother_name:null,birth_date:"1947-12-03",death_date:null,native_place:"Bangalore",father_id:null,mother_id:null,spouse_id:9},{id:11,name:"Vikram Kumar",gender:"Male",spouse_name:"Kavita Kumar",father_name:"Arjun Kumar",mother_name:"Deepa Kumar",birth_date:"1995-06-20",death_date:null,native_place:"Chennai",father_id:3,mother_id:4,spouse_id:12},{id:12,name:"Kavita Kumar",gender:"Female",spouse_name:"Vikram Kumar",father_name:"Dinesh Patel",mother_name:"Sunita Patel",birth_date:"1997-09-15",death_date:null,native_place:"Mumbai",father_id:null,mother_id:null,spouse_id:11},{id:13,name:"Meera Kumar",gender:"Female",spouse_name:null,father_name:"Arjun Kumar",mother_name:"Deepa Kumar",birth_date:"1998-04-12",death_date:null,native_place:"Chennai",father_id:3,mother_id:4,spouse_id:null},{id:14,name:"ராஜன் குமார்",gender:"ஆண்",spouse_name:"பிரியா குமார்",father_name:"மோகன் குமார்",mother_name:"லக்ஷ்மி குமார்",birth_date:"1945-05-15",death_date:"2015-10-23",native_place:"சென்னை",father_id:18,mother_id:19,spouse_id:15},{id:15,name:"பிரியா குமார்",gender:"பெண்",spouse_name:"ராஜன் குமார்",father_name:"வெங்கட் ராவ்",mother_name:"சரஸ்வதி ராவ்",birth_date:"1948-09-30",death_date:null,native_place:"மதுரை",father_id:20,mother_id:21,spouse_id:14},{id:16,name:"அர்ஜுன் குமார்",gender:"ஆண்",spouse_name:"தீபா குமார்",father_name:"ராஜன் குமார்",mother_name:"பிரியா குமார்",birth_date:"1970-03-22",death_date:null,native_place:"சென்னை",father_id:14,mother_id:15,spouse_id:17},{id:17,name:"தீபா குமார்",gender:"பெண்",spouse_name:"அர்ஜுன் குமார்",father_name:"ரமேஷ் சர்மா",mother_name:"அனிதா சர்மா",birth_date:"1972-11-08",death_date:null,native_place:"பெங்களூர்",father_id:null,mother_id:null,spouse_id:16},{id:18,name:"மோகன் குமார்",gender:"ஆண்",spouse_name:"லக்ஷ்மி குமார்",father_name:null,mother_name:null,birth_date:"1920-01-05",death_date:"1990-12-15",native_place:"சென்னை",father_id:null,mother_id:null,spouse_id:19},{id:19,name:"லக்ஷ்மி குமார்",gender:"பெண்",spouse_name:"மோகன் குமார்",father_name:null,mother_name:null,birth_date:"1925-04-20",death_date:"1995-08-10",native_place:"சென்னை",father_id:null,mother_id:null,spouse_id:18},{id:20,name:"வெங்கட் ராவ்",gender:"ஆண்",spouse_name:"சரஸ்வதி ராவ்",father_name:null,mother_name:null,birth_date:"1922-07-12",death_date:"1992-03-18",native_place:"மதுரை",father_id:null,mother_id:null,spouse_id:21},{id:21,name:"சரஸ்வதி ராவ்",gender:"பெண்",spouse_name:"வெங்கட் ராவ்",father_name:null,mother_name:null,birth_date:"1926-11-30",death_date:"1998-05-22",native_place:"மதுரை",father_id:null,mother_id:null,spouse_id:20}];function ip(t,e=null){console.log(`[App] ${t}`),e&&console.log(e)}const ig=document.getElementById("csv-file"),im=document.getElementById("language-select"),iy=document.getElementById("load-sample"),iv=document.getElementById("generate-tree"),i_=document.getElementById("export-svg"),ix=document.getElementById("reset-view"),ib=document.getElementById("visualization-container");let iw=null,iS=null,ik=null,iE="en";async function iC(){ip("Initializing application"),function(){ip("Validating DOM elements");let t=[];if([{id:"csv-file",name:"CSV File Input"},{id:"language-select",name:"Language Selector"},{id:"load-sample",name:"Load Sample Button"},{id:"generate-tree",name:"Generate Tree Button"},{id:"export-svg",name:"Export SVG Button"},{id:"reset-view",name:"Reset View Button"},{id:"visualization-container",name:"Visualization Container"}].forEach(e=>{document.getElementById(e.id)||(t.push(e.name),ip(`Missing DOM element: ${e.id}`))}),t.length>0){let e=`Some required DOM elements were not found: ${t.join(", ")}`;ip(e),console.error(e);try{iT(`Application initialization error: Missing DOM elements - ${t.join(", ")}`,"error")}catch(n){let t=document.createElement("div");t.style.backgroundColor="#ffebee",t.style.color="#c62828",t.style.padding="15px",t.style.margin="15px",t.style.border="1px solid #ef9a9a",t.style.borderRadius="4px",t.textContent=e,(document.querySelector(".container")||document.body).prepend(t)}return}ip("All required DOM elements found")}(),await tO(),ih("node-size","node-size-value",t=>`${t}x`),ih("node-spacing","node-spacing-value",t=>`${t}x`),ih("font-size","font-size-value",t=>`${t}px`),document.getElementById("svg-width").addEventListener("change",ic),document.getElementById("svg-height").addEventListener("change",ic),document.getElementById("orientation").addEventListener("change",ic),document.getElementById("color-scheme").addEventListener("change",ic),document.getElementById("line-style").addEventListener("change",ic),function(){try{let e=localStorage.getItem("familyTreeConfig");if(e){var t;(t=JSON.parse(e)).orientation&&(document.getElementById("orientation").value=t.orientation),t.nodeSize&&(document.getElementById("node-size").value=t.nodeSize),t.nodeSpacing&&(document.getElementById("node-spacing").value=t.nodeSpacing),t.colorScheme&&(document.getElementById("color-scheme").value=t.colorScheme),t.fontSize&&(document.getElementById("font-size").value=t.fontSize),t.lineStyle&&(document.getElementById("line-style").value=t.lineStyle),t.svgWidth&&(document.getElementById("svg-width").value=t.svgWidth),t.svgHeight&&(document.getElementById("svg-height").value=t.svgHeight),document.getElementById("node-size-value").textContent=`${t.nodeSize}x`,document.getElementById("node-spacing-value").textContent=`${t.nodeSpacing}x`,document.getElementById("font-size-value").textContent=`${t.fontSize}px`}}catch(t){console.warn("Failed to load saved configuration:",t)}}(),iI(iE),ip("Setting up event listeners"),im.addEventListener("change",t=>{iI(t.target.value)}),ig.addEventListener("change",iL),iy.addEventListener("click",i$),iv.addEventListener("click",iO),i_.addEventListener("click",iR),ix.addEventListener("click",iN),ip("Application initialized successfully"),iT("Application initialized. Please load data or sample to begin.","info")}async function iL(t){ip("File upload initiated");let n=t.target.files[0];if(!n){ip("No file selected");return}ip("Processing file",{name:n.name,size:n.size,type:n.type});try{iT("Parsing CSV file...","info"),iw=await function(t){tI("Starting CSV parsing");try{let r=t instanceof File;if(tI(`Input is ${r?"a File object":"a string"}`),r){var n;return n=t,tI(`Parsing CSV file: ${n.name}`),new Promise((t,i)=>{e(tN).parse(n,{header:!0,skipEmptyLines:!0,trimHeaders:!0,transform:t=>t.trim(),complete:function(e){try{if(tI(`Papa parse complete with ${e.data.length} rows`),e.errors&&e.errors.length>0){tI("CSV parsing errors found",e.errors);let t=e.errors.filter(t=>"FieldMismatch"!==t.type);if(t.length>0){i(Error(`CSV parsing error: ${t[0].message}`));return}tI("Non-critical parsing errors found, proceeding with data")}tT(e.meta.fields);let n=tA(e.data);tI(`Successfully parsed ${n.length} rows from CSV`),t(n)}catch(t){tI("Error during CSV parsing",t),i(t)}},error:function(t){tI("Error during CSV parsing",t),i(t)}})})}var i=t;tI("Parsing CSV from string");try{let t=e(tN).parse(i,{header:!0,skipEmptyLines:!0,trimHeaders:!0,transform:t=>t.trim()});if(t.errors&&t.errors.length>0){tI("CSV parsing errors found",t.errors);let e=t.errors.filter(t=>"FieldMismatch"!==t.type);if(e.length>0)throw Error(`CSV parsing error: ${e[0].message}`)}tT(t.meta.fields);let n=tA(t.data);return tI(`Successfully parsed ${n.length} rows from CSV string`),n}catch(t){throw tI("Error parsing CSV string",t),t}return}catch(t){throw tI("Error in parseCSV",t),t}}(n),ip("CSV data parsed successfully",{records:iw.length}),iT(`Successfully loaded ${iw.length} records from CSV file.`,"success"),iO()}catch(t){ip("Error parsing CSV file",t),iT("Error parsing CSV file: "+t.message,"error")}}function i$(){ip("Loading sample data");try{iw=id,ip("Sample data loaded successfully",{records:iw.length}),iT(`Successfully loaded ${iw.length} sample records.`,"success"),iO()}catch(t){ip("Error loading sample data",t),iT("Error loading sample data: "+t.message,"error")}}function iO(){if(ip("Generate family tree requested"),!iw||0===iw.length){ip("No family data available"),iT("Please upload a CSV file or load sample data first.","error");return}try{iT("Generating family tree...","info"),ib.innerHTML="",ip("Visualization container cleared"),ib.style.display="block",ib.style.minHeight="500px",ib.style.border="1px solid #ccc";let t={orientation:document.getElementById("orientation").value,nodeSize:parseFloat(document.getElementById("node-size").value),nodeSpacing:parseFloat(document.getElementById("node-spacing").value),colorScheme:document.getElementById("color-scheme").value,fontSize:parseInt(document.getElementById("font-size").value),lineStyle:document.getElementById("line-style").value,svgWidth:parseInt(document.getElementById("svg-width").value),svgHeight:parseInt(document.getElementById("svg-height").value),language:iE};ip("Using configuration",t),ip("Building family tree");try{iS=function(t){var e,n;let i;if(tM("Starting tree construction with data:",t),!t||!Array.isArray(t)||0===t.length)throw Error("Invalid or empty data provided to buildFamilyTree");tM("Creating individuals map");let r=function(t){let e={};return t.forEach(t=>{var n;let i={id:t.id,name:t.name,gender:function(t){if(!t)return"unknown";let e=t.toString().trim().toLowerCase();return"m"===e||"male"===e||"ம"===e||"ஆண்"===e?"male":"f"===e||"female"===e||"பெ"===e||"பெண்"===e?"female":"unknown"}(t.gender),spouseName:t.spouse_name||null,fatherName:t.father_name||null,motherName:t.mother_name||null,birthDate:t.birth_date,deathDate:t.death_date,nativePlace:t.native_place||null,fatherId:t.father_id||null,motherId:t.mother_id||null,spouseId:t.spouse_id||null,parents:[],children:[],spouses:[],generation:null,language:(n=t.name)&&/[\u0B80-\u0BFF]/.test(n)?"ta":"en",hasSpouse:!!t.spouse_name||!!t.spouse_id};e[t.id]=i}),e}(t);tM("Individuals map created",Object.keys(r).length),tM("Building relationships"),e=r,Object.values(e).forEach(t=>{tP(e,t,"father"),tP(e,t,"mother"),function(t,e){let n=e.spouseId;if(n&&t[n]){let i=t[n];e.spouses.includes(i)||e.spouses.push(i),i.spouses.includes(e)||i.spouses.push(e)}}(e,t)}),Object.values(e).forEach(t=>{tD(e,t,"father"),tD(e,t,"mother"),function(t,e){if(e.spouses.length>0)return;let n=e.spouseName;if(n){let i=Object.values(t).find(t=>t.name.toLowerCase()===n.toLowerCase()&&t.gender!==e.gender);i&&(e.spouses.includes(i)||e.spouses.push(i),i.spouses.includes(e)||i.spouses.push(e))}}(e,t)}),tM("Calculating generations"),function(t){let e=Object.values(t).filter(t=>0===t.parents.length);if(0===e.length){Object.values(t).forEach(t=>{t.generation=0});return}e.forEach(t=>{t.generation=0});let n=!0,i=100;for(;n&&i>0;)n=!1,i--,Object.values(t).forEach(t=>{null!==t.generation&&(t.children.forEach(e=>{let i=t.generation+1;(null===e.generation||e.generation<i)&&(e.generation=i,n=!0)}),t.spouses.forEach(e=>{if(null===e.generation)e.generation=t.generation,n=!0;else if(e.generation!==t.generation){let i=Math.max(e.generation,t.generation);e.generation=i,t.generation=i,n=!0}}))});Object.values(t).forEach(t=>{null===t.generation&&(t.generation=0)})}(r);let o=0,a=0,s=0;Object.values(r).forEach(t=>{t.parents.length>0&&o++,t.children.length>0&&a++,t.spouses.length>0&&s++}),tM(`Relationship stats: ${o} with parents, ${a} with children, ${s} with spouses`);let l=(n=r,i=0,Object.values(n).forEach(t=>{t.generation>i&&(i=t.generation)}),i),u={individuals:Object.values(r),generations:l+1};return tM(`Tree construction complete with ${u.individuals.length} individuals and ${u.generations} generations`),u}(iw),ip("Family tree built successfully",{individuals:iS.individuals.length,generations:iS.generations})}catch(t){ip("Error building family tree",t),iT("Error building family tree: "+t.message,"error");return}ip("Rendering family tree");try{ik=function(t,e,n){if(il("Starting tree rendering"),!t||!t.individuals||0===t.individuals.length)throw Error("Invalid family tree data provided");if(!e)throw Error("No container element provided for rendering");let i={orientation:"top-down",nodeSize:1.5,nodeSpacing:1.5,colorScheme:"default",fontSize:14,lineStyle:"straight",svgWidth:2e3,svgHeight:1500,language:"en",...n};il("Rendering with config",i);let r=new iu(t,e,i);try{r.render(),il("Tree rendering complete")}catch(t){throw il("Error during tree rendering",t),t}return r}(iS,ib,t),ip("Family tree rendered successfully"),iT("Family tree generated successfully.","success"),ib.scrollIntoView({behavior:"smooth"})}catch(t){ip("Error rendering family tree",t),iT("Error rendering family tree: "+t.message,"error")}}catch(t){ip("Error generating family tree",t),iT("Error generating family tree: "+t.message,"error")}}function iR(){if(!ik){alert("Please generate a family tree first.");return}try{ik.exportSVG()}catch(t){console.error("Error exporting SVG:",t),alert("Error exporting SVG: "+t.message)}}function iN(){ik&&ik.resetView()}function iI(t){iE=t,document.documentElement.lang=t,document.getElementById("app-title").textContent=to.t("appTitle"),document.getElementById("input-title").textContent=to.t("inputTitle"),document.getElementById("config-title").textContent=to.t("configTitle"),document.getElementById("layout-title").textContent=to.t("layoutTitle"),document.getElementById("visual-title").textContent=to.t("visualTitle"),document.getElementById("export-title").textContent=to.t("exportTitle"),document.getElementById("vis-title").textContent=to.t("visTitle"),document.querySelector('label[for="language-select"]').textContent=to.t("language"),document.getElementById("file-label").textContent=to.t("fileLabel"),document.getElementById("load-sample").textContent=to.t("loadSample"),document.querySelector('label[for="orientation"]').textContent=to.t("orientation"),document.querySelector('label[for="node-size"]').textContent=to.t("nodeSize"),document.querySelector('label[for="node-spacing"]').textContent=to.t("nodeSpacing"),document.querySelector('label[for="color-scheme"]').textContent=to.t("colorScheme"),document.querySelector('label[for="font-size"]').textContent=to.t("fontSize"),document.querySelector('label[for="line-style"]').textContent=to.t("lineStyle"),document.querySelector('label[for="svg-width"]').textContent=to.t("svgWidth"),document.querySelector('label[for="svg-height"]').textContent=to.t("svgHeight");let e=document.getElementById("orientation");e.options[0].textContent=to.t("topDown"),e.options[1].textContent=to.t("bottomUp"),e.options[2].textContent=to.t("leftRight"),e.options[3].textContent=to.t("rightLeft");let n=document.getElementById("color-scheme");n.options[0].textContent=to.t("default"),n.options[1].textContent=to.t("genderBased"),n.options[2].textContent=to.t("generationBased"),n.options[3].textContent=to.t("custom");let i=document.getElementById("line-style");i.options[0].textContent=to.t("straight"),i.options[1].textContent=to.t("curved"),i.options[2].textContent=to.t("angled"),document.getElementById("generate-tree").textContent=to.t("generateTree"),document.getElementById("export-svg").textContent=to.t("exportSVG"),document.getElementById("reset-view").textContent=to.t("resetView"),document.querySelector("footer p").textContent=to.t("footerText"),document.body.classList.remove("tamil"),"ta"===t&&document.body.classList.add("tamil"),ik&&iS&&ik.updateLanguage(t)}function iT(t,e="info"){let n=document.getElementById("status-container");n||((n=document.createElement("div")).id="status-container",n.style.marginTop="10px",n.style.padding="10px",n.style.borderRadius="4px",n.style.fontWeight="bold",document.querySelector(".input-section").appendChild(n)),n.textContent=t,"error"===e?(n.style.backgroundColor="#ffebee",n.style.color="#c62828",n.style.border="1px solid #ef9a9a"):"success"===e?(n.style.backgroundColor="#e8f5e9",n.style.color="#2e7d32",n.style.border="1px solid #a5d6a7"):(n.style.backgroundColor="#e3f2fd",n.style.color="#1565c0",n.style.border="1px solid #90caf9"),n.scrollIntoView({behavior:"smooth"})}document.addEventListener("DOMContentLoaded",iC);
//# sourceMappingURL=family-tree.c8b9ecb1.js.map
