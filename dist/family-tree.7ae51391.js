function e(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n,i=globalThis,r={},o={},a=i.parcelRequirea7a4;null==a&&((a=function(e){if(e in r)return r[e].exports;if(e in o){var t=o[e];delete o[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},i.parcelRequirea7a4=a);var s=a.register;s("bYoiY",function(t,n){e(t.exports,"Color",()=>r),e(t.exports,"darker",()=>o),e(t.exports,"brighter",()=>s),e(t.exports,"default",()=>b),e(t.exports,"hslConvert",()=>I),e(t.exports,"Rgb",()=>C),e(t.exports,"rgbConvert",()=>k),e(t.exports,"rgb",()=>E),e(t.exports,"hsl",()=>z);var i=a("bfWFq");function r(){}var o=.7,s=1.4285714285714286,l="\\s*([+-]?\\d+)\\s*",u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",h="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,d=RegExp(`^rgb\\(${l},${l},${l}\\)$`),f=RegExp(`^rgb\\(${h},${h},${h}\\)$`),p=RegExp(`^rgba\\(${l},${l},${l},${u}\\)$`),g=RegExp(`^rgba\\(${h},${h},${h},${u}\\)$`),m=RegExp(`^hsl\\(${u},${h},${h}\\)$`),y=RegExp(`^hsla\\(${u},${h},${h},${u}\\)$`),v={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32};function _(){return this.rgb().formatHex()}function x(){return this.rgb().formatRgb()}function b(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=c.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?w(t):3===n?new C(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?S(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?S(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=d.exec(e))?new C(t[1],t[2],t[3],1):(t=f.exec(e))?new C(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=p.exec(e))?S(t[1],t[2],t[3],t[4]):(t=g.exec(e))?S(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=m.exec(e))?A(t[1],t[2]/100,t[3]/100,1):(t=y.exec(e))?A(t[1],t[2]/100,t[3]/100,t[4]):v.hasOwnProperty(e)?w(v[e]):"transparent"===e?new C(NaN,NaN,NaN,0):null}function w(e){return new C(e>>16&255,e>>8&255,255&e,1)}function S(e,t,n,i){return i<=0&&(e=t=n=NaN),new C(e,t,n,i)}function k(e){return(e instanceof r||(e=b(e)),e)?new C((e=e.rgb()).r,e.g,e.b,e.opacity):new C}function E(e,t,n,i){return 1==arguments.length?k(e):new C(e,t,n,null==i?1:i)}function C(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function $(){return`#${T(this.r)}${T(this.g)}${T(this.b)}`}function L(){let e=O(this.opacity);return`${1===e?"rgb(":"rgba("}${R(this.r)}, ${R(this.g)}, ${R(this.b)}${1===e?")":`, ${e})`}`}function O(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function R(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function T(e){return((e=R(e))<16?"0":"")+e.toString(16)}function A(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new N(e,t,n,i)}function I(e){if(e instanceof N)return new N(e.h,e.s,e.l,e.opacity);if(e instanceof r||(e=b(e)),!e)return new N;if(e instanceof N)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,o=Math.min(t,n,i),a=Math.max(t,n,i),s=NaN,l=a-o,u=(a+o)/2;return l?(s=t===a?(n-i)/l+(n<i)*6:n===a?(i-t)/l+2:(t-n)/l+4,l/=u<.5?a+o:2-a-o,s*=60):l=u>0&&u<1?0:s,new N(s,l,u,e.opacity)}function z(e,t,n,i){return 1==arguments.length?I(e):new N(e,t,n,null==i?1:i)}function N(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function M(e){return(e=(e||0)%360)<0?e+360:e}function P(e){return Math.max(0,Math.min(1,e||0))}function D(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}(0,i.default)(r,b,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:_,formatHex:_,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return I(this).formatHsl()},formatRgb:x,toString:x}),(0,i.default)(C,E,(0,i.extend)(r,{brighter(e){return e=null==e?s:Math.pow(s,e),new C(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?o:Math.pow(o,e),new C(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new C(R(this.r),R(this.g),R(this.b),O(this.opacity))},displayable(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:$,formatHex:$,formatHex8:function(){return`#${T(this.r)}${T(this.g)}${T(this.b)}${T((isNaN(this.opacity)?1:this.opacity)*255)}`},formatRgb:L,toString:L})),(0,i.default)(N,z,(0,i.extend)(r,{brighter(e){return e=null==e?s:Math.pow(s,e),new N(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?o:Math.pow(o,e),new N(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new C(D(e>=240?e-240:e+120,r,i),D(e,r,i),D(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new N(M(this.h),P(this.s),P(this.l),O(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=O(this.opacity);return`${1===e?"hsl(":"hsla("}${M(this.h)}, ${100*P(this.s)}%, ${100*P(this.l)}%${1===e?")":`, ${e})`}`}}))}),s("bfWFq",function(t,n){function i(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function r(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}e(t.exports,"default",()=>i),e(t.exports,"extend",()=>r)});const l=e=>"string"==typeof e,u=()=>{let e,t,n=new Promise((n,i)=>{e=n,t=i});return n.resolve=e,n.reject=t,n},h=e=>null==e?"":""+e,c=(e,t,n)=>{e.forEach(e=>{t[e]&&(n[e]=t[e])})},d=/###/g,f=e=>e&&e.indexOf("###")>-1?e.replace(d,"."):e,p=e=>!e||l(e),g=(e,t,n)=>{let i=l(t)?t.split("."):t,r=0;for(;r<i.length-1;){if(p(e))return{};let t=f(i[r]);!e[t]&&n&&(e[t]=new n),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++r}return p(e)?{}:{obj:e,k:f(i[r])}},m=(e,t,n)=>{let{obj:i,k:r}=g(e,t,Object);if(void 0!==i||1===t.length){i[r]=n;return}let o=t[t.length-1],a=t.slice(0,t.length-1),s=g(e,a,Object);for(;void 0===s.obj&&a.length;)o=`${a[a.length-1]}.${o}`,s=g(e,a=a.slice(0,a.length-1),Object),s?.obj&&void 0!==s.obj[`${s.k}.${o}`]&&(s.obj=void 0);s.obj[`${s.k}.${o}`]=n},y=(e,t,n,i)=>{let{obj:r,k:o}=g(e,t,Object);r[o]=r[o]||[],r[o].push(n)},v=(e,t)=>{let{obj:n,k:i}=g(e,t);if(n&&Object.prototype.hasOwnProperty.call(n,i))return n[i]},_=(e,t,n)=>{let i=v(e,n);return void 0!==i?i:v(t,n)},x=(e,t,n)=>{for(let i in t)"__proto__"!==i&&"constructor"!==i&&(i in e?l(e[i])||e[i]instanceof String||l(t[i])||t[i]instanceof String?n&&(e[i]=t[i]):x(e[i],t[i],n):e[i]=t[i]);return e},b=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const S=e=>l(e)?e.replace(/[&<>"'\/]/g,e=>w[e]):e,k=[" ",",","?","!",";"],E=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){let t=this.regExpMap.get(e);if(void 0!==t)return t;let n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}(20),C=(e,t,n)=>{t=t||"",n=n||"";let i=k.filter(e=>0>t.indexOf(e)&&0>n.indexOf(e));if(0===i.length)return!0;let r=E.getRegExp(`(${i.map(e=>"?"===e?"\\?":e).join("|")})`),o=!r.test(e);if(!o){let t=e.indexOf(n);t>0&&!r.test(e.substring(0,t))&&(o=!0)}return o},$=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!e)return;if(e[t]){if(!Object.prototype.hasOwnProperty.call(e,t))return;return e[t]}let i=t.split(n),r=e;for(let e=0;e<i.length;){let t;if(!r||"object"!=typeof r)return;let o="";for(let a=e;a<i.length;++a)if(a!==e&&(o+=n),o+=i[a],void 0!==(t=r[o])){if(["string","number","boolean"].indexOf(typeof t)>-1&&a<i.length-1)continue;e+=a-e+1;break}r=t}return r},L=e=>e?.replace("_","-"),O={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console?.[e]?.apply?.(console,t)}};class R{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||O,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,n,i){return i&&!this.debug?null:(l(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new R(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new R(this.logger,e)}}var T=new R;class A{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(e=>{this.observers[e]||(this.observers[e]=new Map);let n=this.observers[e].get(t)||0;this.observers[e].set(t,n+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(e=>{let[t,i]=e;for(let e=0;e<i;e++)t(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(t=>{let[i,r]=t;for(let t=0;t<r;t++)i.apply(i,[e,...n])})}}class I extends A{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){0>this.options.ns.indexOf(e)&&this.options.ns.push(e)}removeNamespaces(e){let t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,n){let i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,a=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure;e.indexOf(".")>-1?i=e.split("."):(i=[e,t],n&&(Array.isArray(n)?i.push(...n):l(n)&&o?i.push(...n.split(o)):i.push(n)));let s=v(this.data,i);return(!s&&!t&&!n&&e.indexOf(".")>-1&&(e=i[0],t=i[1],n=i.slice(2).join(".")),!s&&a&&l(n))?$(this.data?.[e]?.[t],n,o):s}addResource(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},o=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,a=[e,t];n&&(a=a.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(a=e.split("."),i=t,t=a[1]),this.addNamespaces(t),m(this.data,a,i),r.silent||this.emit("added",e,t,n,i)}addResources(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(let i in n)(l(n[i])||Array.isArray(n[i]))&&this.addResource(e,t,i,n[i],{silent:!0});i.silent||this.emit("added",e,t,n)}addResourceBundle(e,t,n,i,r){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),i=n,n=t,t=a[1]),this.addNamespaces(t);let s=v(this.data,a)||{};o.skipCopy||(n=JSON.parse(JSON.stringify(n))),i?x(s,n,r):s={...s,...n},m(this.data,a,s),o.silent||this.emit("added",e,t,n)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){let t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(e=>t[e]&&Object.keys(t[e]).length>0)}toJSON(){return this.data}}var z={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,n,i,r){return e.forEach(e=>{t=this.processors[e]?.process(t,n,i,r)??t}),t}};const N={},M=e=>!l(e)&&"boolean"!=typeof e&&"number"!=typeof e;class P extends A{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),c(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=T.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;let n=this.resolve(e,t);return n?.res!==void 0}extractFromKey(e,t){let n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");let i=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,r=t.ns||this.options.defaultNS||[],o=n&&e.indexOf(n)>-1,a=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!C(e,n,i);if(o&&!a){let t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:l(r)?[r]:r};let o=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(o[0])>-1)&&(r=o.shift()),e=o.join(i)}return{key:e,namespaces:l(r)?[r]:r}}translate(e,t,n){if("object"!=typeof t&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof t&&(t={...t}),t||(t={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);let i=void 0!==t.returnDetails?t.returnDetails:this.options.returnDetails,r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,{key:o,namespaces:a}=this.extractFromKey(e[e.length-1],t),s=a[a.length-1],u=t.lng||this.language,h=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u?.toLowerCase()==="cimode"){if(h){let e=t.nsSeparator||this.options.nsSeparator;return i?{res:`${s}${e}${o}`,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:s,usedParams:this.getUsedParamsDetails(t)}:`${s}${e}${o}`}return i?{res:o,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:s,usedParams:this.getUsedParamsDetails(t)}:o}let c=this.resolve(e,t),d=c?.res,f=c?.usedKey||o,p=c?.exactUsedKey||o,g=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,m=!this.i18nFormat||this.i18nFormat.handleAsObject,y=void 0!==t.count&&!l(t.count),v=P.hasDefaultValue(t),_=y?this.pluralResolver.getSuffix(u,t.count,t):"",x=t.ordinal&&y?this.pluralResolver.getSuffix(u,t.count,{ordinal:!1}):"",b=y&&!t.ordinal&&0===t.count,w=b&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${_}`]||t[`defaultValue${x}`]||t.defaultValue,S=d;m&&!d&&v&&(S=w);let k=M(S),E=Object.prototype.toString.apply(S);if(m&&S&&k&&0>["[object Number]","[object Function]","[object RegExp]"].indexOf(E)&&!(l(g)&&Array.isArray(S))){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");let e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(f,S,{...t,ns:a}):`key '${o} (${this.language})' returned an object instead of string.`;return i?(c.res=e,c.usedParams=this.getUsedParamsDetails(t),c):e}if(r){let e=Array.isArray(S),n=e?[]:{},i=e?p:f;for(let e in S)if(Object.prototype.hasOwnProperty.call(S,e)){let o=`${i}${r}${e}`;v&&!d?n[e]=this.translate(o,{...t,defaultValue:M(w)?w[e]:void 0,joinArrays:!1,ns:a}):n[e]=this.translate(o,{...t,joinArrays:!1,ns:a}),n[e]===o&&(n[e]=S[e])}d=n}}else if(m&&l(g)&&Array.isArray(d))(d=d.join(g))&&(d=this.extendTranslation(d,e,t,n));else{let i=!1,a=!1;!this.isValidLookup(d)&&v&&(i=!0,d=w),this.isValidLookup(d)||(a=!0,d=o);let l=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&a?void 0:d,h=v&&w!==d&&this.options.updateMissing;if(a||i||h){if(this.logger.log(h?"updateKey":"missingKey",u,s,o,h?w:d),r){let e=this.resolve(o,{...t,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[],n=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&n&&n[0])for(let t=0;t<n.length;t++)e.push(n[t]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(t.lng||this.language):e.push(t.lng||this.language);let i=(e,n,i)=>{let r=v&&i!==d?i:l;this.options.missingKeyHandler?this.options.missingKeyHandler(e,s,n,r,h,t):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(e,s,n,r,h,t),this.emit("missingKey",e,s,n,d)};this.options.saveMissing&&(this.options.saveMissingPlurals&&y?e.forEach(e=>{let n=this.pluralResolver.getSuffixes(e,t);b&&t[`defaultValue${this.options.pluralSeparator}zero`]&&0>n.indexOf(`${this.options.pluralSeparator}zero`)&&n.push(`${this.options.pluralSeparator}zero`),n.forEach(n=>{i([e],o+n,t[`defaultValue${n}`]||w)})}):i(e,o,w))}d=this.extendTranslation(d,e,t,c,n),a&&d===o&&this.options.appendNamespaceToMissingKey&&(d=`${s}:${o}`),(a||i)&&this.options.parseMissingKeyHandler&&(d=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${s}:${o}`:o,i?d:void 0))}return i?(c.res=d,c.usedParams=this.getUsedParamsDetails(t),c):d}extendTranslation(e,t,n,i,r){var o=this;if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){let a;n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});let s=l(e)&&(n?.interpolation?.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(s){let t=e.match(this.interpolator.nestingRegexp);a=t&&t.length}let u=n.replace&&!l(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(u={...this.options.interpolation.defaultVariables,...u}),e=this.interpolator.interpolate(e,u,n.lng||this.language||i.usedLng,n),s){let t=e.match(this.interpolator.nestingRegexp);a<(t&&t.length)&&(n.nest=!1)}!n.lng&&i&&i.res&&(n.lng=this.language||i.usedLng),!1!==n.nest&&(e=this.interpolator.nest(e,function(){for(var e=arguments.length,i=Array(e),a=0;a<e;a++)i[a]=arguments[a];return r?.[0]!==i[0]||n.context?o.translate(...i,t):(o.logger.warn(`It seems you are nesting recursively key: ${i[0]} in key: ${t[0]}`),null)},n)),n.interpolation&&this.interpolator.reset()}let a=n.postProcess||this.options.postProcess,s=l(a)?[a]:a;return null!=e&&s?.length&&!1!==n.applyPostProcessor&&(e=z.handle(s,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e){let t,n,i,r,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(e)&&(e=[e]),e.forEach(e=>{if(this.isValidLookup(t))return;let s=this.extractFromKey(e,a),u=s.key;n=u;let h=s.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));let c=void 0!==a.count&&!l(a.count),d=c&&!a.ordinal&&0===a.count,f=void 0!==a.context&&(l(a.context)||"number"==typeof a.context)&&""!==a.context,p=a.lngs?a.lngs:this.languageUtils.toResolveHierarchy(a.lng||this.language,a.fallbackLng);h.forEach(e=>{this.isValidLookup(t)||(o=e,!N[`${p[0]}-${e}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(o)&&(N[`${p[0]}-${e}`]=!0,this.logger.warn(`key "${n}" for languages "${p.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(n=>{let o;if(this.isValidLookup(t))return;r=n;let s=[u];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(s,u,n,e,a);else{let e;c&&(e=this.pluralResolver.getSuffix(n,a.count,a));let t=`${this.options.pluralSeparator}zero`,i=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(c&&(s.push(u+e),a.ordinal&&0===e.indexOf(i)&&s.push(u+e.replace(i,this.options.pluralSeparator)),d&&s.push(u+t)),f){let n=`${u}${this.options.contextSeparator}${a.context}`;s.push(n),c&&(s.push(n+e),a.ordinal&&0===e.indexOf(i)&&s.push(n+e.replace(i,this.options.pluralSeparator)),d&&s.push(n+t))}}for(;o=s.pop();)this.isValidLookup(t)||(i=o,t=this.getResource(n,e,o,a))}))})}),{res:t,usedKey:n,exactUsedKey:i,usedLng:r,usedNS:o}}isValidLookup(e){return void 0!==e&&!(!this.options.returnNull&&null===e)&&!(!this.options.returnEmptyString&&""===e)}getResource(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,t,n,i):this.resourceStore.getResource(e,t,n,i)}getUsedParamsDetails(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.replace&&!l(e.replace),n=t?e.replace:e;if(t&&void 0!==e.count&&(n.count=e.count),this.options.interpolation.defaultVariables&&(n={...this.options.interpolation.defaultVariables,...n}),!t)for(let e of(n={...n},["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"]))delete n[e];return n}static hasDefaultValue(e){let t="defaultValue";for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,t.length)&&void 0!==e[n])return!0;return!1}}class D{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=T.create("languageUtils")}getScriptPartFromCode(e){if(!(e=L(e))||0>e.indexOf("-"))return null;let t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase())?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(!(e=L(e))||0>e.indexOf("-"))return e;let t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(l(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch(e){}return(t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t)?t:this.options.lowerCaseLng?e.toLowerCase():e}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){let t;return e?(e.forEach(e=>{if(t)return;let n=this.formatLanguageCode(e);(!this.options.supportedLngs||this.isSupportedCode(n))&&(t=n)}),!t&&this.options.supportedLngs&&e.forEach(e=>{if(t)return;let n=this.getLanguagePartFromCode(e);if(this.isSupportedCode(n))return t=n;t=this.options.supportedLngs.find(e=>{if(e===n||!(0>e.indexOf("-")&&0>n.indexOf("-"))&&(e.indexOf("-")>0&&0>n.indexOf("-")&&e.substring(0,e.indexOf("-"))===n||0===e.indexOf(n)&&n.length>1))return e})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),l(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}toResolveHierarchy(e,t){let n=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],r=e=>{e&&(this.isSupportedCode(e)?i.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return l(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&r(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&r(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&r(this.getLanguagePartFromCode(e))):l(e)&&r(this.formatLanguageCode(e)),n.forEach(e=>{0>i.indexOf(e)&&r(this.formatLanguageCode(e))}),i}}const j={zero:0,one:1,two:2,few:3,many:4,other:5},B={select:e=>1===e?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class F{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=T.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=L("dev"===e?"en":e),r=n.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:i,type:r});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];try{t=new Intl.PluralRules(i,{type:r})}catch(r){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),B;if(!e.match(/-|_/))return B;let i=this.languageUtils.getLanguagePartFromCode(e);t=this.getRule(i,n)}return this.pluralRulesCache[o]=t,t}needsPlural(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),n?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,n).map(e=>`${t}${e}`)}getSuffixes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(e,t);return(n||(n=this.getRule("dev",t)),n)?n.resolvedOptions().pluralCategories.sort((e,t)=>j[e]-j[t]).map(e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`):[]}getSuffix(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getRule(e,n);return i?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,n))}}const V=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",r=!(arguments.length>4)||void 0===arguments[4]||arguments[4],o=_(e,t,n);return!o&&r&&l(n)&&void 0===(o=$(e,n,i))&&(o=$(t,n,i)),o},H=e=>e.replace(/\$/g,"$$$$");class U{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=T.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(e=>e),this.init(e)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});let{escape:t,escapeValue:n,useRawValueToEscape:i,prefix:r,prefixEscaped:o,suffix:a,suffixEscaped:s,formatSeparator:l,unescapeSuffix:u,unescapePrefix:h,nestingPrefix:c,nestingPrefixEscaped:d,nestingSuffix:f,nestingSuffixEscaped:p,nestingOptionsSeparator:g,maxReplaces:m,alwaysFormat:y}=e.interpolation;this.escape=void 0!==t?t:S,this.escapeValue=void 0===n||n,this.useRawValueToEscape=void 0!==i&&i,this.prefix=r?b(r):o||"{{",this.suffix=a?b(a):s||"}}",this.formatSeparator=l||",",this.unescapePrefix=u?"":h||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=c?b(c):d||b("$t("),this.nestingSuffix=f?b(f):p||b(")"),this.nestingOptionsSeparator=g||",",this.maxReplaces=m||1e3,this.alwaysFormat=void 0!==y&&y,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let e=(e,t)=>e?.source===t?(e.lastIndex=0,e):RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,n,i){let r,o,a,s=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=e=>{if(0>e.indexOf(this.formatSeparator)){let r=V(t,s,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(r,void 0,n,{...i,...t,interpolationkey:e}):r}let r=e.split(this.formatSeparator),o=r.shift().trim(),a=r.join(this.formatSeparator).trim();return this.format(V(t,s,o,this.options.keySeparator,this.options.ignoreJSONStructure),a,n,{...i,...t,interpolationkey:o})};this.resetRegExp();let c=i?.missingInterpolationHandler||this.options.missingInterpolationHandler,d=i?.interpolation?.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>H(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?H(this.escape(e)):H(e)}].forEach(t=>{for(a=0;r=t.regex.exec(e);){let n=r[1].trim();if(void 0===(o=u(n)))if("function"==typeof c){let t=c(e,r,i);o=l(t)?t:""}else if(i&&Object.prototype.hasOwnProperty.call(i,n))o="";else if(d){o=r[0];continue}else this.logger.warn(`missed to pass in variable ${n} for interpolating ${e}`),o="";else l(o)||this.useRawValueToEscape||(o=h(o));let s=t.safeValue(o);if(e=e.replace(r[0],s),d?(t.regex.lastIndex+=o.length,t.regex.lastIndex-=r[0].length):t.regex.lastIndex=0,++a>=this.maxReplaces)break}}),e}nest(e,t){let n,i,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=(e,t)=>{let n=this.nestingOptionsSeparator;if(0>e.indexOf(n))return e;let i=e.split(RegExp(`${n}[ ]*{`)),o=`{${i[1]}`;e=i[0];let a=(o=this.interpolate(o,r)).match(/'/g),s=o.match(/"/g);((a?.length??0)%2!=0||s)&&s.length%2==0||(o=o.replace(/'/g,'"'));try{r=JSON.parse(o),t&&(r={...t,...r})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${n}${o}`}return r.defaultValue&&r.defaultValue.indexOf(this.prefix)>-1&&delete r.defaultValue,e};for(;n=this.nestingRegexp.exec(e);){let s=[];(r=(r={...o}).replace&&!l(r.replace)?r.replace:r).applyPostProcessor=!1,delete r.defaultValue;let u=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){let e=n[1].split(this.formatSeparator).map(e=>e.trim());n[1]=e.shift(),s=e,u=!0}if((i=t(a.call(this,n[1].trim(),r),r))&&n[0]===e&&!l(i))return i;l(i)||(i=h(i)),i||(this.logger.warn(`missed to resolve ${n[1]} for nesting ${e}`),i=""),u&&(i=s.reduce((e,t)=>this.format(e,t,o.lng,{...o,interpolationkey:n[1].trim()}),i.trim())),e=e.replace(n[0],i),this.regexp.lastIndex=0}return e}}const q=e=>{let t=e.toLowerCase().trim(),n={};if(e.indexOf("(")>-1){let i=e.split("(");t=i[0].toLowerCase().trim();let r=i[1].substring(0,i[1].length-1);"currency"===t&&0>r.indexOf(":")?n.currency||(n.currency=r.trim()):"relativetime"===t&&0>r.indexOf(":")?n.range||(n.range=r.trim()):r.split(";").forEach(e=>{if(e){let[t,...i]=e.split(":"),r=i.join(":").trim().replace(/^'+|'+$/g,""),o=t.trim();n[o]||(n[o]=r),"false"===r&&(n[o]=!1),"true"===r&&(n[o]=!0),isNaN(r)||(n[o]=parseInt(r,10))}})}return{formatName:t,formatOptions:n}},K=e=>{let t={};return(n,i,r)=>{let o=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(o={...o,[r.interpolationkey]:void 0});let a=i+JSON.stringify(o),s=t[a];return s||(s=e(L(i),r),t[a]=s),s(n)}};class G{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=T.create("formatter"),this.options=e,this.formats={number:K((e,t)=>{let n=new Intl.NumberFormat(e,{...t});return e=>n.format(e)}),currency:K((e,t)=>{let n=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>n.format(e)}),datetime:K((e,t)=>{let n=new Intl.DateTimeFormat(e,{...t});return e=>n.format(e)}),relativetime:K((e,t)=>{let n=new Intl.RelativeTimeFormat(e,{...t});return e=>n.format(e,t.range||"day")}),list:K((e,t)=>{let n=new Intl.ListFormat(e,{...t});return e=>n.format(e)})},this.init(e)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=K(t)}format(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=t.split(this.formatSeparator);if(r.length>1&&r[0].indexOf("(")>1&&0>r[0].indexOf(")")&&r.find(e=>e.indexOf(")")>-1)){let e=r.findIndex(e=>e.indexOf(")")>-1);r[0]=[r[0],...r.splice(1,e)].join(this.formatSeparator)}return r.reduce((e,t)=>{let{formatName:r,formatOptions:o}=q(t);if(this.formats[r]){let t=e;try{let a=i?.formatParams?.[i.interpolationkey]||{},s=a.locale||a.lng||i.locale||i.lng||n;t=this.formats[r](e,s,{...o,...i,...a})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${r}`),e},e)}}const W=(e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)};class Y extends A{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=T.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(n,i.backend,i)}queueLoad(e,t,n,i){let r={},o={},a={},s={};return e.forEach(e=>{let i=!0;t.forEach(t=>{let a=`${e}|${t}`;!n.reload&&this.store.hasResourceBundle(e,t)?this.state[a]=2:this.state[a]<0||(1===this.state[a]?void 0===o[a]&&(o[a]=!0):(this.state[a]=1,i=!1,void 0===o[a]&&(o[a]=!0),void 0===r[a]&&(r[a]=!0),void 0===s[t]&&(s[t]=!0)))}),i||(a[e]=!0)}),(Object.keys(r).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(r),pending:Object.keys(o),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(s)}}loaded(e,t,n){let i=e.split("|"),r=i[0],o=i[1];t&&this.emit("failedLoading",r,o,t),!t&&n&&this.store.addResourceBundle(r,o,n,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&n&&(this.state[e]=0);let a={};this.queue.forEach(n=>{y(n.loaded,[r],o),W(n,e),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach(e=>{a[e]||(a[e]={});let t=n.loaded[e];t.length&&t.forEach(t=>{void 0===a[e][t]&&(a[e][t]=!0)})}),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(e=>!e.done)}read(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:n,tried:i,wait:r,callback:o});return}this.readingCalls++;let a=(a,s)=>{if(this.readingCalls--,this.waitingReads.length>0){let e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}if(a&&s&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,n,i+1,2*r,o)},r);return}o(a,s)},s=this.backend[n].bind(this.backend);if(2===s.length){try{let n=s(e,t);n&&"function"==typeof n.then?n.then(e=>a(null,e)).catch(a):a(null,n)}catch(e){a(e)}return}return s(e,t,a)}prepareLoading(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();l(e)&&(e=this.languageUtils.toResolveHierarchy(e)),l(t)&&(t=[t]);let r=this.queueLoad(e,t,n,i);if(!r.toLoad.length)return r.pending.length||i(),null;r.toLoad.forEach(e=>{this.loadOne(e)})}load(e,t,n){this.prepareLoading(e,t,{},n)}reload(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}loadOne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.split("|"),i=n[0],r=n[1];this.read(i,r,"read",void 0,void 0,(n,o)=>{n&&this.logger.warn(`${t}loading namespace ${r} for language ${i} failed`,n),!n&&o&&this.logger.log(`${t}loaded namespace ${r} for language ${i}`,o),this.loaded(e,n,o)})}saveMissing(e,t,n,i,r){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(t)){this.logger.warn(`did not save key "${n}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(null!=n&&""!==n){if(this.backend?.create){let s={...o,isUpdate:r},l=this.backend.create.bind(this.backend);if(l.length<6)try{let r;(r=5===l.length?l(e,t,n,i,s):l(e,t,n,i))&&"function"==typeof r.then?r.then(e=>a(null,e)).catch(a):a(null,r)}catch(e){a(e)}else l(e,t,n,i,a,s)}e&&e[0]&&this.store.addResource(e[0],t,n,i)}}}const X=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"==typeof e[1]&&(t=e[1]),l(e[1])&&(t.defaultValue=e[1]),l(e[2])&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){let n=e[3]||e[2];Object.keys(n).forEach(e=>{t[e]=n[e]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),J=e=>(l(e.ns)&&(e.ns=[e.ns]),l(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),l(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),"boolean"==typeof e.initImmediate&&(e.initAsync=e.initImmediate),e),Q=()=>{},Z=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(t=>{"function"==typeof e[t]&&(e[t]=e[t].bind(e))})};class ee extends A{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=J(e),this.services={},this.logger=T,this.modules={external:[]},Z(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"==typeof t&&(n=t,t={}),null==t.defaultNS&&t.ns&&(l(t.ns)?t.defaultNS=t.ns:0>t.ns.indexOf("translation")&&(t.defaultNS=t.ns[0]));let i=X();this.options={...i,...this.options,...J(t)},this.options.interpolation={...i.interpolation,...this.options.interpolation},void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator);let r=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let t;this.modules.logger?T.init(r(this.modules.logger),this.options):T.init(null,this.options),t=this.modules.formatter?this.modules.formatter:G;let n=new D(this.options);this.store=new I(this.options.resources,this.options);let o=this.services;o.logger=T,o.resourceStore=this.store,o.languageUtils=n,o.pluralResolver=new F(n,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),t&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(o.formatter=r(t),o.formatter.init(o,this.options),this.options.interpolation.format=o.formatter.format.bind(o.formatter)),o.interpolator=new U(this.options),o.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},o.backendConnector=new Y(r(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.emit(t,...i)}),this.modules.languageDetector&&(o.languageDetector=r(this.modules.languageDetector),o.languageDetector.init&&o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=r(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new P(this.services,this.options),this.translator.on("*",function(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];e.emit(t,...i)}),this.modules.external.forEach(e=>{e.init&&e.init(this)})}if(this.format=this.options.interpolation.format,n||(n=Q),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(t=>{this[t]=function(){return e.store[t](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(t=>{this[t]=function(){return e.store[t](...arguments),e}});let o=u(),a=()=>{let e=(e,t)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(t),n(e,t)};if(this.languages&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initAsync?a():setTimeout(a,0),o}loadResources(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q,n=t,i=l(e)?e:this.language;if("function"==typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(i?.toLowerCase()==="cimode"&&(!this.options.preload||0===this.options.preload.length))return n();let e=[],t=t=>{t&&"cimode"!==t&&this.services.languageUtils.toResolveHierarchy(t).forEach(t=>{"cimode"!==t&&0>e.indexOf(t)&&e.push(t)})};i?t(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(e=>t(e)),this.options.preload?.forEach?.(e=>t(e)),this.services.backendConnector.load(e,this.options.ns,e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),n(e)})}else n(null)}reloadResources(e,t,n){let i=u();return"function"==typeof e&&(n=e,e=void 0),"function"==typeof t&&(n=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),n||(n=Q),this.services.backendConnector.reload(e,t,e=>{i.resolve(),n(e)}),i}use(e){if(!e)throw Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&z.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(let e=0;e<this.languages.length;e++){let t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}}changeLanguage(e,t){var n=this;this.isLanguageChangingTo=e;let i=u();this.emit("languageChanging",e);let r=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},o=(e,o)=>{o?(r(o),this.translator.changeLanguage(o),this.isLanguageChangingTo=void 0,this.emit("languageChanged",o),this.logger.log("languageChanged",o)):this.isLanguageChangingTo=void 0,i.resolve(function(){return n.t(...arguments)}),t&&t(e,function(){return n.t(...arguments)})},a=t=>{e||t||!this.services.languageDetector||(t=[]);let n=l(t)?t:this.services.languageUtils.getBestMatchFromCodes(t);n&&(this.language||r(n),this.translator.language||this.translator.changeLanguage(n),this.services.languageDetector?.cacheUserLanguage?.(n)),this.loadResources(n,e=>{o(e,n)})};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e):a(this.services.languageDetector.detect()),i}getFixedT(e,t,n){var i=this;let r=function(e,t){let o,a;if("object"!=typeof t){for(var s=arguments.length,l=Array(s>2?s-2:0),u=2;u<s;u++)l[u-2]=arguments[u];o=i.options.overloadTranslationOptionHandler([e,t].concat(l))}else o={...t};o.lng=o.lng||r.lng,o.lngs=o.lngs||r.lngs,o.ns=o.ns||r.ns,""!==o.keyPrefix&&(o.keyPrefix=o.keyPrefix||n||r.keyPrefix);let h=i.options.keySeparator||".";return a=o.keyPrefix&&Array.isArray(e)?e.map(e=>`${o.keyPrefix}${h}${e}`):o.keyPrefix?`${o.keyPrefix}${h}${e}`:e,i.t(a,o)};return l(e)?r.lng=e:r.lngs=e,r.ns=t,r.keyPrefix=n,r}t(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.translator?.translate(...t)}exists(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.translator?.exists(...t)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let n=t.lng||this.resolvedLanguage||this.languages[0],i=!!this.options&&this.options.fallbackLng,r=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;let o=(e,t)=>{let n=this.services.backendConnector.state[`${e}|${t}`];return -1===n||0===n||2===n};if(t.precheck){let e=t.precheck(this,o);if(void 0!==e)return e}return!!(this.hasResourceBundle(n,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(n,e)&&(!i||o(r,e)))}loadNamespaces(e,t){let n=u();return this.options.ns?(l(e)&&(e=[e]),e.forEach(e=>{0>this.options.ns.indexOf(e)&&this.options.ns.push(e)}),this.loadResources(e=>{n.resolve(),t&&t(e)}),n):(t&&t(),Promise.resolve())}loadLanguages(e,t){let n=u();l(e)&&(e=[e]);let i=this.options.preload||[],r=e.filter(e=>0>i.indexOf(e)&&this.services.languageUtils.isSupportedCode(e));return r.length?(this.options.preload=i.concat(r),this.loadResources(e=>{n.resolve(),t&&t(e)}),n):(t&&t(),Promise.resolve())}dir(e){return(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),e)?["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf((this.services?.languageUtils||new D(X())).getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr":"rtl"}static createInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new ee(e,t)}cloneInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q,n=e.forkResourceStore;n&&delete e.forkResourceStore;let i={...this.options,...e,isClone:!0},r=new ee(i);return(void 0!==e.debug||void 0!==e.prefix)&&(r.logger=r.logger.clone(e)),["store","services","language"].forEach(e=>{r[e]=this[e]}),r.services={...this.services},r.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},n&&(r.store=new I(Object.keys(this.store.data).reduce((e,t)=>(e[t]={...this.store.data[t]},Object.keys(e[t]).reduce((n,i)=>(n[i]={...e[t][i]},n),{})),{}),i),r.services.resourceStore=r.store),r.translator=new P(r.services,i),r.translator.on("*",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];r.emit(e,...n)}),r.init(i,t),r.translator.options=i,r.translator.backendConnector.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const et=ee.createInstance();et.createInstance=ee.createInstance,et.createInstance,et.dir,et.init,et.loadResources,et.reloadResources,et.use,et.changeLanguage,et.getFixedT,et.t,et.exists,et.setDefaultNamespace,et.hasLoadedNamespace,et.loadNamespaces,et.loadLanguages;const{slice:en,forEach:ei}=[],er=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,eo=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{path:"/"},i=encodeURIComponent(t),r=`${e}=${i}`;if(n.maxAge>0){let e=n.maxAge-0;if(Number.isNaN(e))throw Error("maxAge should be a Number");r+=`; Max-Age=${Math.floor(e)}`}if(n.domain){if(!er.test(n.domain))throw TypeError("option domain is invalid");r+=`; Domain=${n.domain}`}if(n.path){if(!er.test(n.path))throw TypeError("option path is invalid");r+=`; Path=${n.path}`}if(n.expires){if("function"!=typeof n.expires.toUTCString)throw TypeError("option expires is invalid");r+=`; Expires=${n.expires.toUTCString()}`}if(n.httpOnly&&(r+="; HttpOnly"),n.secure&&(r+="; Secure"),n.sameSite)switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"none":r+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return r},ea={create(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{path:"/",sameSite:"strict"};n&&(r.expires=new Date,r.expires.setTime(r.expires.getTime()+6e4*n)),i&&(r.domain=i),document.cookie=eo(e,encodeURIComponent(t),r)},read(e){let t=`${e}=`,n=document.cookie.split(";");for(let e=0;e<n.length;e++){let i=n[e];for(;" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null},remove(e){this.create(e,"",-1)}};var es={name:"cookie",lookup(e){let{lookupCookie:t}=e;if(t&&"undefined"!=typeof document)return ea.read(t)||void 0},cacheUserLanguage(e,t){let{lookupCookie:n,cookieMinutes:i,cookieDomain:r,cookieOptions:o}=t;n&&"undefined"!=typeof document&&ea.create(n,e,i,r,o)}},el={name:"querystring",lookup(e){let t,{lookupQuerystring:n}=e;if("undefined"!=typeof window){let{search:e}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(e=window.location.hash.substring(window.location.hash.indexOf("?")));let i=e.substring(1).split("&");for(let e=0;e<i.length;e++){let r=i[e].indexOf("=");r>0&&i[e].substring(0,r)===n&&(t=i[e].substring(r+1))}}return t}};let eu=null;const eh=()=>{if(null!==eu)return eu;try{if(!(eu="undefined"!=typeof window&&null!==window.localStorage))return!1;let e="i18next.translate.boo";window.localStorage.setItem(e,"foo"),window.localStorage.removeItem(e)}catch(e){eu=!1}return eu};var ec={name:"localStorage",lookup(e){let{lookupLocalStorage:t}=e;if(t&&eh())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupLocalStorage:n}=t;n&&eh()&&window.localStorage.setItem(n,e)}};let ed=null;const ef=()=>{if(null!==ed)return ed;try{if(!(ed="undefined"!=typeof window&&null!==window.sessionStorage))return!1;let e="i18next.translate.boo";window.sessionStorage.setItem(e,"foo"),window.sessionStorage.removeItem(e)}catch(e){ed=!1}return ed};var ep={name:"sessionStorage",lookup(e){let{lookupSessionStorage:t}=e;if(t&&ef())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(e,t){let{lookupSessionStorage:n}=t;n&&ef()&&window.sessionStorage.setItem(n,e)}},eg={name:"navigator",lookup(e){let t=[];if("undefined"!=typeof navigator){let{languages:e,userLanguage:n,language:i}=navigator;if(e)for(let n=0;n<e.length;n++)t.push(e[n]);n&&t.push(n),i&&t.push(i)}return t.length>0?t:void 0}},em={name:"htmlTag",lookup(e){let t,{htmlTag:n}=e,i=n||("undefined"!=typeof document?document.documentElement:null);return i&&"function"==typeof i.getAttribute&&(t=i.getAttribute("lang")),t}},ey={name:"path",lookup(e){let{lookupFromPathIndex:t}=e;if("undefined"==typeof window)return;let n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(Array.isArray(n))return n["number"==typeof t?t:0]?.replace("/","")}},ev={name:"subdomain",lookup(e){let{lookupFromSubdomainIndex:t}=e,n="undefined"!=typeof window&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(n)return n["number"==typeof t?t+1:1]}};let e_=!1;try{document.cookie,e_=!0}catch(e){}const ex=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];e_||ex.splice(1,1);const eb=()=>({order:ex,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:e=>e});class ew{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,t)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{languageUtils:{}},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.services=e,this.options=function(e){return ei.call(en.call(arguments,1),t=>{if(t)for(let n in t)void 0===e[n]&&(e[n]=t[n])}),e}(t,this.options||{},eb()),"string"==typeof this.options.convertDetectedLanguage&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=e=>e.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(es),this.addDetector(el),this.addDetector(ec),this.addDetector(ep),this.addDetector(eg),this.addDetector(em),this.addDetector(ey),this.addDetector(ev)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.order,t=[];return(e.forEach(e=>{if(this.detectors[e]){let n=this.detectors[e].lookup(this.options);n&&"string"==typeof n&&(n=[n]),n&&(t=t.concat(n))}}),t=t.map(e=>this.options.convertDetectedLanguage(e)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes)?t:t.length>0?t[0]:null}cacheUserLanguage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.caches;t&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||t.forEach(t=>{this.detectors[t]&&this.detectors[t].cacheUserLanguage(e,this.options)}))}}function eS(e,t=null){console.log(`[i18n] ${e}`),t&&console.log(t)}ew.type="languageDetector";const ek={en:{translation:{appTitle:"Family Tree Visualization",inputTitle:"Input Data",configTitle:"Configuration",layoutTitle:"Layout Options",visualTitle:"Visual Options",exportTitle:"Export Options",visTitle:"Family Tree Visualization",fileLabel:"Choose CSV File:",loadSample:"Load Sample Data",orientation:"Orientation:",topDown:"Top Down",bottomUp:"Bottom Up",leftRight:"Left to Right",rightLeft:"Right to Left",nodeSize:"Node Size:",nodeSpacing:"Node Spacing:",colorScheme:"Color Scheme:",default:"Default",genderBased:"Gender-Based",generationBased:"Generation-Based",custom:"Custom",fontSize:"Font Size:",lineStyle:"Line Style:",straight:"Straight",curved:"Curved",angled:"Angled",svgWidth:"SVG Width (pixels):",svgHeight:"SVG Height (pixels):",generateTree:"Generate Tree",exportSVG:"Export SVG",resetView:"Reset View",language:"Language:",born:"Born:",died:"Died:",age:"Age:",nativePlace:"Native Place:",spouse:"Spouse:",father:"Father:",mother:"Mother:",son:"Son",daughter:"Daughter",husband:"Husband",wife:"Wife",uploadFirst:"Please upload a CSV file or load sample data first.",generateFirst:"Please generate a family tree first.",parseError:"Error parsing CSV file:",generateError:"Error generating family tree:",exportError:"Error exporting SVG:",footerText:"Family Tree Visualization Tool - Multilingual Support"}},ta:{translation:{appTitle:"குடும்ப மர காட்சிப்படுத்தல்",inputTitle:"உள்ளீட்டு தரவு",configTitle:"கட்டமைப்பு",layoutTitle:"அமைப்பு விருப்பங்கள்",visualTitle:"காட்சி விருப்பங்கள்",exportTitle:"ஏற்றுமதி விருப்பங்கள்",visTitle:"குடும்ப மர காட்சி",fileLabel:"CSV கோப்பைத் தேர்ந்தெடுக்கவும்:",loadSample:"மாதிரி தரவை ஏற்றவும்",orientation:"அமைப்பு:",topDown:"மேலிருந்து கீழ்",bottomUp:"கீழிருந்து மேல்",leftRight:"இடமிருந்து வலம்",rightLeft:"வலமிருந்து இடம்",nodeSize:"முனை அளவு:",nodeSpacing:"முனை இடைவெளி:",colorScheme:"வண்ண திட்டம்:",default:"இயல்புநிலை",genderBased:"பாலின அடிப்படையில்",generationBased:"தலைமுறை அடிப்படையில்",custom:"தனிப்பயன்",fontSize:"எழுத்து அளவு:",lineStyle:"கோட்டு பாணி:",straight:"நேரான",curved:"வளைந்த",angled:"கோணமான",svgWidth:"SVG அகலம் (பிக்சல்கள்):",svgHeight:"SVG உயரம் (பிக்சல்கள்):",generateTree:"மரத்தை உருவாக்கு",exportSVG:"SVG ஏற்றுமதி",resetView:"காட்சியை மீட்டமை",language:"மொழி:",born:"பிறந்த தேதி:",died:"இறந்த தேதி:",age:"வயது:",nativePlace:"சொந்த ஊர்:",spouse:"துணைவர்:",father:"தந்தை:",mother:"தாய்:",son:"மகன்",daughter:"மகள்",husband:"கணவர்",wife:"மனைவி",uploadFirst:"முதலில் CSV கோப்பை பதிவேற்றவும் அல்லது மாதிரி தரவை ஏற்றவும்.",generateFirst:"முதலில் குடும்ப மரத்தை உருவாக்கவும்.",parseError:"CSV கோப்பை பகுப்பாய்வதில் பிழை:",generateError:"குடும்ப மரத்தை உருவாக்குவதில் பிழை:",exportError:"SVG ஏற்றுமதியில் பிழை:",footerText:"குடும்ப மர காட்சிப்படுத்தல் கருவி - பல மொழி ஆதரவு"}}};async function eE(){eS("Initializing i18next");try{return await et.use(ew).init({resources:ek,fallbackLng:"en",debug:!1,interpolation:{escapeValue:!1}}),eS("i18next initialized successfully"),et}catch(e){return eS("Error initializing i18next",e),console.error("Error initializing i18next:",e),{t:(e,t={})=>{let n=t.lng||"en";try{return ek[n]?.translation[e]||ek.en.translation[e]||e}catch(t){return e}},language:"en",changeLanguage:e=>{}}}}function eC(e,t={}){return et.t(e,t)}var e$={};function eL(e,t=null){console.log(`[CSVParser] ${e}`),t&&console.log(t)}function eO(e){eL("Validating CSV fields",e);let t=["id","name","gender"].filter(t=>!e.includes(t));if(t.length>0)throw Error(`Missing required fields: ${t.join(", ")}`);eL("All required fields present")}function eR(e){eL(`Processing ${e.length} rows of CSV data`);let t=e.map(e=>{try{return{id:e.id,name:e.name.trim(),gender:e.gender.trim(),spouse_name:e.spouse_name?e.spouse_name.trim():null,father_name:e.father_name?e.father_name.trim():null,mother_name:e.mother_name?e.mother_name.trim():null,birth_date:e.birth_date?e.birth_date.trim():null,death_date:e.death_date?e.death_date.trim():null,native_place:e.native_place?e.native_place.trim():null,father_id:e.father_id?e.father_id.trim():null,mother_id:e.mother_id?e.mother_id.trim():null,spouse_id:e.spouse_id?e.spouse_id.trim():null}}catch(t){throw eL("Error processing row",{row:e,error:t}),Error(`Error processing row with ID ${e.id||"unknown"}: ${t.message}`)}});return eL(`Successfully processed ${t.length} rows`),t}function eT(e,t="en"){if(!e)return"";if("string"==typeof e)return e;try{return e.toLocaleDateString("ta"===t?"ta-IN":t,{year:"numeric",month:"long",day:"numeric"})}catch(t){return console.warn("Date formatting error:",t),e.toISOString().split("T")[0]}}function eA(e,t=null){console.log(`[FamilyTreeBuilder] ${e}`),t&&console.log(t)}function eI(e,t,n){let i=t[n+"Id"];if(i&&e[i]){let n=e[i];t.parents.includes(n)||t.parents.push(n),n.children.includes(t)||n.children.push(t)}}function ez(e,t,n){if(t.parents.length>0)return;let i=t[n+"Name"];if(i){let r=Object.values(e).find(e=>e.name.toLowerCase()===i.toLowerCase()&&("father"===n?"male"===e.gender:"female"===e.gender));r&&(t.parents.includes(r)||t.parents.push(r),r.children.includes(t)||r.children.push(t))}}tO=function e(){var t,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},i=!n.document&&!!n.postMessage,r=n.IS_PAPA_WORKER||!1,o={},a=0,s={};function l(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(e){var t=_(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new f(t),(this._handle.streamer=this)._config=t}).call(this,e),this.parseChunk=function(e,t){var i=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<i){let t=this._config.newline;t||(o=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,o)),e=[...e.split(t).slice(i)].join(t)}this.isFirstChunk&&b(this._config.beforeFirstChunk)&&void 0!==(o=this._config.beforeFirstChunk(e))&&(e=o),this.isFirstChunk=!1,this._halted=!1;var i=this._partialLine+e,o=(this._partialLine="",this._handle.parse(i,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=o.meta.cursor,this._finished||(this._partialLine=i.substring(e-this._baseIndex),this._baseIndex=e),o&&o.data&&(this._rowCount+=o.data.length),i=this._finished||this._config.preview&&this._rowCount>=this._config.preview,r)n.postMessage({results:o,workerId:s.WORKER_ID,finished:i});else if(b(this._config.chunk)&&!t){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=o=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),this._completed||!i||!b(this._config.complete)||o&&o.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),i||o&&o.meta.paused||this._nextChunk(),o}this._halted=!0},this._sendError=function(e){b(this._config.error)?this._config.error(e):r&&this._config.error&&n.postMessage({workerId:s.WORKER_ID,error:e,finished:!1})}}function u(e){var t;(e=e||{}).chunkSize||(e.chunkSize=s.RemoteChunkSize),l.call(this,e),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),i||(t.onload=x(this._chunkLoaded,this),t.onerror=x(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var e,n,r=this._config.downloadRequestHeaders;for(n in r)t.setRequestHeader(n,r[n])}this._config.chunkSize&&(e=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+e));try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}i&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){let e;4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null!==(e=(e=t).getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(Error(e))}}function h(e){(e=e||{}).chunkSize||(e.chunkSize=s.LocalChunkSize),l.call(this,e);var t,n,i="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,i?((t=new FileReader).onload=x(this._chunkLoaded,this),t.onerror=x(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,r=(this._config.chunkSize&&(r=Math.min(this._start+this._config.chunkSize,this._input.size),e=n.call(e,this._start,r)),t.readAsText(e,this._config.encoding));i||this._chunkLoaded({target:{result:r}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function c(e){var t;l.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,n;if(!this._finished)return t=(e=this._config.chunkSize)?(n=t.substring(0,e),t.substring(e)):(n=t,""),this._finished=!t,this.parseChunk(n)}}function d(e){l.call(this,e=e||{});var t=[],n=!0,i=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){i&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=x(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=x(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=x(function(){this._streamCleanUp(),i=!0,this._streamData("")},this),this._streamCleanUp=x(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function f(e){var t,n,i,r,o=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,a=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,l=this,u=0,h=0,c=!1,d=!1,f=[],m={data:[],errors:[],meta:{}};function y(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function v(){if(m&&i&&(w("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),i=!1),e.skipEmptyLines&&(m.data=m.data.filter(function(e){return!y(e)})),x()){if(m)if(Array.isArray(m.data[0])){for(var t,n=0;x()&&n<m.data.length;n++)m.data[n].forEach(r);m.data.splice(0,1)}else m.data.forEach(r);function r(t,n){b(e.transformHeader)&&(t=e.transformHeader(t,n)),f.push(t)}}function l(t,n){for(var i=e.header?{}:[],r=0;r<t.length;r++){var s=r,l=t[r],l=((t,n)=>(e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping))?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&((e=>{if(o.test(e)&&-0x20000000000000<(e=parseFloat(e))&&e<0x20000000000000)return 1})(n)?parseFloat(n):a.test(n)?new Date(n):""===n?null:n):n)(s=e.header?r>=f.length?"__parsed_extra":f[r]:s,l=e.transform?e.transform(l,s):l);"__parsed_extra"===s?(i[s]=i[s]||[],i[s].push(l)):i[s]=l}return e.header&&(r>f.length?w("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+r,h+n):r<f.length&&w("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+r,h+n)),i}m&&(e.header||e.dynamicTyping||e.transform)&&(t=1,!m.data.length||Array.isArray(m.data[0])?(m.data=m.data.map(l),t=m.data.length):m.data=l(m.data,0),e.header&&m.meta&&(m.meta.fields=f),h+=t)}function x(){return e.header&&0===f.length}function w(e,t,n,i){e={type:e,code:t,message:n},void 0!==i&&(e.row=i),m.errors.push(e)}b(e.step)&&(r=e.step,e.step=function(t){m=t,x()?v():(v(),0!==m.data.length&&(u+=t.data.length,e.preview&&u>e.preview?n.abort():(m.data=m.data[0],r(m,l))))}),this.parse=function(r,o,a){var l=e.quoteChar||'"',l=(e.newline||(e.newline=this.guessLineEndings(r,l)),i=!1,e.delimiter?b(e.delimiter)&&(e.delimiter=e.delimiter(r),m.meta.delimiter=e.delimiter):((l=((t,n,i,r,o)=>{var a,l,u,h;o=o||[",","	","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var c=0;c<o.length;c++){for(var d,f=o[c],p=0,m=0,v=0,_=(u=void 0,new g({comments:r,delimiter:f,newline:n,preview:10}).parse(t)),x=0;x<_.data.length;x++)i&&y(_.data[x])?v++:(m+=d=_.data[x].length,void 0===u?u=d:0<d&&(p+=Math.abs(d-u),u=d));0<_.data.length&&(m/=_.data.length-v),(void 0===l||p<=l)&&(void 0===h||h<m)&&1.99<m&&(l=p,a=f,h=m)}return{successful:!!(e.delimiter=a),bestDelimiter:a}})(r,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=l.bestDelimiter:(i=!0,e.delimiter=s.DefaultDelimiter),m.meta.delimiter=e.delimiter),_(e));return e.preview&&e.header&&l.preview++,t=r,m=(n=new g(l)).parse(t,o,a),v(),c?{meta:{paused:!0}}:m||{meta:{paused:!1}}},this.paused=function(){return c},this.pause=function(){c=!0,n.abort(),t=b(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){l.streamer._halted?(c=!1,l.streamer.parseChunk(t,!0)):setTimeout(l.resume,3)},this.aborted=function(){return d},this.abort=function(){d=!0,n.abort(),m.meta.aborted=!0,b(e.complete)&&e.complete(m),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576);var t=RegExp(p(t)+"([^]*?)"+p(t),"gm"),n=(e=e.replace(t,"")).split("\r"),t=e.split("\n"),e=1<t.length&&t[0].length<n[0].length;if(1===n.length||e)return"\n";for(var i=0,r=0;r<n.length;r++)"\n"===n[r][0]&&i++;return i>=n.length/2?"\r\n":"\r"}}function p(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(e){var t=(e=e||{}).delimiter,n=e.newline,i=e.comments,r=e.step,o=e.preview,a=e.fastMode,l=null,u=!1,h=null==e.quoteChar?'"':e.quoteChar,c=h;if(void 0!==e.escapeChar&&(c=e.escapeChar),("string"!=typeof t||-1<s.BAD_DELIMITERS.indexOf(t))&&(t=","),i===t)throw Error("Comment character same as delimiter");!0===i?i="#":("string"!=typeof i||-1<s.BAD_DELIMITERS.indexOf(i))&&(i=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var d=0,f=!1;this.parse=function(s,g,m){if("string"!=typeof s)throw Error("Input must be a string");var y=s.length,v=t.length,_=n.length,x=i.length,w=b(r),S=[],k=[],E=[],C=d=0;if(!s)return D();if(a||!1!==a&&-1===s.indexOf(h)){for(var $=s.split(n),L=0;L<$.length;L++){if(E=$[L],d+=E.length,L!==$.length-1)d+=n.length;else if(m)break;if(!i||E.substring(0,x)!==i){if(w){if(S=[],z(E.split(t)),j(),f)return D()}else z(E.split(t));if(o&&o<=L)return S=S.slice(0,o),D(!0)}}return D()}for(var O=s.indexOf(t,d),R=s.indexOf(n,d),T=RegExp(p(c)+p(h),"g"),A=s.indexOf(h,d);;)if(s[d]===h)for(A=d,d++;;){if(-1===(A=s.indexOf(h,A+1)))return m||k.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:S.length,index:d}),M();if(A===y-1)return M(s.substring(d,A).replace(T,h));if(h===c&&s[A+1]===c)A++;else if(h===c||0===A||s[A-1]!==c){-1!==O&&O<A+1&&(O=s.indexOf(t,A+1));var I=N(-1===(R=-1!==R&&R<A+1?s.indexOf(n,A+1):R)?O:Math.min(O,R));if(s.substr(A+1+I,v)===t){E.push(s.substring(d,A).replace(T,h)),s[d=A+1+I+v]!==h&&(A=s.indexOf(h,d)),O=s.indexOf(t,d),R=s.indexOf(n,d);break}if(I=N(R),s.substring(A+1+I,A+1+I+_)===n){if(E.push(s.substring(d,A).replace(T,h)),P(A+1+I+_),O=s.indexOf(t,d),A=s.indexOf(h,d),w&&(j(),f))return D();if(o&&S.length>=o)return D(!0);break}k.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:S.length,index:d}),A++}}else if(i&&0===E.length&&s.substring(d,d+x)===i){if(-1===R)return D();d=R+_,R=s.indexOf(n,d),O=s.indexOf(t,d)}else if(-1!==O&&(O<R||-1===R))E.push(s.substring(d,O)),d=O+v,O=s.indexOf(t,d);else{if(-1===R)break;if(E.push(s.substring(d,R)),P(R+_),w&&(j(),f))return D();if(o&&S.length>=o)return D(!0)}return M();function z(e){S.push(e),C=d}function N(e){return -1!==e&&(e=s.substring(A+1,e))&&""===e.trim()?e.length:0}function M(e){return m||(void 0===e&&(e=s.substring(d)),E.push(e),d=y,z(E),w&&j()),D()}function P(e){d=e,z(E),E=[],R=s.indexOf(n,d)}function D(i){if(e.header&&!g&&S.length&&!u){var r=S[0],o={},a=new Set(r);let t=!1;for(let n=0;n<r.length;n++){let i=r[n];if(o[i=b(e.transformHeader)?e.transformHeader(i,n):i]){let e,s=o[i];for(;e=i+"_"+s,s++,a.has(e););a.add(e),r[n]=e,o[i]++,t=!0,(l=null===l?{}:l)[e]=i}else o[i]=1,r[n]=i;a.add(i)}t&&console.warn("Duplicate headers found and renamed."),u=!0}return{data:S,errors:k,meta:{delimiter:t,linebreak:n,aborted:f,truncated:!!i,cursor:C+(g||0),renamedHeaders:l}}}function j(){r(D()),S=[],k=[]}},this.abort=function(){f=!0},this.getCharIndex=function(){return d}}function m(e){var t=e.data,n=o[t.workerId],i=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var r={abort:function(){i=!0,y(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(b(n.userStep)){for(var a=0;a<t.results.data.length&&(n.userStep({data:t.results.data[a],errors:t.results.errors,meta:t.results.meta},r),!i);a++);delete t.results}else b(n.userChunk)&&(n.userChunk(t.results,r,t.file),delete t.results)}t.finished&&!i&&y(t.workerId,t.results)}function y(e,t){var n=o[e];b(n.userComplete)&&n.userComplete(t),n.terminate(),delete o[e]}function v(){throw Error("Not implemented.")}function _(e){if("object"!=typeof e||null===e)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=_(e[t]);return n}function x(e,t){return function(){e.apply(t,arguments)}}function b(e){return"function"==typeof e}return s.parse=function(t,i){var r,l,f,p=(i=i||{}).dynamicTyping||!1;if(b(p)&&(i.dynamicTypingFunction=p,p={}),i.dynamicTyping=p,i.transform=!!b(i.transform)&&i.transform,!i.worker||!s.WORKERS_SUPPORTED){let e;return p=null,s.NODE_STREAM_INPUT,"string"==typeof t?(t=65279!==(e=t).charCodeAt(0)?e:e.slice(1),p=new(i.download?u:c)(i)):!0===t.readable&&b(t.read)&&b(t.on)?p=new d(i):(n.File&&t instanceof File||t instanceof Object)&&(p=new h(i)),p.stream(t)}(p=!!s.WORKERS_SUPPORTED&&(l=n.URL||n.webkitURL||null,f=e.toString(),r=s.BLOB_URL||(s.BLOB_URL=l.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",f,")();"],{type:"text/javascript"}))),(r=new n.Worker(r)).onmessage=m,r.id=a++,o[r.id]=r)).userStep=i.step,p.userChunk=i.chunk,p.userComplete=i.complete,p.userError=i.error,i.step=b(i.step),i.chunk=b(i.chunk),i.complete=b(i.complete),i.error=b(i.error),delete i.worker,p.postMessage({input:t,config:i,workerId:p.id})},s.unparse=function(e,t){var n=!1,i=!0,r=",",o="\r\n",a='"',l=a+a,u=!1,h=null,c=!1,d=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||s.BAD_DELIMITERS.filter(function(e){return -1!==t.delimiter.indexOf(e)}).length||(r=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(u=t.skipEmptyLines),"string"==typeof t.newline&&(o=t.newline),"string"==typeof t.quoteChar&&(a=t.quoteChar),"boolean"==typeof t.header&&(i=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw Error("Option columns is empty");h=t.columns}void 0!==t.escapeChar&&(l=t.escapeChar+a),t.escapeFormulae instanceof RegExp?c=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(c=/^[=+\-@\t\r].*$/)}})(),RegExp(p(a),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,u);if("object"==typeof e[0])return f(h||Object.keys(e[0]),e,u)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||h),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],u);throw Error("Unable to serialize unrecognized input");function f(e,t,n){var a="",s=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),l=!Array.isArray(t[0]);if(s&&i){for(var u=0;u<e.length;u++)0<u&&(a+=r),a+=g(e[u],u);0<t.length&&(a+=o)}for(var h=0;h<t.length;h++){var c=(s?e:t[h]).length,d=!1,f=s?0===Object.keys(t[h]).length:0===t[h].length;if(n&&!s&&(d="greedy"===n?""===t[h].join("").trim():1===t[h].length&&0===t[h][0].length),"greedy"===n&&s){for(var p=[],m=0;m<c;m++){var y=l?e[m]:m;p.push(t[h][y])}d=""===p.join("").trim()}if(!d){for(var v=0;v<c;v++){0<v&&!f&&(a+=r);var _=s&&l?e[v]:v;a+=g(t[h][_],v)}h<t.length-1&&(!n||0<c&&!f)&&(a+=o)}}return a}function g(e,t){var i,o;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(o=!1,c&&"string"==typeof e&&c.test(e)&&(e="'"+e,o=!0),i=e.toString().replace(d,l),(o=o||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||((e,t)=>{for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1})(i,s.BAD_DELIMITERS)||-1<i.indexOf(r)||" "===i.charAt(0)||" "===i.charAt(i.length-1))?a+i+a:i)}},s.RECORD_SEP="\x1e",s.UNIT_SEP="\x1f",s.BYTE_ORDER_MARK="\uFEFF",s.BAD_DELIMITERS=["\r","\n",'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!i&&!!n.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=0xa00000,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=g,s.ParserHandle=f,s.NetworkStreamer=u,s.FileStreamer=h,s.StringStreamer=c,s.ReadableStreamStreamer=d,n.jQuery&&((t=n.jQuery).fn.parse=function(e){var i=e.config||{},r=[];return this.each(function(e){if(!("INPUT"===t(this).prop("tagName").toUpperCase()&&"file"===t(this).attr("type").toLowerCase()&&n.FileReader)||!this.files||0===this.files.length)return!0;for(var o=0;o<this.files.length;o++)r.push({file:this.files[o],inputElem:this,instanceConfig:t.extend({},i)})}),o(),this;function o(){if(0===r.length)b(e.complete)&&e.complete();else{var n,i,o,l=r[0];if(b(e.before)){var u=e.before(l.file,l.inputElem);if("object"==typeof u){if("abort"===u.action)return n=l.file,i=l.inputElem,o=u.reason,void(b(e.error)&&e.error({name:"AbortError"},n,i,o));if("skip"===u.action)return void a();"object"==typeof u.config&&(l.instanceConfig=t.extend(l.instanceConfig,u.config))}else if("skip"===u)return void a()}var h=l.instanceConfig.complete;l.instanceConfig.complete=function(e){b(h)&&h(e,l.file,l.inputElem),a()},s.parse(l.file,l.instanceConfig)}}function a(){r.splice(0,1),o()}}),r&&(n.onmessage=function(e){e=e.data,void 0===s.WORKER_ID&&e&&(s.WORKER_ID=e.workerId),"string"==typeof e.input?n.postMessage({workerId:s.WORKER_ID,results:s.parse(e.input,e.config),finished:!0}):(n.File&&e.input instanceof File||e.input instanceof Object)&&(e=s.parse(e.input,e.config))&&n.postMessage({workerId:s.WORKER_ID,results:e,finished:!0})}),(u.prototype=Object.create(l.prototype)).constructor=u,(h.prototype=Object.create(l.prototype)).constructor=h,(c.prototype=Object.create(c.prototype)).constructor=c,(d.prototype=Object.create(l.prototype)).constructor=d,s},"function"==typeof define&&define.amd?define([],tO):e$=tO();var eN={value:()=>{}};function eM(){for(var e,t=0,n=arguments.length,i={};t<n;++t){if(!(e=arguments[t]+"")||e in i||/[\s.]/.test(e))throw Error("illegal type: "+e);i[e]=[]}return new eP(i)}function eP(e){this._=e}function eD(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=eN,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}function ej(){}function eB(e){return null==e?ej:function(){return this.querySelector(e)}}function eF(){return[]}function eV(e){return null==e?eF:function(){return this.querySelectorAll(e)}}function eH(e){return function(){return this.matches(e)}}function eU(e){return function(t){return t.matches(e)}}eP.prototype=eM.prototype={constructor:eP,on:function(e,t){var n,i=this._,r=(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!i.hasOwnProperty(e))throw Error("unknown type: "+e);return{type:e,name:t}}),o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((n=(e=r[o]).type)&&(n=function(e,t){for(var n,i=0,r=e.length;i<r;++i)if((n=e[i]).name===t)return n.value}(i[n],e.name)))return n;return}if(null!=t&&"function"!=typeof t)throw Error("invalid callback: "+t);for(;++o<a;)if(n=(e=r[o]).type)i[n]=eD(i[n],e.name,t);else if(null==t)for(n in i)i[n]=eD(i[n],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new eP(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,i,r=Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(i=this._[e],o=0,n=i.length;o<n;++o)i[o].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};var eq=Array.prototype.find;function eK(){return this.firstElementChild}var eG=Array.prototype.filter;function eW(){return Array.from(this.children)}function eY(e){return Array(e.length)}function eX(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function eJ(e,t,n,i,r,o){for(var a,s=0,l=t.length,u=o.length;s<u;++s)(a=t[s])?(a.__data__=o[s],i[s]=a):n[s]=new eX(e,o[s]);for(;s<l;++s)(a=t[s])&&(r[s]=a)}function eQ(e,t,n,i,r,o,a){var s,l,u,h=new Map,c=t.length,d=o.length,f=Array(c);for(s=0;s<c;++s)(l=t[s])&&(f[s]=u=a.call(l,l.__data__,s,t)+"",h.has(u)?r[s]=l:h.set(u,l));for(s=0;s<d;++s)u=a.call(e,o[s],s,o)+"",(l=h.get(u))?(i[s]=l,l.__data__=o[s],h.delete(u)):n[s]=new eX(e,o[s]);for(s=0;s<c;++s)(l=t[s])&&h.get(f[s])===l&&(r[s]=l)}function eZ(e){return e.__data__}function e0(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}eX.prototype={constructor:eX,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var e1="http://www.w3.org/1999/xhtml",e2={svg:"http://www.w3.org/2000/svg",xhtml:e1,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function e5(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),e2.hasOwnProperty(t)?{space:e2[t],local:e}:e}function e3(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function e8(e,t){return e.style.getPropertyValue(t)||e3(e).getComputedStyle(e,null).getPropertyValue(t)}function e9(e){return e.trim().split(/^|\s+/)}function e4(e){return e.classList||new e6(e)}function e6(e){this._node=e,this._names=e9(e.getAttribute("class")||"")}function e7(e,t){for(var n=e4(e),i=-1,r=t.length;++i<r;)n.add(t[i])}function te(e,t){for(var n=e4(e),i=-1,r=t.length;++i<r;)n.remove(t[i])}function tt(){this.textContent=""}function tn(){this.innerHTML=""}function ti(){this.nextSibling&&this.parentNode.appendChild(this)}function tr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function to(e){var t=e5(e);return(t.local?function(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===e1&&t.documentElement.namespaceURI===e1?t.createElement(e):t.createElementNS(n,e)}})(t)}function ta(){return null}function ts(){var e=this.parentNode;e&&e.removeChild(this)}function tl(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function tu(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function th(e){return function(){var t=this.__on;if(t){for(var n,i=0,r=-1,o=t.length;i<o;++i)(n=t[i],e.type&&n.type!==e.type||n.name!==e.name)?t[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?t.length=r:delete this.__on}}}function tc(e,t,n){return function(){var i,r=this.__on,o=function(e){t.call(this,e,this.__data__)};if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function td(e,t,n){var i=e3(e),r=i.CustomEvent;"function"==typeof r?r=new r(t,n):(r=i.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}e6.prototype={add:function(e){0>this._names.indexOf(e)&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var tf=[null];function tp(e,t){this._groups=e,this._parents=t}function tg(){return new tp([[document.documentElement]],tf)}function tm(e){return"string"==typeof e?new tp([[document.querySelector(e)]],[document.documentElement]):new tp([[e]],tf)}tp.prototype=tg.prototype={constructor:tp,select:function(e){"function"!=typeof e&&(e=eB(e));for(var t=this._groups,n=t.length,i=Array(n),r=0;r<n;++r)for(var o,a,s=t[r],l=s.length,u=i[r]=Array(l),h=0;h<l;++h)(o=s[h])&&(a=e.call(o,o.__data__,h,s))&&("__data__"in o&&(a.__data__=o.__data__),u[h]=a);return new tp(i,this._parents)},selectAll:function(e){if("function"==typeof e){var t;t=e,e=function(){var e;return e=t.apply(this,arguments),null==e?[]:Array.isArray(e)?e:Array.from(e)}}else e=eV(e);for(var n=this._groups,i=n.length,r=[],o=[],a=0;a<i;++a)for(var s,l=n[a],u=l.length,h=0;h<u;++h)(s=l[h])&&(r.push(e.call(s,s.__data__,h,l)),o.push(s));return new tp(r,o)},selectChild:function(e){var t;return this.select(null==e?eK:(t="function"==typeof e?e:eU(e),function(){return eq.call(this.children,t)}))},selectChildren:function(e){var t;return this.selectAll(null==e?eW:(t="function"==typeof e?e:eU(e),function(){return eG.call(this.children,t)}))},filter:function(e){"function"!=typeof e&&(e=eH(e));for(var t=this._groups,n=t.length,i=Array(n),r=0;r<n;++r)for(var o,a=t[r],s=a.length,l=i[r]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&l.push(o);return new tp(i,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,eZ);var n=t?eQ:eJ,i=this._parents,r=this._groups;"function"!=typeof e&&(v=e,e=function(){return v});for(var o=r.length,a=Array(o),s=Array(o),l=Array(o),u=0;u<o;++u){var h=i[u],c=r[u],d=c.length,f="object"==typeof(y=e.call(h,h&&h.__data__,u,i))&&"length"in y?y:Array.from(y),p=f.length,g=s[u]=Array(p),m=a[u]=Array(p);n(h,c,g,m,l[u]=Array(d),f,t);for(var y,v,_,x,b=0,w=0;b<p;++b)if(_=g[b]){for(b>=w&&(w=b+1);!(x=m[w])&&++w<p;);_._next=x||null}}return(a=new tp(a,i))._enter=s,a._exit=l,a},enter:function(){return new tp(this._enter||this._groups.map(eY),this._parents)},exit:function(){return new tp(this._exit||this._groups.map(eY),this._parents)},join:function(e,t,n){var i=this.enter(),r=this,o=this.exit();return"function"==typeof e?(i=e(i))&&(i=i.selection()):i=i.append(e+""),null!=t&&(r=t(r))&&(r=r.selection()),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,i=t._groups,r=n.length,o=i.length,a=Math.min(r,o),s=Array(r),l=0;l<a;++l)for(var u,h=n[l],c=i[l],d=h.length,f=s[l]=Array(d),p=0;p<d;++p)(u=h[p]||c[p])&&(f[p]=u);for(;l<r;++l)s[l]=n[l];return new tp(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var i,r=e[t],o=r.length-1,a=r[o];--o>=0;)(i=r[o])&&(a&&4^i.compareDocumentPosition(a)&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=e0);for(var n=this._groups,i=n.length,r=Array(i),o=0;o<i;++o){for(var a,s=n[o],l=s.length,u=r[o]=Array(l),h=0;h<l;++h)(a=s[h])&&(u[h]=a);u.sort(t)}return new tp(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},size:function(){let e=0;for(let t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,i=t.length;n<i;++n)for(var r,o=t[n],a=0,s=o.length;a<s;++a)(r=o[a])&&e.call(r,r.__data__,a,o);return this},attr:function(e,t){var n=e5(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==t?n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}}:"function"==typeof t?n.local?function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}:function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}:n.local?function(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}:function(e,t){return function(){this.setAttribute(e,t)}})(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?function(e){return function(){this.style.removeProperty(e)}}:"function"==typeof t?function(e,t,n){return function(){var i=t.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}:function(e,t,n){return function(){this.style.setProperty(e,t,n)}})(e,t,null==n?"":n)):e8(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?function(e){return function(){delete this[e]}}:"function"==typeof t?function(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}:function(e,t){return function(){this[e]=t}})(e,t)):this.node()[e]},classed:function(e,t){var n=e9(e+"");if(arguments.length<2){for(var i=e4(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof t?function(e,t){return function(){(t.apply(this,arguments)?e7:te)(this,e)}}:t?function(e){return function(){e7(this,e)}}:function(e){return function(){te(this,e)}})(n,t))},text:function(e){return arguments.length?this.each(null==e?tt:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(e){return function(){this.textContent=e}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?tn:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(e){return function(){this.innerHTML=e}})(e)):this.node().innerHTML},raise:function(){return this.each(ti)},lower:function(){return this.each(tr)},append:function(e){var t="function"==typeof e?e:to(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:to(e),i=null==t?ta:"function"==typeof t?t:eB(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(ts)},clone:function(e){return this.select(e?tu:tl)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var i,r,o=(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}),a=o.length;if(arguments.length<2){var s=this.node().__on;if(s){for(var l,u=0,h=s.length;u<h;++u)for(i=0,l=s[u];i<a;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value}return}for(i=0,s=t?tc:th;i<a;++i)this.each(s(o[i],t,n));return this},dispatch:function(e,t){return this.each(("function"==typeof t?function(e,t){return function(){return td(this,e,t.apply(this,arguments))}}:function(e,t){return function(){return td(this,e,t)}})(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i,r=e[t],o=0,a=r.length;o<a;++o)(i=r[o])&&(yield i)}};const ty={capture:!0,passive:!1};function tv(e){e.preventDefault(),e.stopImmediatePropagation()}var t_=(a("bYoiY"),a("bYoiY"));function tx(e,t,n,i,r){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*i+a*r)/6}var tb=e=>()=>e;function tw(e,t){var n=t-e;return n?function(t){return e+t*n}:tb(isNaN(e)?t:e)}var tS=function e(t){var n,i=1==(n=+t)?tw:function(e,t){var i,r,o;return t-e?(i=e,r=t,i=Math.pow(i,o=n),r=Math.pow(r,o)-i,o=1/o,function(e){return Math.pow(i+e*r,o)}):tb(isNaN(e)?t:e)};function r(e,t){var n=i((e=(0,t_.rgb)(e)).r,(t=(0,t_.rgb)(t)).r),r=i(e.g,t.g),o=i(e.b,t.b),a=tw(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=r(t),e.b=o(t),e.opacity=a(t),e+""}}return r.gamma=e,r}(1);function tk(e){return function(t){var n,i,r=t.length,o=Array(r),a=Array(r),s=Array(r);for(n=0;n<r;++n)i=(0,t_.rgb)(t[n]),o[n]=i.r||0,a[n]=i.g||0,s[n]=i.b||0;return o=e(o),a=e(a),s=e(s),i.opacity=1,function(e){return i.r=o(e),i.g=a(e),i.b=s(e),i+""}}}function tE(e,t){return e*=1,t*=1,function(n){return e*(1-n)+t*n}}tk(function(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],o=e[i+1],a=i>0?e[i-1]:2*r-o,s=i<t-1?e[i+2]:2*o-r;return tx((n-i/t)*t,a,r,o,s)}}),tk(function(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],o=e[i%t],a=e[(i+1)%t],s=e[(i+2)%t];return tx((n-i/t)*t,r,o,a,s)}});var tC=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,t$=RegExp(tC.source,"g");function tL(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}var tO,tR,tT,tA=0,tI=0,tz=0,tN=0,tM=0,tP=0,tD="object"==typeof performance&&performance.now?performance:Date,tj="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function tB(){return tM||(tj(tF),tM=tD.now()+tP)}function tF(){tM=0}function tV(){this._call=this._time=this._next=null}function tH(e,t,n){var i=new tV;return i.restart(e,t,n),i}function tU(){tM=(tN=tD.now())+tP,tA=tI=0;try{tB(),++tA;for(var e,t=tR;t;)(e=tM-t._time)>=0&&t._call.call(void 0,e),t=t._next;--tA}finally{tA=0,function(){for(var e,t,n=tR,i=1/0;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:tR=t);tT=e,tK(i)}(),tM=0}}function tq(){var e=tD.now(),t=e-tN;t>1e3&&(tP-=t,tN=e)}function tK(e){!tA&&(tI&&(tI=clearTimeout(tI)),e-tM>24?(e<1/0&&(tI=setTimeout(tU,e-tD.now()-tP)),tz&&(tz=clearInterval(tz))):(tz||(tN=tD.now(),tz=setInterval(tq,1e3)),tA=1,tj(tU)))}function tG(e,t,n){var i=new tV;return t=null==t?0:+t,i.restart(n=>{i.stop(),e(n+t)},t,n),i}tV.prototype=tH.prototype={constructor:tV,restart:function(e,t,n){if("function"!=typeof e)throw TypeError("callback is not a function");n=(null==n?tB():+n)+(null==t?0:+t),this._next||tT===this||(tT?tT._next=this:tR=this,tT=this),this._call=e,this._time=n,tK()},stop:function(){this._call&&(this._call=null,this._time=1/0,tK())}};var tW=eM("start","end","cancel","interrupt"),tY=[];function tX(e,t,n,i,r,o){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var i,r=e.__transition;function o(l){var u,h,c,d;if(1!==n.state)return s();for(u in r)if((d=r[u]).name===n.name){if(3===d.state)return tG(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete r[u]):+u<t&&(d.state=6,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete r[u])}if(tG(function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(u=0,n.state=3,i=Array(c=n.tween.length),h=-1;u<c;++u)(d=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++h]=d);i.length=h+1}}function a(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=i.length;++o<a;)i[o].call(e,r);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var i in n.state=6,n.timer.stop(),delete r[t],r)return;delete e.__transition}r[t]=n,n.timer=tH(function(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)},0,n.time)}(e,n,{name:t,index:i,group:r,on:tW,tween:tY,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function tJ(e,t){var n=tZ(e,t);if(n.state>0)throw Error("too late; already scheduled");return n}function tQ(e,t){var n=tZ(e,t);if(n.state>3)throw Error("too late; already running");return n}function tZ(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw Error("transition not found");return n}function t0(e,t){var n,i,r,o=e.__transition,a=!0;if(o){for(r in t=null==t?null:t+"",o){if((n=o[r]).name!==t){a=!1;continue}i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[r]}a&&delete e.__transition}}var t1=180/Math.PI,t2={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function t5(e,t,n,i,r,o){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,l/=s),e*i<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*t1,skewX:Math.atan(l)*t1,scaleX:a,scaleY:s}}function t3(e,t,n,i){function r(e){return e.length?e.pop()+" ":""}return function(o,a){var s,l,u,h,c=[],d=[];return o=e(o),a=e(a),!function(e,i,r,o,a,s){if(e!==r||i!==o){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:tE(e,r)},{i:l-2,x:tE(i,o)})}else(r||o)&&a.push("translate("+r+t+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,c,d),s=o.rotate,s!==(l=a.rotate)?(s-l>180?l+=360:l-s>180&&(s+=360),d.push({i:c.push(r(c)+"rotate(",null,i)-2,x:tE(s,l)})):l&&c.push(r(c)+"rotate("+l+i),u=o.skewX,u!==(h=a.skewX)?d.push({i:c.push(r(c)+"skewX(",null,i)-2,x:tE(u,h)}):h&&c.push(r(c)+"skewX("+h+i),!function(e,t,n,i,o,a){if(e!==n||t!==i){var s=o.push(r(o)+"scale(",null,",",null,")");a.push({i:s-4,x:tE(e,n)},{i:s-2,x:tE(t,i)})}else(1!==n||1!==i)&&o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,c,d),o=a=null,function(e){for(var t,n=-1,i=d.length;++n<i;)c[(t=d[n]).i]=t.x(e);return c.join("")}}}var t8=t3(function(e){let t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?t2:t5(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),t9=t3(function(e){return null==e?t2:(n||(n=document.createElementNS("http://www.w3.org/2000/svg","g")),n.setAttribute("transform",e),e=n.transform.baseVal.consolidate())?t5((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):t2},", ",")",")");function t4(e,t,n){var i=e._id;return e.each(function(){var e=tQ(this,i);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return tZ(e,i).value[t]}}var t_=a("bYoiY");function t6(e,t){var n;return("number"==typeof t?tE:t instanceof(0,t_.default)?tS:(n=(0,t_.default)(t))?(t=n,tS):function(e,t){var n,i,r,o,a,s=tC.lastIndex=t$.lastIndex=0,l=-1,u=[],h=[];for(e+="",t+="";(r=tC.exec(e))&&(o=t$.exec(t));)(a=o.index)>s&&(a=t.slice(s,a),u[l]?u[l]+=a:u[++l]=a),(r=r[0])===(o=o[0])?u[l]?u[l]+=o:u[++l]=o:(u[++l]=null,h.push({i:l,x:tE(r,o)})),s=t$.lastIndex;return s<t.length&&(a=t.slice(s),u[l]?u[l]+=a:u[++l]=a),u.length<2?h[0]?(n=h[0].x,function(e){return n(e)+""}):(i=t,function(){return i}):(t=h.length,function(e){for(var n,i=0;i<t;++i)u[(n=h[i]).i]=n.x(e);return u.join("")})})(e,t)}var t7=tg.prototype.constructor;function ne(e){return function(){this.style.removeProperty(e)}}var nt=0;function nn(e,t,n,i){this._groups=e,this._parents=t,this._name=n,this._id=i}var ni=tg.prototype;nn.prototype=(function(e){return tg().transition(e)}).prototype={constructor:nn,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=eB(e));for(var i=this._groups,r=i.length,o=Array(r),a=0;a<r;++a)for(var s,l,u=i[a],h=u.length,c=o[a]=Array(h),d=0;d<h;++d)(s=u[d])&&(l=e.call(s,s.__data__,d,u))&&("__data__"in s&&(l.__data__=s.__data__),c[d]=l,tX(c[d],t,n,d,c,tZ(s,n)));return new nn(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=eV(e));for(var i=this._groups,r=i.length,o=[],a=[],s=0;s<r;++s)for(var l,u=i[s],h=u.length,c=0;c<h;++c)if(l=u[c]){for(var d,f=e.call(l,l.__data__,c,u),p=tZ(l,n),g=0,m=f.length;g<m;++g)(d=f[g])&&tX(d,t,n,g,f,p);o.push(f),a.push(l)}return new nn(o,a,t,n)},selectChild:ni.selectChild,selectChildren:ni.selectChildren,filter:function(e){"function"!=typeof e&&(e=eH(e));for(var t=this._groups,n=t.length,i=Array(n),r=0;r<n;++r)for(var o,a=t[r],s=a.length,l=i[r]=[],u=0;u<s;++u)(o=a[u])&&e.call(o,o.__data__,u,a)&&l.push(o);return new nn(i,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw Error();for(var t=this._groups,n=e._groups,i=t.length,r=n.length,o=Math.min(i,r),a=Array(i),s=0;s<o;++s)for(var l,u=t[s],h=n[s],c=u.length,d=a[s]=Array(c),f=0;f<c;++f)(l=u[f]||h[f])&&(d[f]=l);for(;s<i;++s)a[s]=t[s];return new nn(a,this._parents,this._name,this._id)},selection:function(){return new t7(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=++nt,i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],l=s.length,u=0;u<l;++u)if(a=s[u]){var h=tZ(a,t);tX(a,e,n,u,s,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new nn(i,this._parents,e,n)},call:ni.call,nodes:ni.nodes,node:ni.node,size:ni.size,empty:ni.empty,each:ni.each,on:function(e,t){var n,i,r,o,a,s,l=this._id;return arguments.length<2?tZ(this.node(),l).on.on(e):this.each((n=l,i=e,r=t,s=(i+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})?tJ:tQ,function(){var e=s(this,n),t=e.on;t!==o&&(a=(o=t).copy()).on(i,r),e.on=a}))},attr:function(e,t){var n=e5(e),i="transform"===n?t9:t6;return this.attrTween(e,"function"==typeof t?(n.local?function(e,t,n){var i,r,o;return function(){var a,s,l=n(this);return null==l?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:a===i&&s===r?o:(r=s,o=t(i=a,l))}}:function(e,t,n){var i,r,o;return function(){var a,s,l=n(this);return null==l?void this.removeAttribute(e):(a=this.getAttribute(e))===(s=l+"")?null:a===i&&s===r?o:(r=s,o=t(i=a,l))}})(n,i,t4(this,"attr."+e,t)):null==t?(n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}})(n):(n.local?function(e,t,n){var i,r,o=n+"";return function(){var a=this.getAttributeNS(e.space,e.local);return a===o?null:a===i?r:r=t(i=a,n)}}:function(e,t,n){var i,r,o=n+"";return function(){var a=this.getAttribute(e);return a===o?null:a===i?r:r=t(i=a,n)}})(n,i,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw Error();var i=e5(e);return this.tween(n,(i.local?function(e,t){var n,i;function r(){var r=t.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t){this.setAttributeNS(e.space,e.local,r.call(this,t))}),n}return r._value=t,r}:function(e,t){var n,i;function r(){var r=t.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t){this.setAttribute(e,r.call(this,t))}),n}return r._value=t,r})(i,t))},style:function(e,t,n){var i,r,o,a,s,l,u,h,c,d,f,p,g,m,y,v,_,x,b,w,S,k="transform"==(e+="")?t8:t6;return null==t?this.styleTween(e,(i=e,function(){var e=e8(this,i),t=(this.style.removeProperty(i),e8(this,i));return e===t?null:e===r&&t===o?a:a=k(r=e,o=t)})).on("end.style."+e,ne(e)):"function"==typeof t?this.styleTween(e,(s=e,l=t4(this,"style."+e,t),function(){var e=e8(this,s),t=l(this),n=t+"";return null==t&&(this.style.removeProperty(s),n=t=e8(this,s)),e===n?null:e===u&&n===h?c:(h=n,c=k(u=e,t))})).each((d=this._id,_="end."+(v="style."+(f=e)),function(){var e=tQ(this,d),t=e.on,n=null==e.value[v]?y||(y=ne(f)):void 0;(t!==p||m!==n)&&(g=(p=t).copy()).on(_,m=n),e.on=g})):this.styleTween(e,(x=e,S=t+"",function(){var e=e8(this,x);return e===S?null:e===b?w:w=k(b=e,t)}),n).on("end.style."+e,null)},styleTween:function(e,t,n){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==t)return this.tween(i,null);if("function"!=typeof t)throw Error();return this.tween(i,function(e,t,n){var i,r;function o(){var o=t.apply(this,arguments);return o!==r&&(i=(r=o)&&function(t){this.style.setProperty(e,o.call(this,t),n)}),i}return o._value=t,o}(e,t,null==n?"":n))},text:function(e){var t,n;return this.tween("text","function"==typeof e?(t=t4(this,"text",e),function(){var e=t(this);this.textContent=null==e?"":e}):(n=null==e?"":e+"",function(){this.textContent=n}))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw Error();return this.tween(t,function(e){var t,n;function i(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&function(e){this.textContent=i.call(this,e)}),t}return i._value=e,i}(e))},remove:function(){var e;return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var i,r=tZ(this.node(),n).tween,o=0,a=r.length;o<a;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((null==t?function(e,t){var n,i;return function(){var r=tQ(this,e),o=r.tween;if(o!==n){i=n=o;for(var a=0,s=i.length;a<s;++a)if(i[a].name===t){(i=i.slice()).splice(a,1);break}}r.tween=i}}:function(e,t,n){var i,r;if("function"!=typeof n)throw Error();return function(){var o=tQ(this,e),a=o.tween;if(a!==i){r=(i=a).slice();for(var s={name:t,value:n},l=0,u=r.length;l<u;++l)if(r[l].name===t){r[l]=s;break}l===u&&r.push(s)}o.tween=r}})(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){tJ(this,e).delay=+t.apply(this,arguments)}}:function(e,t){return t*=1,function(){tJ(this,e).delay=t}})(t,e)):tZ(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){tQ(this,e).duration=+t.apply(this,arguments)}}:function(e,t){return t*=1,function(){tQ(this,e).duration=t}})(t,e)):tZ(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw Error();return function(){tQ(this,e).ease=t}}(t,e)):tZ(this.node(),t).ease},easeVarying:function(e){var t;if("function"!=typeof e)throw Error();return this.each((t=this._id,function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw Error();tQ(this,t).ease=n}))},end:function(){var e,t,n=this,i=n._id,r=n.size();return new Promise(function(o,a){var s={value:a},l={value:function(){0==--r&&o()}};n.each(function(){var n=tQ(this,i),r=n.on;r!==e&&((t=(e=r).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t}),0===r&&o()})},[Symbol.iterator]:ni[Symbol.iterator]};var nr={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};tg.prototype.interrupt=function(e){return this.each(function(){t0(this,e)})},tg.prototype.transition=function(e){var t,n;e instanceof nn?(t=e._id,e=e._name):(t=++nt,(n=nr).time=tB(),e=null==e?null:e+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],l=s.length,u=0;u<l;++u)(a=s[u])&&tX(a,e,t,u,s,n||function(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw Error(`transition ${t} not found`);return n}(a,t));return new nn(i,this._parents,e,t)};const{abs:no,max:na,min:ns}=Math;function nl(e){return{type:e}}function nu(e){var t=0,n=e.children,i=n&&n.length;if(i)for(;--i>=0;)t+=n[i].value;else t=1;e.value=t}function nh(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=nd)):void 0===t&&(t=nc);for(var n,i,r,o,a,s=new ng(e),l=[s];n=l.pop();)if((r=t(n.data))&&(a=(r=Array.from(r)).length))for(n.children=r,o=a-1;o>=0;--o)l.push(i=r[o]=new ng(r[o])),i.parent=n,i.depth=n.depth+1;return s.eachBefore(np)}function nc(e){return e.children}function nd(e){return Array.isArray(e)?e[1]:null}function nf(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function np(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function ng(e){this.data=e,this.depth=this.height=0,this.parent=null}function nm(e,t){return e.parent===t.parent?1:2}function ny(e){var t=e.children;return t?t[0]:e.t}function nv(e){var t=e.children;return t?t[t.length-1]:e.t}function n_(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function nx(){var e=nm,t=1,n=1,i=null;function r(r){var l=function(e){for(var t,n,i,r,o,a=new n_(e,0),s=[a];t=s.pop();)if(i=t._.children)for(t.children=Array(o=i.length),r=o-1;r>=0;--r)s.push(n=t.children[r]=new n_(i[r],r)),n.parent=t;return(a.parent=new n_(null,0)).children=[a],a}(r);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(a),i)r.eachBefore(s);else{var u=r,h=r,c=r;r.eachBefore(function(e){e.x<u.x&&(u=e),e.x>h.x&&(h=e),e.depth>c.depth&&(c=e)});var d=u===h?1:e(u,h)/2,f=d-u.x,p=t/(h.x+d+f),g=n/(c.depth||1);r.eachBefore(function(e){e.x=(e.x+f)*p,e.y=e.depth*g})}return r}function o(t){var n=t.children,i=t.parent.children,r=t.i?i[t.i-1]:null;if(n){!function(e){for(var t,n=0,i=0,r=e.children,o=r.length;--o>=0;)t=r[o],t.z+=n,t.m+=n,n+=t.s+(i+=t.c)}(t);var o=(n[0].z+n[n.length-1].z)/2;r?(t.z=r.z+e(t._,r._),t.m=t.z-o):t.z=o}else r&&(t.z=r.z+e(t._,r._));t.parent.A=function(t,n,i){if(n){for(var r,o,a,s=t,l=t,u=n,h=s.parent.children[0],c=s.m,d=l.m,f=u.m,p=h.m;u=nv(u),s=ny(s),u&&s;)h=ny(h),(l=nv(l)).a=t,(a=u.z+f-s.z-c+e(u._,s._))>0&&(!function(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}((r=u,o=i,r.a.parent===t.parent?r.a:o),t,a),c+=a,d+=a),f+=u.m,c+=s.m,p+=h.m,d+=l.m;u&&!nv(l)&&(l.t=u,l.m+=f-d),s&&!ny(h)&&(h.t=s,h.m+=c-p,i=t)}return i}(t,r,t.parent.A||i[0])}function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function s(e){e.x*=t,e.y=e.depth*n}return r.separation=function(t){return arguments.length?(e=t,r):e},r.size=function(e){return arguments.length?(i=!1,t=+e[0],n=+e[1],r):i?null:[t,n]},r.nodeSize=function(e){return arguments.length?(i=!0,t=+e[0],n=+e[1],r):i?[t,n]:null},r}["w","e"].map(nl),["n","s"].map(nl),["n","w","e","s","nw","ne","sw","se"].map(nl),ng.prototype=nh.prototype={constructor:ng,count:function(){return this.eachAfter(nu)},each:function(e,t){let n=-1;for(let i of this)e.call(t,i,++n,this);return this},eachAfter:function(e,t){for(var n,i,r,o=this,a=[o],s=[],l=-1;o=a.pop();)if(s.push(o),n=o.children)for(i=0,r=n.length;i<r;++i)a.push(n[i]);for(;o=s.pop();)e.call(t,o,++l,this);return this},eachBefore:function(e,t){for(var n,i,r=this,o=[r],a=-1;r=o.pop();)if(e.call(t,r,++a,this),n=r.children)for(i=n.length-1;i>=0;--i)o.push(n[i]);return this},find:function(e,t){let n=-1;for(let i of this)if(e.call(t,i,++n,this))return i},sum:function(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}(t,e),i=[t];t!==n;)i.push(t=t.parent);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function(){return nh(this).eachBefore(nf)},[Symbol.iterator]:function*(){var e,t,n,i,r=this,o=[r];do for(e=o.reverse(),o=[];r=e.pop();)if(yield r,t=r.children)for(n=0,i=t.length;n<i;++n)o.push(t[n]);while(o.length)}},n_.prototype=Object.create(ng.prototype);class nb extends Map{constructor(e,t=nS){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(let[t,n]of e)this.set(t,n)}get(e){return super.get(nw(this,e))}has(e){return super.has(nw(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},n){let i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},n){let i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}(this,e))}}function nw({_intern:e,_key:t},n){let i=t(n);return e.has(i)?e.get(i):n}function nS(e){return null!==e&&"object"==typeof e?e.valueOf():e}function nk(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}const nE=Symbol("implicit");var nC=function(e){for(var t=e.length/6|0,n=Array(t),i=0;i<t;)n[i]="#"+e.slice(6*i,6*++i);return n}("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function n$(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function nL(e){this._context=e}function nO(e){return new nL(e)}function nR(e,t){this._context=e,this._t=t}function nT(e){return new nR(e,1)}nL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:n$(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e*=1,t*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:n$(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},nR.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e*=1,t*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var nA=Array.prototype.slice;function nI(e){return function(){return e}}function nz(e){this._context=e}function nN(e){return new nz(e)}nz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e*=1,t*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};const nM=Math.PI,nP=2*nM,nD=nP-1e-6;function nj(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class nB{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?nj:function(e){let t=Math.floor(e);if(!(t>=0))throw Error(`invalid digits: ${e}`);if(t>15)return nj;let n=10**t;return function(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,i){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,t,n,i,r,o){this._append`C${+e},${+t},${+n},${+i},${this._x1=+r},${this._y1=+o}`}arcTo(e,t,n,i,r){if(e*=1,t*=1,n*=1,i*=1,(r*=1)<0)throw Error(`negative radius: ${r}`);let o=this._x1,a=this._y1,s=n-e,l=i-t,u=o-e,h=a-t,c=u*u+h*h;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(c>1e-6)if(Math.abs(h*s-l*u)>1e-6&&r){let d=n-o,f=i-a,p=s*s+l*l,g=Math.sqrt(p),m=Math.sqrt(c),y=r*Math.tan((nM-Math.acos((p+c-(d*d+f*f))/(2*g*m)))/2),v=y/m,_=y/g;Math.abs(v-1)>1e-6&&this._append`L${e+v*u},${t+v*h}`,this._append`A${r},${r},0,0,${+(h*d>u*f)},${this._x1=e+_*s},${this._y1=t+_*l}`}else this._append`L${this._x1=e},${this._y1=t}`}arc(e,t,n,i,r,o){if(e*=1,t*=1,n*=1,o=!!o,n<0)throw Error(`negative radius: ${n}`);let a=n*Math.cos(i),s=n*Math.sin(i),l=e+a,u=t+s,h=1^o,c=o?i-r:r-i;null===this._x1?this._append`M${l},${u}`:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-u)>1e-6)&&this._append`L${l},${u}`,n&&(c<0&&(c=c%nP+nP),c>nD?this._append`A${n},${n},0,1,${h},${e-a},${t-s}A${n},${n},0,1,${h},${this._x1=l},${this._y1=u}`:c>1e-6&&this._append`A${n},${n},0,${+(c>=nM)},${h},${this._x1=e+n*Math.cos(r)},${this._y1=t+n*Math.sin(r)}`)}rect(e,t,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n*=1}v${+i}h${-n}Z`}toString(){return this._}}function nF(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{let e=Math.floor(n);if(!(e>=0))throw RangeError(`invalid digits: ${n}`);t=e}return e},()=>new nB(t)}function nV(e){return e[0]}function nH(e){return e[1]}nB.prototype;class nU{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e*=1,t*=1,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function nq(e){return new nU(e,!1)}function nK(e){return e.source}function nG(e){return e.target}function nW(){return function(e){let t=nK,n=nG,i=nV,r=nH,o=null,a=null,s=nF(l);function l(){let l,u=nA.call(arguments),h=t.apply(this,u),c=n.apply(this,u);if(null==o&&(a=e(l=s())),a.lineStart(),u[0]=h,a.point(+i.apply(this,u),+r.apply(this,u)),u[0]=c,a.point(+i.apply(this,u),+r.apply(this,u)),a.lineEnd(),l)return a=null,l+""||null}return l.source=function(e){return arguments.length?(t=e,l):t},l.target=function(e){return arguments.length?(n=e,l):n},l.x=function(e){return arguments.length?(i="function"==typeof e?e:nI(+e),l):i},l.y=function(e){return arguments.length?(r="function"==typeof e?e:nI(+e),l):r},l.context=function(t){return arguments.length?(null==t?o=a=null:a=e(o=t),l):o},l}(nq)}function nY(e){return((e=Math.exp(e))+1/e)/2}var nX=function e(t,n,i){function r(e,r){var o,a,s=e[0],l=e[1],u=e[2],h=r[0],c=r[1],d=r[2],f=h-s,p=c-l,g=f*f+p*p;if(g<1e-12)a=Math.log(d/u)/t,o=function(e){return[s+e*f,l+e*p,u*Math.exp(t*e*a)]};else{var m=Math.sqrt(g),y=(d*d-u*u+i*g)/(2*u*n*m),v=(d*d-u*u-i*g)/(2*d*n*m),_=Math.log(Math.sqrt(y*y+1)-y);a=(Math.log(Math.sqrt(v*v+1)-v)-_)/t,o=function(e){var i,r,o=e*a,h=nY(_),c=u/(n*m)*(h*(((i=Math.exp(2*(i=t*o+_)))-1)/(i+1))-((r=Math.exp(r=_))-1/r)/2);return[s+c*f,l+c*p,u*h/nY(t*o+_)]}}return o.duration=1e3*a*t/Math.SQRT2,o}return r.rho=function(t){var n=Math.max(.001,+t),i=n*n;return e(n,i,i*i)},r}(Math.SQRT2,2,4),nJ=e=>()=>e;function nQ(e,{sourceEvent:t,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function nZ(e,t,n){this.k=e,this.x=t,this.y=n}nZ.prototype={constructor:nZ,scale:function(e){return 1===e?this:new nZ(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new nZ(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var n0=new nZ(1,0,0);function n1(e){e.stopImmediatePropagation()}function n2(e){e.preventDefault(),e.stopImmediatePropagation()}function n5(e){return(!e.ctrlKey||"wheel"===e.type)&&!e.button}function n3(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function n8(){return this.__zoom||n0}function n9(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function n4(){return navigator.maxTouchPoints||"ontouchstart"in this}function n6(e,t,n){var i=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function n7(){var e,t,n,i=n5,r=n3,o=n6,a=n9,s=n4,l=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],h=250,c=nX,d=eM("start","zoom","end"),f=0,p=10;function g(e){e.property("__zoom",n8).on("wheel.zoom",w,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",k).filter(s).on("touchstart.zoom",E).on("touchmove.zoom",C).on("touchend.zoom touchcancel.zoom",$).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new nZ(t,e.x,e.y)}function y(e,t,n){var i=t[0]-n[0]*e.k,r=t[1]-n[1]*e.k;return i===e.x&&r===e.y?e:new nZ(e.k,i,r)}function v(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function _(e,t,n,i){e.on("start.zoom",function(){x(this,arguments).event(i).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).event(i).end()}).tween("zoom",function(){var e=arguments,o=x(this,e).event(i),a=r.apply(this,e),s=null==n?v(a):"function"==typeof n?n.apply(this,e):n,l=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=this.__zoom,h="function"==typeof t?t.apply(this,e):t,d=c(u.invert(s).concat(l/u.k),h.invert(s).concat(l/h.k));return function(e){if(1===e)e=h;else{var t=d(e),n=l/t[2];e=new nZ(n,s[0]-t[0]*n,s[1]-t[1]*n)}o.zoom(null,e)}})}function x(e,t,n){return!n&&e.__zooming||new b(e,t)}function b(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=r.apply(e,t),this.taps=0}function w(e,...t){if(i.apply(this,arguments)){var n=x(this,t).event(e),r=this.__zoom,s=Math.max(l[0],Math.min(l[1],r.k*Math.pow(2,a.apply(this,arguments)))),h=tL(e);if(n.wheel)(n.mouse[0][0]!==h[0]||n.mouse[0][1]!==h[1])&&(n.mouse[1]=r.invert(n.mouse[0]=h)),clearTimeout(n.wheel);else{if(r.k===s)return;n.mouse=[h,r.invert(h)],t0(this),n.start()}n2(e),n.wheel=setTimeout(function(){n.wheel=null,n.end()},150),n.zoom("mouse",o(y(m(r,s),n.mouse[0],n.mouse[1]),n.extent,u))}}function S(e,...t){if(!n&&i.apply(this,arguments)){var r,a,s,l=e.currentTarget,h=x(this,t,!0).event(e),c=tm(e.view).on("mousemove.zoom",function(e){if(n2(e),!h.moved){var t=e.clientX-p,n=e.clientY-g;h.moved=t*t+n*n>f}h.event(e).zoom("mouse",o(y(h.that.__zoom,h.mouse[0]=tL(e,l),h.mouse[1]),h.extent,u))},!0).on("mouseup.zoom",function(e){var t,n,i,r;c.on("mousemove.zoom mouseup.zoom",null),t=e.view,n=h.moved,i=t.document.documentElement,r=tm(t).on("dragstart.drag",null),n&&(r.on("click.drag",tv,ty),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in i?r.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect),n2(e),h.event(e).end()},!0),d=tL(e,l),p=e.clientX,g=e.clientY;a=(r=e.view).document.documentElement,s=tm(r).on("dragstart.drag",tv,ty),"onselectstart"in a?s.on("selectstart.drag",tv,ty):(a.__noselect=a.style.MozUserSelect,a.style.MozUserSelect="none"),n1(e),h.mouse=[d,this.__zoom.invert(d)],t0(this),h.start()}}function k(e,...t){if(i.apply(this,arguments)){var n=this.__zoom,a=tL(e.changedTouches?e.changedTouches[0]:e,this),s=n.invert(a),l=n.k*(e.shiftKey?.5:2),c=o(y(m(n,l),a,s),r.apply(this,t),u);n2(e),h>0?tm(this).transition().duration(h).call(_,c,a,e):tm(this).call(g.transform,c,a,e)}}function E(n,...r){if(i.apply(this,arguments)){var o,a,s,l,u=n.touches,h=u.length,c=x(this,r,n.changedTouches.length===h).event(n);for(n1(n),a=0;a<h;++a)l=[l=tL(s=u[a],this),this.__zoom.invert(l),s.identifier],c.touch0?c.touch1||c.touch0[2]===l[2]||(c.touch1=l,c.taps=0):(c.touch0=l,o=!0,c.taps=1+!!e);e&&(e=clearTimeout(e)),o&&(c.taps<2&&(t=l[0],e=setTimeout(function(){e=null},500)),t0(this),c.start())}}function C(e,...t){if(this.__zooming){var n,i,r,a,s=x(this,t).event(e),l=e.changedTouches,h=l.length;for(n2(e),n=0;n<h;++n)r=tL(i=l[n],this),s.touch0&&s.touch0[2]===i.identifier?s.touch0[0]=r:s.touch1&&s.touch1[2]===i.identifier&&(s.touch1[0]=r);if(i=s.that.__zoom,s.touch1){var c=s.touch0[0],d=s.touch0[1],f=s.touch1[0],p=s.touch1[1],g=(g=f[0]-c[0])*g+(g=f[1]-c[1])*g,v=(v=p[0]-d[0])*v+(v=p[1]-d[1])*v;i=m(i,Math.sqrt(g/v)),r=[(c[0]+f[0])/2,(c[1]+f[1])/2],a=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!s.touch0)return;r=s.touch0[0],a=s.touch0[1]}s.zoom("touch",o(y(i,r,a),s.extent,u))}}function $(e,...i){if(this.__zooming){var r,o,a=x(this,i).event(e),s=e.changedTouches,l=s.length;for(n1(e),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),r=0;r<l;++r)o=s[r],a.touch0&&a.touch0[2]===o.identifier?delete a.touch0:a.touch1&&a.touch1[2]===o.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps&&(o=tL(o,this),Math.hypot(t[0]-o[0],t[1]-o[1])<p)){var u=tm(this).on("dblclick.zoom");u&&u.apply(this,arguments)}}}return g.transform=function(e,t,n,i){var r=e.selection?e.selection():e;r.property("__zoom",n8),e!==r?_(e,t,n,i):r.interrupt().each(function(){x(this,arguments).event(i).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()})},g.scaleBy=function(e,t,n,i){g.scaleTo(e,function(){var e=this.__zoom.k,n="function"==typeof t?t.apply(this,arguments):t;return e*n},n,i)},g.scaleTo=function(e,t,n,i){g.transform(e,function(){var e=r.apply(this,arguments),i=this.__zoom,a=null==n?v(e):"function"==typeof n?n.apply(this,arguments):n,s=i.invert(a),l="function"==typeof t?t.apply(this,arguments):t;return o(y(m(i,l),a,s),e,u)},n,i)},g.translateBy=function(e,t,n,i){g.transform(e,function(){return o(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),u)},null,i)},g.translateTo=function(e,t,n,i,a){g.transform(e,function(){var e=r.apply(this,arguments),a=this.__zoom,s=null==i?v(e):"function"==typeof i?i.apply(this,arguments):i;return o(n0.translate(s[0],s[1]).scale(a.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,u)},i,a)},b.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=tm(this.that).datum();d.call(e,this.that,new nQ(e,{sourceEvent:this.sourceEvent,target:g,type:e,transform:this.that.__zoom,dispatch:d}),t)}},g.wheelDelta=function(e){return arguments.length?(a="function"==typeof e?e:nJ(+e),g):a},g.filter=function(e){return arguments.length?(i="function"==typeof e?e:nJ(!!e),g):i},g.touchable=function(e){return arguments.length?(s="function"==typeof e?e:nJ(!!e),g):s},g.extent=function(e){return arguments.length?(r="function"==typeof e?e:nJ([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),g):r},g.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],g):[l[0],l[1]]},g.translateExtent=function(e){return arguments.length?(u[0][0]=+e[0][0],u[1][0]=+e[1][0],u[0][1]=+e[0][1],u[1][1]=+e[1][1],g):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},g.constrain=function(e){return arguments.length?(o=e,g):o},g.duration=function(e){return arguments.length?(h=+e,g):h},g.interpolate=function(e){return arguments.length?(c=e,g):c},g.on=function(){var e=d.on.apply(d,arguments);return e===d?g:e},g.clickDistance=function(e){return arguments.length?(f=(e*=1)*e,g):Math.sqrt(f)},g.tapDistance=function(e){return arguments.length?(p=+e,g):p},g}function ie(e,t=null){console.log(`[TreeRenderer] ${e}`),t&&console.log(t)}nZ.prototype;class it{constructor(e,t,n){this.familyTree=e,this.container=t,this.config=n,this.svg=null,this.treeGroup=null,this.nodesGroup=null,this.linksGroup=null,this.treeLayout=null,this.root=null,this.nodeWidth=180*this.config.nodeSize,this.nodeHeight=100*this.config.nodeSize,this.nodeSpacing=20*this.config.nodeSpacing,this.hierarchyData=null,ie(`Initialized renderer with ${e.individuals.length} individuals and ${e.generations} generations`)}render(){ie("Converting to hierarchy"),this.hierarchyData=this.convertToHierarchy(),ie("Creating SVG container"),this.createSvg(),ie("Setting up tree layout"),this.setupTreeLayout(),ie("Creating links"),this.createLinks(),ie("Creating nodes"),this.createNodes(),ie("Setting up zoom behavior"),this.setupZoom()}convertToHierarchy(){let e=Array(this.familyTree.generations).fill().map(()=>[]);this.familyTree.individuals.forEach(t=>{e[t.generation].push(t)}),ie("Individuals grouped by generation",e.map(e=>e.length));let t={id:"root",name:"Family Tree",children:[]};if(e[0].length>0){let n=e[0];ie(`Processing oldest generation with ${n.length} individuals`);let i=new Set;n.forEach(e=>{if(i.has(e.id))return;let n={id:`unit-${e.id}`,name:"Family Unit",individuals:[e],children:[]};i.add(e.id),e.spouses.forEach(e=>{i.has(e.id)||(n.individuals.push(e),i.add(e.id))});let r=this.findChildren(e);ie(`Individual ${e.id} has ${r.length} children`),r.forEach(e=>{this.processChild(e,n,i)}),t.children.push(n)}),ie(`Created ${t.children.length} family units at root level`)}else ie("No individuals in oldest generation, empty tree");return nh(t)}findChildren(e){let t=[...e.children];return e.spouses.forEach(e=>{e.children.forEach(e=>{t.includes(e)||t.push(e)})}),t}processChild(e,t,n){if(n.has(e.id))return;let i={id:`unit-${e.id}`,name:"Family Unit",individuals:[e],children:[]};n.add(e.id),e.spouses.forEach(e=>{n.has(e.id)||(i.individuals.push(e),n.add(e.id))}),this.findChildren(e).forEach(e=>{this.processChild(e,i,n)}),t.children.push(i)}createSvg(){tm(this.container).selectAll("svg").remove(),this.svg=tm(this.container).append("svg").attr("width",this.config.svgWidth).attr("height",this.config.svgHeight).attr("viewBox",`0 0 ${this.config.svgWidth} ${this.config.svgHeight}`).attr("class","family-tree-svg"),this.svg.append("defs").append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",8).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("class","arrow-head"),this.treeGroup=this.svg.append("g").attr("class","tree-group").attr("transform",`translate(${this.config.svgWidth/2}, 60)`),this.linksGroup=this.treeGroup.append("g").attr("class","links-group"),this.nodesGroup=this.treeGroup.append("g").attr("class","nodes-group")}setupTreeLayout(){"top-down"===this.config.orientation?this.treeLayout=nx().nodeSize([this.nodeWidth+this.nodeSpacing,this.nodeHeight+2*this.nodeSpacing]).separation((e,t)=>e.data.individuals&&t.data.individuals?(e.data.individuals.length+t.data.individuals.length)/2:1):"bottom-up"===this.config.orientation?(this.treeLayout=nx().nodeSize([this.nodeWidth+this.nodeSpacing,this.nodeHeight+2*this.nodeSpacing]).separation((e,t)=>e.data.individuals&&t.data.individuals?(e.data.individuals.length+t.data.individuals.length)/2:1),this.hierarchyData.descendants().forEach(e=>{e.y=-e.y})):"left-right"===this.config.orientation?(this.treeLayout=nx().nodeSize([this.nodeHeight+2*this.nodeSpacing,this.nodeWidth+this.nodeSpacing]).separation((e,t)=>e.data.individuals&&t.data.individuals?(e.data.individuals.length+t.data.individuals.length)/2:1),this.treeGroup.attr("transform",`translate(60, ${this.config.svgHeight/2})`)):"right-left"===this.config.orientation&&(this.treeLayout=nx().nodeSize([this.nodeHeight+2*this.nodeSpacing,this.nodeWidth+this.nodeSpacing]).separation((e,t)=>e.data.individuals&&t.data.individuals?(e.data.individuals.length+t.data.individuals.length)/2:1),this.treeGroup.attr("transform",`translate(${this.config.svgWidth-60}, ${this.config.svgHeight/2})`),this.hierarchyData.descendants().forEach(e=>{e.y=-e.y})),this.root=this.treeLayout(this.hierarchyData)}createLinks(){ie("Creating links between nodes");let e=this.getLinkGenerator();this.linksGroup.selectAll(".link").data(this.root.links()).enter().append("path").attr("class","link").attr("d",e),this.root.descendants().forEach(e=>{if(e.data.individuals&&e.data.individuals.length>1){ie(`Creating marriage link for node ${e.data.id} with ${e.data.individuals.length} individuals`);try{let t=[],n=e.data.individuals,i=-((n.length-1)*15)/2;for(let r=0;r<n.length;r++)this.isHorizontalOrientation()?t.push({x:e.y,y:e.x+i+15*r}):t.push({x:e.x+i+15*r,y:e.y});let r=(function(e,t){var n=nI(!0),i=null,r=nN,o=null,a=nF(s);function s(s){var l,u,h,c,d=(s="object"==typeof(l=s)&&"length"in l?l:Array.from(l)).length,f=!1;for(null==i&&(o=r(c=a())),u=0;u<=d;++u)!(u<d&&n(h=s[u],u,s))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(h,u,s),+t(h,u,s));if(c)return o=null,c+""||null}return e="function"==typeof e?e:void 0===e?nV:nI(e),t="function"==typeof t?t:void 0===t?nH:nI(t),s.x=function(t){return arguments.length?(e="function"==typeof t?t:nI(+t),s):e},s.y=function(e){return arguments.length?(t="function"==typeof e?e:nI(+e),s):t},s.defined=function(e){return arguments.length?(n="function"==typeof e?e:nI(!!e),s):n},s.curve=function(e){return arguments.length?(r=e,null!=i&&(o=r(i)),s):r},s.context=function(e){return arguments.length?(null==e?i=o=null:o=r(i=e),s):i},s})().x(e=>e.x).y(e=>e.y);this.linksGroup.append("path").attr("class","link link-marriage").attr("d",r(t)),ie("Marriage link created successfully")}catch(e){ie("Error creating marriage link",e)}}})}getLinkGenerator(){this.config.orientation;let e=this.config.lineStyle;return"straight"===e?nW().x(e=>this.isHorizontalOrientation()?e.y:e.x).y(e=>this.isHorizontalOrientation()?e.x:e.y):"curved"===e?nW().x(e=>this.isHorizontalOrientation()?e.y:e.x).y(e=>this.isHorizontalOrientation()?e.x:e.y).curve(nO):nW().x(e=>this.isHorizontalOrientation()?e.y:e.x).y(e=>this.isHorizontalOrientation()?e.x:e.y).curve(nT)}createNodes(){let e=this.getColorScale();this.nodesGroup.selectAll(".node").data(this.root.descendants().filter(e=>"root"!==e.data.id)).enter().append("g").attr("class","node").attr("transform",e=>this.isHorizontalOrientation()?`translate(${e.y},${e.x})`:`translate(${e.x},${e.y})`).each((t,n,i)=>{let r=tm(i[n]),o=t.data;if(o.individuals&&o.individuals.length>0){let t=-((o.individuals.length-1)*15)/2;o.individuals.forEach((n,i)=>{this.createIndividualNode(r,n,t+15*i,0,e)})}})}createIndividualNode(e,t,n,i,r){let o=`node-${t.gender}`,a=e.append("g").attr("class",`individual ${o}`).attr("transform",`translate(${n}, ${i})`).attr("data-id",t.id),s=this.getIndividualColor(t,r);a.append("rect").attr("x",-this.nodeWidth/2).attr("y",-this.nodeHeight/2).attr("width",this.nodeWidth).attr("height",this.nodeHeight).attr("rx",5).attr("ry",5).style("fill","gender"===this.config.colorScheme?s:"#fff").style("stroke","gender"!==this.config.colorScheme?s:null);let l="ta"===t.language?"tamil":"";if(a.append("text").attr("class",`name ${l}`).attr("y",-this.nodeHeight/2+20).attr("text-anchor","middle").style("font-size",`${this.config.fontSize}px`).style("font-weight","bold").text(t.name),t.birthDate){let e=eC("born",{lng:this.config.language}),n=eT(t.birthDate,this.config.language);a.append("text").attr("class",`birth-date ${l}`).attr("y",-this.nodeHeight/2+40).attr("text-anchor","middle").style("font-size",`${this.config.fontSize-2}px`).text(`${e} ${n}`)}if(t.deathDate){let e=eC("died",{lng:this.config.language}),n=eT(t.deathDate,this.config.language);a.append("text").attr("class",`death-date ${l}`).attr("y",-this.nodeHeight/2+60).attr("text-anchor","middle").style("font-size",`${this.config.fontSize-2}px`).text(`${e} ${n}`);let i=function(e,t=null){if(!e||"string"==typeof e)return null;let n=t||new Date,i=n.getFullYear()-e.getFullYear(),r=n.getMonth()-e.getMonth();return(r<0||0===r&&n.getDate()<e.getDate())&&i--,i}(t.birthDate,t.deathDate);if(null!==i){let e=eC("age",{lng:this.config.language});a.append("text").attr("class",`age ${l}`).attr("y",-this.nodeHeight/2+80).attr("text-anchor","middle").style("font-size",`${this.config.fontSize-2}px`).text(`${e} ${i}`)}}if(t.nativePlace){let e=t.deathDate?-this.nodeHeight/2+100:-this.nodeHeight/2+60;a.append("text").attr("class",`native-place ${l}`).attr("y",e).attr("text-anchor","middle").style("font-size",`${this.config.fontSize-2}px`).text(t.nativePlace)}}getColorScale(){let e=this.config.colorScheme;if("gender"===e)return e=>"male"===e.gender?"#add8e6":"female"===e.gender?"#ffcccb":"#d3d3d3";if("generation"!==e)return e=>"#555";{let e=this.familyTree.generations,t=(function e(){var t=new nb,n=[],i=[],r=nE;function o(e){let o=t.get(e);if(void 0===o){if(r!==nE)return r;t.set(e,o=n.push(e)-1)}return i[o%i.length]}return o.domain=function(e){if(!arguments.length)return n.slice();for(let i of(n=[],t=new nb,e))t.has(i)||t.set(i,n.push(i)-1);return o},o.range=function(e){return arguments.length?(i=Array.from(e),o):i.slice()},o.unknown=function(e){return arguments.length?(r=e,o):r},o.copy=function(){return e(n,i).unknown(r)},nk.apply(o,arguments),o})(nC).domain(function(e,t,n){e*=1,t*=1,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),o=Array(r);++i<r;)o[i]=e+i*n;return o}(e));return e=>t(e.generation)}}getIndividualColor(e,t){return t(e)}setupZoom(){let e=n7().scaleExtent([.1,3]).on("zoom",e=>{this.treeGroup.attr("transform",e.transform)});this.svg.call(e),this.resetView()}resetView(){let e=this.root.descendants().filter(e=>"root"!==e.data.id);if(0===e.length)return;let t=1/0,n=-1/0,i=1/0,r=-1/0;e.forEach(e=>{let o=this.isHorizontalOrientation()?e.y:e.x,a=this.isHorizontalOrientation()?e.x:e.y;t=Math.min(t,o),n=Math.max(n,o),i=Math.min(i,a),r=Math.max(r,a)}),t-=100,n+=100,i-=100,r+=100;let o=n-t,a=r-i,s=Math.min(this.config.svgWidth/o,this.config.svgHeight/a,1),l=this.config.svgWidth/2-(t+o/2)*s,u=this.config.svgHeight/2-(i+a/2)*s,h=n0.translate(l,u).scale(s);this.svg.transition().duration(750).call(n7().transform,h)}isHorizontalOrientation(){return"left-right"===this.config.orientation||"right-left"===this.config.orientation}updateLanguage(e){this.config.language=e,this.render()}exportSVG(){let e=this.svg.node().cloneNode(!0),t=document.createElement("style");t.textContent=`
            .node rect {
                fill: #fff;
                stroke: #555;
                stroke-width: 1px;
            }
            
            .node-male rect {
                stroke: #3498db;
            }
            
            .node-female rect {
                stroke: #e74c3c;
            }
            
            .node-unknown rect {
                stroke: #95a5a6;
            }
            
            .node text {
                font-family: Arial, sans-serif;
                font-size: ${this.config.fontSize}px;
            }
            
            .tamil {
                font-family: 'Noto Sans Tamil', sans-serif;
            }
            
            .link {
                fill: none;
                stroke: #95a5a6;
                stroke-width: 1.5px;
            }
            
            .link-marriage {
                stroke-dasharray: 5;
            }
        `,e.insertBefore(t,e.firstChild);let n=document.createElement("link");n.setAttribute("href","https://fonts.googleapis.com/css2?family=Noto+Sans+Tamil:wght@400;700&display=swap"),n.setAttribute("rel","stylesheet"),e.insertBefore(n,e.firstChild),e.setAttribute("width",this.config.svgWidth),e.setAttribute("height",this.config.svgHeight);let i=new Blob(['<?xml version="1.0" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">',new XMLSerializer().serializeToString(e)],{type:"image/svg+xml"}),r=document.createElement("a");r.href=URL.createObjectURL(i),r.download="family-tree.svg",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}function ii(e,t,n=e=>e){let i=document.getElementById(e),r=document.getElementById(t);r||((r=document.createElement("span")).id=t,r.className="range-value",i.parentNode.insertBefore(r,i.nextSibling)),r.textContent=n(i.value),i.addEventListener("input",()=>{r.textContent=n(i.value)}),i.addEventListener("change",ir)}function ir(){try{let e={orientation:document.getElementById("orientation").value,nodeSize:parseFloat(document.getElementById("node-size").value),nodeSpacing:parseFloat(document.getElementById("node-spacing").value),colorScheme:document.getElementById("color-scheme").value,fontSize:parseInt(document.getElementById("font-size").value),lineStyle:document.getElementById("line-style").value,svgWidth:parseInt(document.getElementById("svg-width").value),svgHeight:parseInt(document.getElementById("svg-height").value)};localStorage.setItem("familyTreeConfig",JSON.stringify(e))}catch(e){console.warn("Failed to save configuration:",e)}}const io=[{id:1,name:"Rajan Kumar",gender:"Male",spouse_name:"Priya Kumar",father_name:"Mohan Kumar",mother_name:"Lakshmi Kumar",birth_date:"1945-05-15",death_date:"2015-10-23",native_place:"Chennai",father_id:5,mother_id:6,spouse_id:2},{id:2,name:"Priya Kumar",gender:"Female",spouse_name:"Rajan Kumar",father_name:"Venkat Rao",mother_name:"Saraswati Rao",birth_date:"1948-09-30",death_date:null,native_place:"Madurai",father_id:7,mother_id:8,spouse_id:1},{id:3,name:"Arjun Kumar",gender:"Male",spouse_name:"Deepa Kumar",father_name:"Rajan Kumar",mother_name:"Priya Kumar",birth_date:"1970-03-22",death_date:null,native_place:"Chennai",father_id:1,mother_id:2,spouse_id:4},{id:4,name:"Deepa Kumar",gender:"Female",spouse_name:"Arjun Kumar",father_name:"Ramesh Sharma",mother_name:"Anita Sharma",birth_date:"1972-11-08",death_date:null,native_place:"Bangalore",father_id:9,mother_id:10,spouse_id:3},{id:5,name:"Mohan Kumar",gender:"Male",spouse_name:"Lakshmi Kumar",father_name:null,mother_name:null,birth_date:"1920-01-05",death_date:"1990-12-15",native_place:"Chennai",father_id:null,mother_id:null,spouse_id:6},{id:6,name:"Lakshmi Kumar",gender:"Female",spouse_name:"Mohan Kumar",father_name:null,mother_name:null,birth_date:"1925-04-20",death_date:"1995-08-10",native_place:"Chennai",father_id:null,mother_id:null,spouse_id:5},{id:7,name:"Venkat Rao",gender:"Male",spouse_name:"Saraswati Rao",father_name:null,mother_name:null,birth_date:"1922-07-12",death_date:"1992-03-18",native_place:"Madurai",father_id:null,mother_id:null,spouse_id:8},{id:8,name:"Saraswati Rao",gender:"Female",spouse_name:"Venkat Rao",father_name:null,mother_name:null,birth_date:"1926-11-30",death_date:"1998-05-22",native_place:"Madurai",father_id:null,mother_id:null,spouse_id:7},{id:9,name:"Ramesh Sharma",gender:"Male",spouse_name:"Anita Sharma",father_name:null,mother_name:null,birth_date:"1945-08-16",death_date:"2010-02-28",native_place:"Bangalore",father_id:null,mother_id:null,spouse_id:10},{id:10,name:"Anita Sharma",gender:"Female",spouse_name:"Ramesh Sharma",father_name:null,mother_name:null,birth_date:"1947-12-03",death_date:null,native_place:"Bangalore",father_id:null,mother_id:null,spouse_id:9},{id:11,name:"Vikram Kumar",gender:"Male",spouse_name:"Kavita Kumar",father_name:"Arjun Kumar",mother_name:"Deepa Kumar",birth_date:"1995-06-20",death_date:null,native_place:"Chennai",father_id:3,mother_id:4,spouse_id:12},{id:12,name:"Kavita Kumar",gender:"Female",spouse_name:"Vikram Kumar",father_name:"Dinesh Patel",mother_name:"Sunita Patel",birth_date:"1997-09-15",death_date:null,native_place:"Mumbai",father_id:null,mother_id:null,spouse_id:11},{id:13,name:"Meera Kumar",gender:"Female",spouse_name:null,father_name:"Arjun Kumar",mother_name:"Deepa Kumar",birth_date:"1998-04-12",death_date:null,native_place:"Chennai",father_id:3,mother_id:4,spouse_id:null},{id:14,name:"ராஜன் குமார்",gender:"ஆண்",spouse_name:"பிரியா குமார்",father_name:"மோகன் குமார்",mother_name:"லக்ஷ்மி குமார்",birth_date:"1945-05-15",death_date:"2015-10-23",native_place:"சென்னை",father_id:18,mother_id:19,spouse_id:15},{id:15,name:"பிரியா குமார்",gender:"பெண்",spouse_name:"ராஜன் குமார்",father_name:"வெங்கட் ராவ்",mother_name:"சரஸ்வதி ராவ்",birth_date:"1948-09-30",death_date:null,native_place:"மதுரை",father_id:20,mother_id:21,spouse_id:14},{id:16,name:"அர்ஜுன் குமார்",gender:"ஆண்",spouse_name:"தீபா குமார்",father_name:"ராஜன் குமார்",mother_name:"பிரியா குமார்",birth_date:"1970-03-22",death_date:null,native_place:"சென்னை",father_id:14,mother_id:15,spouse_id:17},{id:17,name:"தீபா குமார்",gender:"பெண்",spouse_name:"அர்ஜுன் குமார்",father_name:"ரமேஷ் சர்மா",mother_name:"அனிதா சர்மா",birth_date:"1972-11-08",death_date:null,native_place:"பெங்களூர்",father_id:null,mother_id:null,spouse_id:16},{id:18,name:"மோகன் குமார்",gender:"ஆண்",spouse_name:"லக்ஷ்மி குமார்",father_name:null,mother_name:null,birth_date:"1920-01-05",death_date:"1990-12-15",native_place:"சென்னை",father_id:null,mother_id:null,spouse_id:19},{id:19,name:"லக்ஷ்மி குமார்",gender:"பெண்",spouse_name:"மோகன் குமார்",father_name:null,mother_name:null,birth_date:"1925-04-20",death_date:"1995-08-10",native_place:"சென்னை",father_id:null,mother_id:null,spouse_id:18},{id:20,name:"வெங்கட் ராவ்",gender:"ஆண்",spouse_name:"சரஸ்வதி ராவ்",father_name:null,mother_name:null,birth_date:"1922-07-12",death_date:"1992-03-18",native_place:"மதுரை",father_id:null,mother_id:null,spouse_id:21},{id:21,name:"சரஸ்வதி ராவ்",gender:"பெண்",spouse_name:"வெங்கட் ராவ்",father_name:null,mother_name:null,birth_date:"1926-11-30",death_date:"1998-05-22",native_place:"மதுரை",father_id:null,mother_id:null,spouse_id:20}];function ia(e,t=null){console.log(`[App] ${e}`),t&&console.log(t)}const is=document.getElementById("csv-file"),il=document.getElementById("language-select"),iu=document.getElementById("load-sample"),ih=document.getElementById("generate-tree"),ic=document.getElementById("export-svg"),id=document.getElementById("reset-view"),ip=document.getElementById("visualization-container");let ig=null,im=null,iy=null,iv="en";async function i_(){ia("Initializing application"),function(){ia("Validating DOM elements");let e=[];if([{id:"csv-file",name:"CSV File Input"},{id:"language-select",name:"Language Selector"},{id:"load-sample",name:"Load Sample Button"},{id:"generate-tree",name:"Generate Tree Button"},{id:"export-svg",name:"Export SVG Button"},{id:"reset-view",name:"Reset View Button"},{id:"visualization-container",name:"Visualization Container"}].forEach(t=>{document.getElementById(t.id)||(e.push(t.name),ia(`Missing DOM element: ${t.id}`))}),e.length>0){let t=`Some required DOM elements were not found: ${e.join(", ")}`;ia(t),console.error(t);try{iC(`Application initialization error: Missing DOM elements - ${e.join(", ")}`,"error")}catch(n){let e=document.createElement("div");e.style.backgroundColor="#ffebee",e.style.color="#c62828",e.style.padding="15px",e.style.margin="15px",e.style.border="1px solid #ef9a9a",e.style.borderRadius="4px",e.textContent=t,(document.querySelector(".container")||document.body).prepend(e)}return}ia("All required DOM elements found")}(),await eE(),ii("node-size","node-size-value",e=>`${e}x`),ii("node-spacing","node-spacing-value",e=>`${e}x`),ii("font-size","font-size-value",e=>`${e}px`),document.getElementById("svg-width").addEventListener("change",ir),document.getElementById("svg-height").addEventListener("change",ir),document.getElementById("orientation").addEventListener("change",ir),document.getElementById("color-scheme").addEventListener("change",ir),document.getElementById("line-style").addEventListener("change",ir),function(){try{let t=localStorage.getItem("familyTreeConfig");if(t){var e;(e=JSON.parse(t)).orientation&&(document.getElementById("orientation").value=e.orientation),e.nodeSize&&(document.getElementById("node-size").value=e.nodeSize),e.nodeSpacing&&(document.getElementById("node-spacing").value=e.nodeSpacing),e.colorScheme&&(document.getElementById("color-scheme").value=e.colorScheme),e.fontSize&&(document.getElementById("font-size").value=e.fontSize),e.lineStyle&&(document.getElementById("line-style").value=e.lineStyle),e.svgWidth&&(document.getElementById("svg-width").value=e.svgWidth),e.svgHeight&&(document.getElementById("svg-height").value=e.svgHeight),document.getElementById("node-size-value").textContent=`${e.nodeSize}x`,document.getElementById("node-spacing-value").textContent=`${e.nodeSpacing}x`,document.getElementById("font-size-value").textContent=`${e.fontSize}px`}}catch(e){console.warn("Failed to load saved configuration:",e)}}(),iE(iv),ia("Setting up event listeners"),il.addEventListener("change",e=>{iE(e.target.value)}),is.addEventListener("change",ix),iu.addEventListener("click",ib),ih.addEventListener("click",iw),ic.addEventListener("click",iS),id.addEventListener("click",ik),ia("Application initialized successfully"),iC("Application initialized. Please load data or sample to begin.","info")}async function ix(e){ia("File upload initiated");let n=e.target.files[0];if(!n){ia("No file selected");return}ia("Processing file",{name:n.name,size:n.size,type:n.type});try{iC("Parsing CSV file...","info"),ig=await function(e){eL("Starting CSV parsing");try{let r=e instanceof File;if(eL(`Input is ${r?"a File object":"a string"}`),r){var n;return n=e,eL(`Parsing CSV file: ${n.name}`),new Promise((e,i)=>{t(e$).parse(n,{header:!0,skipEmptyLines:!0,trimHeaders:!0,transform:e=>e.trim(),complete:function(t){try{if(eL(`Papa parse complete with ${t.data.length} rows`),t.errors&&t.errors.length>0){eL("CSV parsing errors found",t.errors);let e=t.errors.filter(e=>"FieldMismatch"!==e.type);if(e.length>0){i(Error(`CSV parsing error: ${e[0].message}`));return}eL("Non-critical parsing errors found, proceeding with data")}eO(t.meta.fields);let n=eR(t.data);eL(`Successfully parsed ${n.length} rows from CSV`),e(n)}catch(e){eL("Error during CSV parsing",e),i(e)}},error:function(e){eL("Error during CSV parsing",e),i(e)}})})}var i=e;eL("Parsing CSV from string");try{let e=t(e$).parse(i,{header:!0,skipEmptyLines:!0,trimHeaders:!0,transform:e=>e.trim()});if(e.errors&&e.errors.length>0){eL("CSV parsing errors found",e.errors);let t=e.errors.filter(e=>"FieldMismatch"!==e.type);if(t.length>0)throw Error(`CSV parsing error: ${t[0].message}`)}eO(e.meta.fields);let n=eR(e.data);return eL(`Successfully parsed ${n.length} rows from CSV string`),n}catch(e){throw eL("Error parsing CSV string",e),e}return}catch(e){throw eL("Error in parseCSV",e),e}}(n),ia("CSV data parsed successfully",{records:ig.length}),iC(`Successfully loaded ${ig.length} records from CSV file.`,"success"),iw()}catch(e){ia("Error parsing CSV file",e),iC("Error parsing CSV file: "+e.message,"error")}}function ib(){ia("Loading sample data");try{ig=io,ia("Sample data loaded successfully",{records:ig.length}),iC(`Successfully loaded ${ig.length} sample records.`,"success"),iw()}catch(e){ia("Error loading sample data",e),iC("Error loading sample data: "+e.message,"error")}}function iw(){if(ia("Generate family tree requested"),!ig||0===ig.length){ia("No family data available"),iC("Please upload a CSV file or load sample data first.","error");return}try{iC("Generating family tree...","info"),ip.innerHTML="",ia("Visualization container cleared"),ip.style.display="block",ip.style.minHeight="500px",ip.style.border="1px solid #ccc";let e={orientation:document.getElementById("orientation").value,nodeSize:parseFloat(document.getElementById("node-size").value),nodeSpacing:parseFloat(document.getElementById("node-spacing").value),colorScheme:document.getElementById("color-scheme").value,fontSize:parseInt(document.getElementById("font-size").value),lineStyle:document.getElementById("line-style").value,svgWidth:parseInt(document.getElementById("svg-width").value),svgHeight:parseInt(document.getElementById("svg-height").value),language:iv};ia("Using configuration",e),ia("Building family tree");try{im=function(e){var t,n;let i;if(eA("Starting tree construction with data:",e),!e||!Array.isArray(e)||0===e.length)throw Error("Invalid or empty data provided to buildFamilyTree");eA("Creating individuals map");let r=function(e){let t={};return e.forEach(e=>{var n;let i={id:e.id,name:e.name,gender:function(e){if(!e)return"unknown";let t=e.toString().trim().toLowerCase();return"m"===t||"male"===t||"ம"===t||"ஆண்"===t?"male":"f"===t||"female"===t||"பெ"===t||"பெண்"===t?"female":"unknown"}(e.gender),spouseName:e.spouse_name||null,fatherName:e.father_name||null,motherName:e.mother_name||null,birthDate:e.birth_date,deathDate:e.death_date,nativePlace:e.native_place||null,fatherId:e.father_id||null,motherId:e.mother_id||null,spouseId:e.spouse_id||null,parents:[],children:[],spouses:[],generation:null,language:(n=e.name)&&/[\u0B80-\u0BFF]/.test(n)?"ta":"en",hasSpouse:!!e.spouse_name||!!e.spouse_id};t[e.id]=i}),t}(e);eA("Individuals map created",Object.keys(r).length),eA("Building relationships"),t=r,Object.values(t).forEach(e=>{eI(t,e,"father"),eI(t,e,"mother"),function(e,t){let n=t.spouseId;if(n&&e[n]){let i=e[n];t.spouses.includes(i)||t.spouses.push(i),i.spouses.includes(t)||i.spouses.push(t)}}(t,e)}),Object.values(t).forEach(e=>{ez(t,e,"father"),ez(t,e,"mother"),function(e,t){if(t.spouses.length>0)return;let n=t.spouseName;if(n){let i=Object.values(e).find(e=>e.name.toLowerCase()===n.toLowerCase()&&e.gender!==t.gender);i&&(t.spouses.includes(i)||t.spouses.push(i),i.spouses.includes(t)||i.spouses.push(t))}}(t,e)}),eA("Calculating generations"),function(e){let t=Object.values(e).filter(e=>0===e.parents.length);if(0===t.length){Object.values(e).forEach(e=>{e.generation=0});return}t.forEach(e=>{e.generation=0});let n=!0,i=100;for(;n&&i>0;)n=!1,i--,Object.values(e).forEach(e=>{null!==e.generation&&(e.children.forEach(t=>{let i=e.generation+1;(null===t.generation||t.generation<i)&&(t.generation=i,n=!0)}),e.spouses.forEach(t=>{if(null===t.generation)t.generation=e.generation,n=!0;else if(t.generation!==e.generation){let i=Math.max(t.generation,e.generation);t.generation=i,e.generation=i,n=!0}}))});Object.values(e).forEach(e=>{null===e.generation&&(e.generation=0)})}(r);let o=0,a=0,s=0;Object.values(r).forEach(e=>{e.parents.length>0&&o++,e.children.length>0&&a++,e.spouses.length>0&&s++}),eA(`Relationship stats: ${o} with parents, ${a} with children, ${s} with spouses`);let l=(n=r,i=0,Object.values(n).forEach(e=>{e.generation>i&&(i=e.generation)}),i),u={individuals:Object.values(r),generations:l+1};return eA(`Tree construction complete with ${u.individuals.length} individuals and ${u.generations} generations`),u}(ig),ia("Family tree built successfully",{individuals:im.individuals.length,generations:im.generations})}catch(e){ia("Error building family tree",e),iC("Error building family tree: "+e.message,"error");return}ia("Rendering family tree");try{iy=function(e,t,n){if(ie("Starting tree rendering"),!e||!e.individuals||0===e.individuals.length)throw Error("Invalid family tree data provided");if(!t)throw Error("No container element provided for rendering");let i={orientation:"top-down",nodeSize:1.5,nodeSpacing:1.5,colorScheme:"default",fontSize:14,lineStyle:"straight",svgWidth:2e3,svgHeight:1500,language:"en",...n};ie("Rendering with config",i);let r=new it(e,t,i);try{r.render(),ie("Tree rendering complete")}catch(e){throw ie("Error during tree rendering",e),e}return r}(im,ip,e),ia("Family tree rendered successfully"),iC("Family tree generated successfully.","success"),ip.scrollIntoView({behavior:"smooth"})}catch(e){ia("Error rendering family tree",e),iC("Error rendering family tree: "+e.message,"error")}}catch(e){ia("Error generating family tree",e),iC("Error generating family tree: "+e.message,"error")}}function iS(){if(!iy){alert("Please generate a family tree first.");return}try{iy.exportSVG()}catch(e){console.error("Error exporting SVG:",e),alert("Error exporting SVG: "+e.message)}}function ik(){iy&&iy.resetView()}function iE(e){iv=e,document.documentElement.lang=e,document.getElementById("app-title").textContent=et.t("appTitle"),document.getElementById("input-title").textContent=et.t("inputTitle"),document.getElementById("config-title").textContent=et.t("configTitle"),document.getElementById("layout-title").textContent=et.t("layoutTitle"),document.getElementById("visual-title").textContent=et.t("visualTitle"),document.getElementById("export-title").textContent=et.t("exportTitle"),document.getElementById("vis-title").textContent=et.t("visTitle"),document.querySelector('label[for="language-select"]').textContent=et.t("language"),document.getElementById("file-label").textContent=et.t("fileLabel"),document.getElementById("load-sample").textContent=et.t("loadSample"),document.querySelector('label[for="orientation"]').textContent=et.t("orientation"),document.querySelector('label[for="node-size"]').textContent=et.t("nodeSize"),document.querySelector('label[for="node-spacing"]').textContent=et.t("nodeSpacing"),document.querySelector('label[for="color-scheme"]').textContent=et.t("colorScheme"),document.querySelector('label[for="font-size"]').textContent=et.t("fontSize"),document.querySelector('label[for="line-style"]').textContent=et.t("lineStyle"),document.querySelector('label[for="svg-width"]').textContent=et.t("svgWidth"),document.querySelector('label[for="svg-height"]').textContent=et.t("svgHeight");let t=document.getElementById("orientation");t.options[0].textContent=et.t("topDown"),t.options[1].textContent=et.t("bottomUp"),t.options[2].textContent=et.t("leftRight"),t.options[3].textContent=et.t("rightLeft");let n=document.getElementById("color-scheme");n.options[0].textContent=et.t("default"),n.options[1].textContent=et.t("genderBased"),n.options[2].textContent=et.t("generationBased"),n.options[3].textContent=et.t("custom");let i=document.getElementById("line-style");i.options[0].textContent=et.t("straight"),i.options[1].textContent=et.t("curved"),i.options[2].textContent=et.t("angled"),document.getElementById("generate-tree").textContent=et.t("generateTree"),document.getElementById("export-svg").textContent=et.t("exportSVG"),document.getElementById("reset-view").textContent=et.t("resetView"),document.querySelector("footer p").textContent=et.t("footerText"),document.body.classList.remove("tamil"),"ta"===e&&document.body.classList.add("tamil"),iy&&im&&iy.updateLanguage(e)}function iC(e,t="info"){let n=document.getElementById("status-container");n||((n=document.createElement("div")).id="status-container",n.style.marginTop="10px",n.style.padding="10px",n.style.borderRadius="4px",n.style.fontWeight="bold",document.querySelector(".input-section").appendChild(n)),n.textContent=e,"error"===t?(n.style.backgroundColor="#ffebee",n.style.color="#c62828",n.style.border="1px solid #ef9a9a"):"success"===t?(n.style.backgroundColor="#e8f5e9",n.style.color="#2e7d32",n.style.border="1px solid #a5d6a7"):(n.style.backgroundColor="#e3f2fd",n.style.color="#1565c0",n.style.border="1px solid #90caf9"),n.scrollIntoView({behavior:"smooth"})}document.addEventListener("DOMContentLoaded",i_);
//# sourceMappingURL=family-tree.7ae51391.js.map
